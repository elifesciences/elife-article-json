{
    "journal": {
        "id": "eLife", 
        "title": "eLife", 
        "issn": "2050-084X"
    }, 
    "snippet": {
        "-meta": {
            "location": "https://raw.githubusercontent.com/elifesciences/elife-article-xml/5aac79759a440b88c82b263dbd866793307e5300/articles/elife-10094-v2.xml"
        }, 
        "status": "vor", 
        "id": "10094", 
        "version": 2, 
        "type": "research-article", 
        "doi": "10.7554/eLife.10094", 
        "authorLine": "Yedidyah Dordek et al", 
        "title": "Extracting grid cell characteristics from place cell inputs using non-negative principal component analysis", 
        "published": "2016-03-08T00:00:00Z", 
        "volume": 5, 
        "elocationId": "e10094", 
        "pdf": "https://publishing-cdn.elifesciences.org/10094/elife-10094-v2.pdf", 
        "subjects": [
            {
                "id": "neuroscience", 
                "name": "Neuroscience"
            }
        ], 
        "researchOrganisms": [
            "Human", 
            "Mouse", 
            "Rat"
        ], 
        "abstract": {
            "doi": "10.7554/eLife.10094.001", 
            "content": [
                {
                    "type": "paragraph", 
                    "text": "Many recent models study the downstream projection from grid cells to place cells, while recent data have pointed out the importance of the feedback projection. We thus asked how grid cells are affected by the nature of the input from the place cells. We propose a single-layer neural network with feedforward weights connecting place-like input cells to grid cell outputs. Place-to-grid weights are learned via a generalized Hebbian rule. The architecture of this network highly resembles neural networks used to perform Principal Component Analysis (PCA). Both numerical results and analytic considerations indicate that if the components of the feedforward neural network are non-negative, the output converges to a hexagonal lattice. Without the non-negativity constraint, the output converges to a square lattice. Consistent with experiments, grid spacing ratio between the first two consecutive modules is \u22121.4. Our results express a possible linkage between place cell to grid cell interactions and PCA."
                }
            ]
        }, 
        "copyright": {
            "license": "CC-BY-4.0", 
            "holder": "Dordek et al", 
            "statement": "This article is distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use and redistribution provided that the original author and source are credited."
        }, 
        "authors": [
            {
                "type": "person", 
                "name": {
                    "preferred": "Yedidyah Dordek", 
                    "index": "Dordek, Yedidyah"
                }, 
                "affiliations": [
                    {
                        "name": [
                            "Faculty of Electrical Engineering", 
                            "Technion \u2013 Israel Institute of Technology"
                        ], 
                        "address": {
                            "formatted": [
                                "Haifa", 
                                "Israel"
                            ], 
                            "components": {
                                "locality": [
                                    "Haifa"
                                ], 
                                "country": "Israel"
                            }
                        }
                    }, 
                    {
                        "name": [
                            "Rappaport Faculty of Medicine and Research Institute", 
                            "Technion \u2013 Israel Institute of Technology"
                        ], 
                        "address": {
                            "formatted": [
                                "Haifa", 
                                "Israel"
                            ], 
                            "components": {
                                "locality": [
                                    "Haifa"
                                ], 
                                "country": "Israel"
                            }
                        }
                    }
                ], 
                "contribution": "YD, Conception and design, Analysis and interpretation of data, Drafting or revising the article", 
                "competingInterests": "The authors declare that no competing interests exist.", 
                "equalContributionGroups": [
                    1
                ]
            }, 
            {
                "type": "person", 
                "name": {
                    "preferred": "Daniel Soudry", 
                    "index": "Soudry, Daniel"
                }, 
                "affiliations": [
                    {
                        "name": [
                            "Department of Statistics", 
                            "Columbia University"
                        ], 
                        "address": {
                            "formatted": [
                                "New York", 
                                "United States"
                            ], 
                            "components": {
                                "locality": [
                                    "New York"
                                ], 
                                "country": "United States"
                            }
                        }
                    }, 
                    {
                        "name": [
                            "Center for Theoretical Neuroscience", 
                            "Columbia University"
                        ], 
                        "address": {
                            "formatted": [
                                "New York", 
                                "United States"
                            ], 
                            "components": {
                                "locality": [
                                    "New York"
                                ], 
                                "country": "United States"
                            }
                        }
                    }
                ], 
                "emailAddresses": [
                    "daniel.soudry@gmail.com"
                ], 
                "contribution": "DS, Conception and design, Analysis and interpretation of data, Drafting or revising the article, Analytical derivations in Materials and methods and in Appendix", 
                "competingInterests": "The authors declare that no competing interests exist.", 
                "equalContributionGroups": [
                    1
                ]
            }, 
            {
                "type": "person", 
                "name": {
                    "preferred": "Ron Meir", 
                    "index": "Meir, Ron"
                }, 
                "affiliations": [
                    {
                        "name": [
                            "Faculty of Electrical Engineering", 
                            "Technion \u2013 Israel Institute of Technology"
                        ], 
                        "address": {
                            "formatted": [
                                "Haifa", 
                                "Israel"
                            ], 
                            "components": {
                                "locality": [
                                    "Haifa"
                                ], 
                                "country": "Israel"
                            }
                        }
                    }
                ], 
                "contribution": "RM, Conception and design, Analysis and interpretation of data, Drafting or revising the article", 
                "competingInterests": "The authors declare that no competing interests exist."
            }, 
            {
                "type": "person", 
                "name": {
                    "preferred": "Dori Derdikman", 
                    "index": "Derdikman, Dori"
                }, 
                "orcid": "0000-0003-3677-6321", 
                "affiliations": [
                    {
                        "name": [
                            "Rappaport Faculty of Medicine and Research Institute", 
                            "Technion \u2013 Israel Institute of Technology"
                        ], 
                        "address": {
                            "formatted": [
                                "Haifa", 
                                "Israel"
                            ], 
                            "components": {
                                "locality": [
                                    "Haifa"
                                ], 
                                "country": "Israel"
                            }
                        }
                    }
                ], 
                "emailAddresses": [
                    "derdik@technion.ac.il"
                ], 
                "contribution": "DD, Conception and design, Analysis and interpretation of data, Drafting or revising the article", 
                "competingInterests": "The authors declare that no competing interests exist."
            }
        ], 
        "reviewers": [
            {
                "type": "person", 
                "name": {
                    "preferred": "Michael J Frank", 
                    "index": "Frank, Michael J"
                }, 
                "role": "Reviewing editor", 
                "affiliations": [
                    {
                        "name": [
                            "Brown University"
                        ], 
                        "address": {
                            "formatted": [
                                "United States"
                            ], 
                            "components": {
                                "country": "United States"
                            }
                        }
                    }
                ]
            }
        ], 
        "funding": {
            "awards": [
                {
                    "id": "par-1", 
                    "source": {
                        "name": [
                            "Ollendroff center of the Department of Electrical Engineering, Technion"
                        ]
                    }, 
                    "awardId": "Research fund", 
                    "recipients": [
                        {
                            "type": "person", 
                            "name": {
                                "preferred": "Ron Meir", 
                                "index": "Meir, Ron"
                            }
                        }
                    ]
                }, 
                {
                    "id": "par-2", 
                    "source": {
                        "name": [
                            "Gruss Lipper Charitable Foundation"
                        ]
                    }, 
                    "recipients": [
                        {
                            "type": "person", 
                            "name": {
                                "preferred": "Daniel Soudry", 
                                "index": "Soudry, Daniel"
                            }
                        }
                    ]
                }, 
                {
                    "id": "par-3", 
                    "source": {
                        "name": [
                            "Intelligence Advanced Research Projects Activity"
                        ]
                    }, 
                    "recipients": [
                        {
                            "type": "person", 
                            "name": {
                                "preferred": "Daniel Soudry", 
                                "index": "Soudry, Daniel"
                            }
                        }
                    ]
                }, 
                {
                    "id": "par-4", 
                    "source": {
                        "funderId": "10.13039/501100003977", 
                        "name": [
                            "Israel Science Foundation"
                        ]
                    }, 
                    "awardId": "Personal Research Grant, 955/13", 
                    "recipients": [
                        {
                            "type": "person", 
                            "name": {
                                "preferred": "Dori Derdikman", 
                                "index": "Derdikman, Dori"
                            }
                        }
                    ]
                }, 
                {
                    "id": "par-5", 
                    "source": {
                        "funderId": "10.13039/501100003977", 
                        "name": [
                            "Israel Science Foundation"
                        ]
                    }, 
                    "awardId": "New Faculty Equipment Grant, 1882/13", 
                    "recipients": [
                        {
                            "type": "person", 
                            "name": {
                                "preferred": "Dori Derdikman", 
                                "index": "Derdikman, Dori"
                            }
                        }
                    ]
                }, 
                {
                    "id": "par-6", 
                    "source": {
                        "name": [
                            "Rappaport Institute"
                        ]
                    }, 
                    "awardId": "Personal Research Grant", 
                    "recipients": [
                        {
                            "type": "person", 
                            "name": {
                                "preferred": "Dori Derdikman", 
                                "index": "Derdikman, Dori"
                            }
                        }
                    ]
                }, 
                {
                    "id": "par-7", 
                    "source": {
                        "name": [
                            "Allen and Jewel Prince Center for Neurodegenrative Disorders"
                        ]
                    }, 
                    "awardId": "Research Grant", 
                    "recipients": [
                        {
                            "type": "person", 
                            "name": {
                                "preferred": "Dori Derdikman", 
                                "index": "Derdikman, Dori"
                            }
                        }
                    ]
                }
            ], 
            "statement": "The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication."
        }, 
        "impactStatement": "Computational modeling of the brain\u2019s navigation system reveals that place cells can drive the formation of hexagonal patterns experimentally observed in grid cells activity."
    }, 
    "article": {
        "-meta": {
            "location": "https://raw.githubusercontent.com/elifesciences/elife-article-xml/5aac79759a440b88c82b263dbd866793307e5300/articles/elife-10094-v2.xml", 
            "patched": true
        }, 
        "status": "vor", 
        "id": "10094", 
        "version": 2, 
        "type": "research-article", 
        "doi": "10.7554/eLife.10094", 
        "authorLine": "Yedidyah Dordek et al", 
        "title": "Extracting grid cell characteristics from place cell inputs using non-negative principal component analysis", 
        "published": "2016-03-08T00:00:00Z", 
        "volume": 5, 
        "elocationId": "e10094", 
        "pdf": "https://publishing-cdn.elifesciences.org/10094/elife-10094-v2.pdf", 
        "subjects": [
            {
                "id": "neuroscience", 
                "name": "Neuroscience"
            }
        ], 
        "researchOrganisms": [
            "Human", 
            "Mouse", 
            "Rat"
        ], 
        "abstract": {
            "doi": "10.7554/eLife.10094.001", 
            "content": [
                {
                    "type": "paragraph", 
                    "text": "Many recent models study the downstream projection from grid cells to place cells, while recent data have pointed out the importance of the feedback projection. We thus asked how grid cells are affected by the nature of the input from the place cells. We propose a single-layer neural network with feedforward weights connecting place-like input cells to grid cell outputs. Place-to-grid weights are learned via a generalized Hebbian rule. The architecture of this network highly resembles neural networks used to perform Principal Component Analysis (PCA). Both numerical results and analytic considerations indicate that if the components of the feedforward neural network are non-negative, the output converges to a hexagonal lattice. Without the non-negativity constraint, the output converges to a square lattice. Consistent with experiments, grid spacing ratio between the first two consecutive modules is \u22121.4. Our results express a possible linkage between place cell to grid cell interactions and PCA."
                }
            ]
        }, 
        "copyright": {
            "license": "CC-BY-4.0", 
            "holder": "Dordek et al", 
            "statement": "This article is distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use and redistribution provided that the original author and source are credited."
        }, 
        "authors": [
            {
                "type": "person", 
                "name": {
                    "preferred": "Yedidyah Dordek", 
                    "index": "Dordek, Yedidyah"
                }, 
                "affiliations": [
                    {
                        "name": [
                            "Faculty of Electrical Engineering", 
                            "Technion \u2013 Israel Institute of Technology"
                        ], 
                        "address": {
                            "formatted": [
                                "Haifa", 
                                "Israel"
                            ], 
                            "components": {
                                "locality": [
                                    "Haifa"
                                ], 
                                "country": "Israel"
                            }
                        }
                    }, 
                    {
                        "name": [
                            "Rappaport Faculty of Medicine and Research Institute", 
                            "Technion \u2013 Israel Institute of Technology"
                        ], 
                        "address": {
                            "formatted": [
                                "Haifa", 
                                "Israel"
                            ], 
                            "components": {
                                "locality": [
                                    "Haifa"
                                ], 
                                "country": "Israel"
                            }
                        }
                    }
                ], 
                "contribution": "YD, Conception and design, Analysis and interpretation of data, Drafting or revising the article", 
                "competingInterests": "The authors declare that no competing interests exist.", 
                "equalContributionGroups": [
                    1
                ]
            }, 
            {
                "type": "person", 
                "name": {
                    "preferred": "Daniel Soudry", 
                    "index": "Soudry, Daniel"
                }, 
                "affiliations": [
                    {
                        "name": [
                            "Department of Statistics", 
                            "Columbia University"
                        ], 
                        "address": {
                            "formatted": [
                                "New York", 
                                "United States"
                            ], 
                            "components": {
                                "locality": [
                                    "New York"
                                ], 
                                "country": "United States"
                            }
                        }
                    }, 
                    {
                        "name": [
                            "Center for Theoretical Neuroscience", 
                            "Columbia University"
                        ], 
                        "address": {
                            "formatted": [
                                "New York", 
                                "United States"
                            ], 
                            "components": {
                                "locality": [
                                    "New York"
                                ], 
                                "country": "United States"
                            }
                        }
                    }
                ], 
                "emailAddresses": [
                    "daniel.soudry@gmail.com"
                ], 
                "contribution": "DS, Conception and design, Analysis and interpretation of data, Drafting or revising the article, Analytical derivations in Materials and methods and in Appendix", 
                "competingInterests": "The authors declare that no competing interests exist.", 
                "equalContributionGroups": [
                    1
                ]
            }, 
            {
                "type": "person", 
                "name": {
                    "preferred": "Ron Meir", 
                    "index": "Meir, Ron"
                }, 
                "affiliations": [
                    {
                        "name": [
                            "Faculty of Electrical Engineering", 
                            "Technion \u2013 Israel Institute of Technology"
                        ], 
                        "address": {
                            "formatted": [
                                "Haifa", 
                                "Israel"
                            ], 
                            "components": {
                                "locality": [
                                    "Haifa"
                                ], 
                                "country": "Israel"
                            }
                        }
                    }
                ], 
                "contribution": "RM, Conception and design, Analysis and interpretation of data, Drafting or revising the article", 
                "competingInterests": "The authors declare that no competing interests exist."
            }, 
            {
                "type": "person", 
                "name": {
                    "preferred": "Dori Derdikman", 
                    "index": "Derdikman, Dori"
                }, 
                "orcid": "0000-0003-3677-6321", 
                "affiliations": [
                    {
                        "name": [
                            "Rappaport Faculty of Medicine and Research Institute", 
                            "Technion \u2013 Israel Institute of Technology"
                        ], 
                        "address": {
                            "formatted": [
                                "Haifa", 
                                "Israel"
                            ], 
                            "components": {
                                "locality": [
                                    "Haifa"
                                ], 
                                "country": "Israel"
                            }
                        }
                    }
                ], 
                "emailAddresses": [
                    "derdik@technion.ac.il"
                ], 
                "contribution": "DD, Conception and design, Analysis and interpretation of data, Drafting or revising the article", 
                "competingInterests": "The authors declare that no competing interests exist."
            }
        ], 
        "reviewers": [
            {
                "type": "person", 
                "name": {
                    "preferred": "Michael J Frank", 
                    "index": "Frank, Michael J"
                }, 
                "role": "Reviewing editor", 
                "affiliations": [
                    {
                        "name": [
                            "Brown University"
                        ], 
                        "address": {
                            "formatted": [
                                "United States"
                            ], 
                            "components": {
                                "country": "United States"
                            }
                        }
                    }
                ]
            }
        ], 
        "funding": {
            "awards": [
                {
                    "id": "par-1", 
                    "source": {
                        "name": [
                            "Ollendroff center of the Department of Electrical Engineering, Technion"
                        ]
                    }, 
                    "awardId": "Research fund", 
                    "recipients": [
                        {
                            "type": "person", 
                            "name": {
                                "preferred": "Ron Meir", 
                                "index": "Meir, Ron"
                            }
                        }
                    ]
                }, 
                {
                    "id": "par-2", 
                    "source": {
                        "name": [
                            "Gruss Lipper Charitable Foundation"
                        ]
                    }, 
                    "recipients": [
                        {
                            "type": "person", 
                            "name": {
                                "preferred": "Daniel Soudry", 
                                "index": "Soudry, Daniel"
                            }
                        }
                    ]
                }, 
                {
                    "id": "par-3", 
                    "source": {
                        "name": [
                            "Intelligence Advanced Research Projects Activity"
                        ]
                    }, 
                    "recipients": [
                        {
                            "type": "person", 
                            "name": {
                                "preferred": "Daniel Soudry", 
                                "index": "Soudry, Daniel"
                            }
                        }
                    ]
                }, 
                {
                    "id": "par-4", 
                    "source": {
                        "funderId": "10.13039/501100003977", 
                        "name": [
                            "Israel Science Foundation"
                        ]
                    }, 
                    "awardId": "Personal Research Grant, 955/13", 
                    "recipients": [
                        {
                            "type": "person", 
                            "name": {
                                "preferred": "Dori Derdikman", 
                                "index": "Derdikman, Dori"
                            }
                        }
                    ]
                }, 
                {
                    "id": "par-5", 
                    "source": {
                        "funderId": "10.13039/501100003977", 
                        "name": [
                            "Israel Science Foundation"
                        ]
                    }, 
                    "awardId": "New Faculty Equipment Grant, 1882/13", 
                    "recipients": [
                        {
                            "type": "person", 
                            "name": {
                                "preferred": "Dori Derdikman", 
                                "index": "Derdikman, Dori"
                            }
                        }
                    ]
                }, 
                {
                    "id": "par-6", 
                    "source": {
                        "name": [
                            "Rappaport Institute"
                        ]
                    }, 
                    "awardId": "Personal Research Grant", 
                    "recipients": [
                        {
                            "type": "person", 
                            "name": {
                                "preferred": "Dori Derdikman", 
                                "index": "Derdikman, Dori"
                            }
                        }
                    ]
                }, 
                {
                    "id": "par-7", 
                    "source": {
                        "name": [
                            "Allen and Jewel Prince Center for Neurodegenrative Disorders"
                        ]
                    }, 
                    "awardId": "Research Grant", 
                    "recipients": [
                        {
                            "type": "person", 
                            "name": {
                                "preferred": "Dori Derdikman", 
                                "index": "Derdikman, Dori"
                            }
                        }
                    ]
                }
            ], 
            "statement": "The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication."
        }, 
        "impactStatement": "Computational modeling of the brain\u2019s navigation system reveals that place cells can drive the formation of hexagonal patterns experimentally observed in grid cells activity.", 
        "keywords": [
            "bat", 
            "grid cell", 
            "place cell", 
            "hippocampus", 
            "entorhinal", 
            "navigation"
        ], 
        "-related-articles-internal": [], 
        "-related-articles-external": [], 
        "digest": {
            "doi": "10.7554/eLife.10094.002", 
            "content": [
                {
                    "type": "paragraph", 
                    "text": "Long before the invention of GPS systems, ships used a technique called dead reckoning to navigate at sea. By tracking the ship\u2019s speed and direction of movement away from a starting point, the crew could estimate their position at any given time. Many believe that some animals, including rats and humans, can use a similar process to navigate in the absence of external landmarks. This process is referred to as \u201cpath integration\u201d."
                }, 
                {
                    "type": "paragraph", 
                    "text": "It is commonly believed that the brain\u2019s navigation system is based on such path integration in two key regions: the entorhinal cortex and the hippocampus. Most models of navigation assume that a network of grid cells in the entorhinal cortex processes information about an animal\u2019s speed and direction of movement. The grid cell network estimates the animal\u2019s future position and relays this information to cells in the hippocampus called place cells. Individual place cells then fire whenever the animal reaches a specific location."
                }, 
                {
                    "type": "paragraph", 
                    "text": "However, recent work has shown that information also flows from place cells back to grid cells. Further experiments have suggested that place cells develop before grid cells. Also, inactivating place cells eliminates the hexagonal patterns that normally appear in the activity of the grid cells."
                }, 
                {
                    "type": "paragraph", 
                    "text": "Using a computational model, Dordek, Soudry et al. now show that place cell activity could in principle trigger the formation of the grid cell network, rather than vice versa. This is achieved using a process that resembles a common statistical algorithm called principal component analysis (PCA). However, this only works if place cells only excite grid cells and never inhibit their activity, similar to what is known from the anatomy of these brain regions. Under these circumstances, the model shows hexagonal patterns emerging in the activity of the grid cells, with similar properties to those patterns observed experimentally."
                }, 
                {
                    "type": "paragraph", 
                    "text": "These results suggest that navigation may not depend solely on grid cells processing information about speed and direction of movement, as assumed by path integration models. Instead grid cells may rely on position-based input from place cells. The next step is to create a single model that combines the flow of information from place cells to grid cells and vice versa."
                }
            ]
        }, 
        "body": [
            {
                "type": "section", 
                "id": "s1", 
                "title": "Introduction", 
                "content": [
                    {
                        "type": "paragraph", 
                        "text": "The system of spatial navigation in the brain has recently received much attention (<a href=\"#bib5\">Burgess, 2014</a>; <a href=\"#bib27\">Morris, 2015</a>; <a href=\"#bib11\">Eichenbaum, 2015</a>). This system involves many regions, which seem to divide into two major classes: regions such as CA1 and CA3 of the hippocampus, which contain place cells (<a href=\"#bib28\">O'Keefe and Dostrovsky, 1971</a>; <a href=\"#bib29\">O'Keefe and Nadel, 1978</a>), vs. regions, such as the medial-entorhinal cortex (MEC), the presubiculum and the parasubiculum, which contain grid cells, head-direction cells and border cells (<a href=\"#bib17\">Hafting et al., 2005</a>; <a href=\"#bib3\">Boccara et al., 2010</a>; <a href=\"#bib32\">Sargolini et al., 2006</a>; <a href=\"#bib35\">Solstad et al., 2008</a>; <a href=\"#bib33\">Savelli et al., 2008</a>). While the phenomenology of those cells is described in many studies (<a href=\"#bib10\">Derdikman and Knierim, 2014</a>; <a href=\"#bib40\">Tocker et al., 2015</a>), the manner in which grid cells are formed is quite enigmatic. Many mechanisms have been proposed. The details of these mechanisms differ, however, they mostly share in common the assumption that the animal\u2019s velocity is the main input to the system (<a href=\"#bib10\">Derdikman and Knierim, 2014</a>; <a href=\"#bib47\">Zilli, 2012</a>; <a href=\"#bib15\">Giocomo et al., 2011</a>), such that positional information is generated by the\u00a0integration of this input in time. This process is termed 'path integration' (PI)\u00a0(<a href=\"#bib25\">Mittelstaedt and Mittelstaedt, 1980</a>). A notable exception to this class of models was suggested in a previous\u00a0paper by\u00a0<a href=\"#bib21\">Kropff and Treves (2008)</a>; and in a sequel to that paper (<a href=\"#bib34\">Si and Treves, 2013</a>), in which they demonstrated the emergence of grid cells from place cell inputs without using the rat's velocity as an input signal."
                    }, 
                    {
                        "type": "paragraph", 
                        "text": "We note here that generating grid cells from place cells may seem at odds with the architecture of the network, since it is known that place cells reside at least one synapse downstream of grid cells (<a href=\"#bib45\">Witter and Amaral, 2004</a>). Nonetheless, there is current evidence that the feedback from place cells to grid cells is of great functional importance. Specifically, there is evidence that inactivation of place cells causes grid cells to disappear (<a href=\"#bib4\">Bonnevie et al., 2013</a>), and furthermore, it seems that, in development, place cells emerge before grid cells do (<a href=\"#bib23\">Langston et al., 2010</a>; <a href=\"#bib44\">Wills et al., 2010</a>). Thus, there is good motivation for trying to understand how the feedback from hippocampal place cells may contribute to grid cell formation."
                    }, 
                    {
                        "type": "paragraph", 
                        "text": "In the present paper, we thus investigated a model of grid cell development from place cell inputs. We showed the resemblance between a feedforward network from place cells to grid cells to a neural network architecture previously used to implement the PCA algorithm (<a href=\"#bib30\">Oja, 1982</a>). We demonstrated, both analytically and through simulations, that the formation of grid cells from place cells using such a neural network could occur given specific assumptions on the input (i.e. zero mean) and on the nature of the feedforward connections (specifically, non-negative, or excitatory)."
                    }
                ]
            }, 
            {
                "type": "section", 
                "id": "s2", 
                "title": "Results", 
                "content": [
                    {
                        "type": "section", 
                        "id": "s2-1", 
                        "title": "Comparing neural-network results to PCA", 
                        "content": [
                            {
                                "type": "paragraph", 
                                "text": "We initially considered the output of a single-layer neural network and of the PCA algorithm in response to the same inputs. These consisted of the temporal activity of a simulated agent moving around in a two-dimensional (2D) space (<a href=\"#fig1\">Figure 1A</a>; see Materials and methods for details). In order to mimic place cell activity, the simulated virtual space was covered by multiple 2D Gaussian functions uniformly distributed at random (<a href=\"#fig1\">Figure 1B</a>), which constituted the input. In order to calculate the principal components, we used a [Neuron x Time] matrix (<a href=\"#fig1\">Figure 1C</a>) after subtracting the temporal mean, generated from the trajectory of the agent as it moved through the place fields. Thus, we displayed a one-dimensional mapping of the two-dimensional activity, transforming the 2D activity into a 1D vector per input neuron. This resulted in the [Neuron X Neuron] covariance matrix (<a href=\"#fig1\">Figure 1D</a>), on which PCA was performed by evaluating the appropriate eigenvalues and eigenvectors."
                            }, 
                            {
                                "type": "image", 
                                "doi": "10.7554/eLife.10094.003", 
                                "id": "fig1", 
                                "label": "Figure 1.", 
                                "title": "Construction of the correlation matrix from behavior.", 
                                "caption": [
                                    {
                                        "type": "paragraph", 
                                        "text": "(<b>A</b>) Diagram of the environment. Black dots indicate places the virtual agent has visited. (<b>B</b>) Centers of place cells uniformly distributed in the environment. (<b>C</b>) The [Neuron X Time] matrix of the input-place cells. (<b>D</b>) Correlation matrix of (<b>C</b>) used for the PCA process."
                                    }
                                ], 
                                "alt": "", 
                                "uri": "https://publishing-cdn.elifesciences.org/10094/elife-10094-fig1-v2.tif", 
                                "filename": "elife-10094-fig1-v2.tif"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "To learn the grid cells, based on the place cell inputs, we implemented a single-layer neural network with a single output (<a href=\"#fig2\">Figure 2</a>). Input to output weights were governed by a Hebbian-like learning rule. As described in the Introduction (see also analytical treatment in the Methods section), this type of architecture induces the output\u2019s weights to converge to the leading principal component of the input data."
                            }, 
                            {
                                "type": "image", 
                                "doi": "10.7554/eLife.10094.004", 
                                "id": "fig2", 
                                "label": "Figure 2.", 
                                "title": "Neural network architecture with feedforward connectivity.", 
                                "caption": [
                                    {
                                        "type": "paragraph", 
                                        "text": "The input layer corresponds to place cells and the output to a single cell."
                                    }
                                ], 
                                "alt": "", 
                                "uri": "https://publishing-cdn.elifesciences.org/10094/elife-10094-fig2-v2.tif", 
                                "filename": "elife-10094-fig2-v2.tif"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "The agent explored the environment for a sufficiently long time allowing the weights to converge to the first principal component of the temporal input data. In order to establish a spatial interpretation of the eigenvectors (from PCA) or the weights (from the converged network) we projected both the PCA eigenvectors and the network weights onto the place cells space, producing corresponding spatial activity maps. The leading eigenvectors of the PCA and the network\u2019s weights converged to square-like periodic spatial solutions (<a href=\"#fig3\">Figure 3A\u2013B</a>)."
                            }, 
                            {
                                "type": "image", 
                                "doi": "10.7554/eLife.10094.005", 
                                "id": "fig3", 
                                "label": "Figure 3.", 
                                "title": "Results of PCA and of the networks' output (in different simulations).", 
                                "caption": [
                                    {
                                        "type": "paragraph", 
                                        "text": "(<b>A</b>) 1st 16 PCA eigenvectors projected on the place cells' input space. (<b>B</b>) Converged weights of the network (each result from different simulation, initial conditions and trajectory) projected onto place cells' space. Note that the 8 outputs shown here resemble linear combinations of components #1 to #4 in panel A."
                                    }
                                ], 
                                "alt": "", 
                                "uri": "https://publishing-cdn.elifesciences.org/10094/elife-10094-fig3-v2.tif", 
                                "filename": "elife-10094-fig3-v2.tif"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "Being a PCA algorithm, the spatial projections of the weights were periodic in space due to the covariance matrix of the input having a Toeplitz structure (<a href=\"#bib8\">Dai et al., 2009</a>) (a Toeplitz matrix has constant elements along each diagonal). Intuitively, the Toeplitz structure arises due to the spatial stationarity of the input. In fact, since we used periodic boundary conditions for the agent\u2019s motion, the covariance matrix was a circulant matrix, and the eigenvectors were sinusoidal functions, with length constants determined by the scale of the box (<a href=\"#bib16\">Gray, 2006</a>) [a circulant matrix is defined by a single row (or column), and the remaining rows (or columns) are obtained by cyclic permutations. It is a special case of a Toeplitz matrix - see for example <a href=\"#fig1\">Figure 1D</a>]. The covariance matrix was heavily degenerate, with approximately 90% of the variance accounted for by the first 15% of the eigenvectors (<a href=\"#fig4\">Figure 4B</a>). The solution demonstrated a fourfold redundancy. This was apparent in the plotted eigenvalues (from the largest to the smallest eigenvalue, <a href=\"#fig4\">Figure 4A and C</a>), which demonstrated a fourfold grouping-pattern. The fourfold redundancy can be explained analytically by the symmetries of the system \u2013 see analytical treatment of PCA in Methods section (specifically Figure 15C)."
                            }, 
                            {
                                "type": "image", 
                                "doi": "10.7554/eLife.10094.006", 
                                "id": "fig4", 
                                "label": "Figure 4.", 
                                "title": "Eigenvalues and eigenvectors of the input's correlation matrix.", 
                                "caption": [
                                    {
                                        "type": "paragraph", 
                                        "text": "(<b>A</b>) Eigenvalue size (normalized by the largest, from large to small (<b>B</b>) Cumulative explained variance by the eigenvalues, with 90% of variance accounted for by the first 35 eigenvectors (out of 625). (<b>C</b>) Amplitude of leading 32 eigenvalues, demonstrating that they cluster in groups of 4 or 8. Specifically, the first four clustered groups correspond respectively (from high to low) to groups A,B,C\u00a0&amp;\u00a0D In <a href=\"#fig15\">Figure 15C</a>, which have the same redundancy (4,8,4 &amp; 4)."
                                    }
                                ], 
                                "alt": "", 
                                "uri": "https://publishing-cdn.elifesciences.org/10094/elife-10094-fig4-v2.tif", 
                                "filename": "elife-10094-fig4-v2.tif"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "In summary, both the direct PCA algorithm and the neural network solutions developed periodic structure. However, this periodic structure was not hexagonal but rather had a square-like form."
                            }
                        ]
                    }, 
                    {
                        "type": "section", 
                        "id": "s2-2", 
                        "title": "Adding a non-negativity constraint to the PCA", 
                        "content": [
                            {
                                "type": "paragraph", 
                                "text": "It is known that most synapses from the hippocampus to the MEC are excitatory (<a href=\"#bib45\">Witter and Amaral, 2004</a>). We thus investigated how a non-negativity constraint, applied to the projections from place cells to grid cells, affected our simulations. As demonstrated in the analytical treatment in the Methods section, we could expect to find hexagons when imposing the non-negativity constraint. Indeed, when adding this constraint, the outputs behaved in a different manner and converged to a <b>hexagonal grid</b>, similar to real grid cells. While it was straightforward to constrain the neural network, calculating non-negative PCA directly was a more complicated task due to the non-convex nature of the problem (<a href=\"#bib26\">Montanari and Richard, 2014</a>; <a href=\"#bib22\">Kushner and Clark, 1978</a>)."
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "In the network domain, we used a simple rectification rule for the learned feedforward weights, which constrained their values to be non-negative. For the direct non-negative PCA calculation, we used the raw place cells activity (after spatial or temporal mean normalization), as inputs to three different iterative numerical methods: NSPCA (Nonnegative Sparse PCA), AMP (Approximate Message Passing) and FISTA (Fast Iterative Threshold and Shrinkage) based algorithms (see Materials and methods section)."
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "In both cases, we found that hexagonal grid cells emerged in the output layer (plotted as spatial projection of weights and eigenvectors: <a href=\"#fig5\">Figure 5A\u2013B</a>, <a href=\"#fig6\">Figure 6A\u2013B</a>, <a href=\"#media1\">Video 1</a>, <a href=\"#media2\">Video 2</a>). When we repeated the process over many simulations (i.e. new trajectories and random initializations of weights) we found that the population as a whole consistently converged to hexagonal grid-like responses, while similar simulations with the unconstrained version did not (compare <a href=\"#fig3\">Figure 3</a> to <a href=\"#fig5\">Figure 5</a>\u2013<a href=\"#fig6\">Figure 6</a>)."
                            }, 
                            {
                                "type": "image", 
                                "doi": "10.7554/eLife.10094.007", 
                                "id": "fig5", 
                                "label": "Figure 5.", 
                                "title": "Output of the neural network when weights are constrained to be non-negative.", 
                                "caption": [
                                    {
                                        "type": "paragraph", 
                                        "text": "(<b>A</b>) Converged weights (from different simulations) of the network projected onto place cells space. See an example of a simulation in <a href=\"#media1\">Video 1</a>. (<b>B</b>) Spatial autocorrelations of (<b>A</b>). See an example of the evolution of autorcorrelation in simulation in <a href=\"#media2\">Video 2</a>."
                                    }
                                ], 
                                "alt": "", 
                                "uri": "https://publishing-cdn.elifesciences.org/10094/elife-10094-fig5-v2.tif", 
                                "filename": "elife-10094-fig5-v2.tif"
                            }, 
                            {
                                "type": "video", 
                                "doi": "10.7554/eLife.10094.008", 
                                "id": "media1", 
                                "label": "Video 1.", 
                                "title": "Evolution in time of the network's weights.", 
                                "caption": [
                                    {
                                        "type": "paragraph", 
                                        "text": "625 Place-cells used as input. Video frame shown every 3000 time steps up to t=1,000,000. Video converges to results similar to those of <a href=\"#fig5\">Figure 5</a>."
                                    }
                                ], 
                                "width": 90, 
                                "image": "https://static-movie-usa.glencoesoftware.com/jpg/10.7554/829/0385582b8bbd633e5efdcbbc776b8f2011a0af78/elife-10094-media1.jpg", 
                                "height": 90, 
                                "sources": [
                                    {
                                        "mediaType": "video/mp4; codecs=\"avc1.42E01E, mp4a.40.2\"", 
                                        "uri": "https://static-movie-usa.glencoesoftware.com/mp4/10.7554/829/0385582b8bbd633e5efdcbbc776b8f2011a0af78/elife-10094-media1.mp4"
                                    }, 
                                    {
                                        "mediaType": "video/ogg; codecs=\"theora, vorbis\"", 
                                        "uri": "https://static-movie-usa.glencoesoftware.com/ogv/10.7554/829/0385582b8bbd633e5efdcbbc776b8f2011a0af78/elife-10094-media1.ogv"
                                    }, 
                                    {
                                        "mediaType": "video/webm; codecs=\"vp8.0, vorbis\"", 
                                        "uri": "https://static-movie-usa.glencoesoftware.com/webm/10.7554/829/0385582b8bbd633e5efdcbbc776b8f2011a0af78/elife-10094-media1.webm"
                                    }
                                ]
                            }, 
                            {
                                "type": "video", 
                                "doi": "10.7554/eLife.10094.009", 
                                "id": "media2", 
                                "label": "Video 2.", 
                                "title": "Evolution of autocorrelation pattern of network's weights shown in <a href=\"#media1\">Video 1</a>.", 
                                "width": 178, 
                                "image": "https://static-movie-usa.glencoesoftware.com/jpg/10.7554/829/0385582b8bbd633e5efdcbbc776b8f2011a0af78/elife-10094-media2.jpg", 
                                "height": 178, 
                                "sources": [
                                    {
                                        "mediaType": "video/mp4; codecs=\"avc1.42E01E, mp4a.40.2\"", 
                                        "uri": "https://static-movie-usa.glencoesoftware.com/mp4/10.7554/829/0385582b8bbd633e5efdcbbc776b8f2011a0af78/elife-10094-media2.mp4"
                                    }, 
                                    {
                                        "mediaType": "video/ogg; codecs=\"theora, vorbis\"", 
                                        "uri": "https://static-movie-usa.glencoesoftware.com/ogv/10.7554/829/0385582b8bbd633e5efdcbbc776b8f2011a0af78/elife-10094-media2.ogv"
                                    }, 
                                    {
                                        "mediaType": "video/webm; codecs=\"vp8.0, vorbis\"", 
                                        "uri": "https://static-movie-usa.glencoesoftware.com/webm/10.7554/829/0385582b8bbd633e5efdcbbc776b8f2011a0af78/elife-10094-media2.webm"
                                    }
                                ]
                            }, 
                            {
                                "type": "image", 
                                "doi": "10.7554/eLife.10094.010", 
                                "id": "fig6", 
                                "label": "Figure 6.", 
                                "title": "Results from the non-negative PCA algorithm.", 
                                "caption": [
                                    {
                                        "type": "paragraph", 
                                        "text": "(<b>A</b>) Spatial projection of the leading eigenvector on input space. (<b>B</b>) Corresponding spatial autocorrelations. The different solutions are outcomes of multiple simulations with identical settings in a new environment and new random initial conditions."
                                    }
                                ], 
                                "alt": "", 
                                "uri": "https://publishing-cdn.elifesciences.org/10094/elife-10094-fig6-v2.tif", 
                                "filename": "elife-10094-fig6-v2.tif"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "In order to further assess the hexagonal grid emerging in the output, we calculated the mean (hexagonal) Gridness scores ([<a href=\"#bib32\">Sargolini et al., 2006</a>], which measure the degree to which the solution resembles a hexagonal grid [see Materials\u00a0and\u00a0methods]). We ran about 1500 simulations of the network (in each simulation, the network consisted of 625 place cell-like inputs and a single grid cell-like output), and found noticeable differences between the constrained and unconstrained cases. Namely, the Gridness score in the non-negatively constrained-weight simulations was significantly higher than in the unconstrained-weight case (Gridness = 1.07 \u00b1 0.003 in the constrained case vs. 0.302 \u00b1 0.003 in the unconstrained case. see <a href=\"#fig7\">Figure 7</a>). A similar difference was observed with the direct non-negative\u00a0PCA methods (1500 simulations, each with different trajectories, Gridness = 1.13 \u00b1 0.0022 in the constrained case vs. 0.27 \u00b1 0.0023 in the unconstrained case)."
                            }, 
                            {
                                "type": "image", 
                                "doi": "10.7554/eLife.10094.011", 
                                "id": "fig7", 
                                "label": "Figure 7.", 
                                "title": "Histograms of Gridness values from network and PCA.", 
                                "caption": [
                                    {
                                        "type": "paragraph", 
                                        "text": "First row (<b>A</b>) + (<b>C</b>) corresponds to network results, and second row (<b>B</b>) + (<b>D</b>) to PCA. The left column histograms contain the 60\u00b0\u00a0Gridness scores and the right one the 90\u00b0\u00a0Gridness scores."
                                    }
                                ], 
                                "alt": "", 
                                "uri": "https://publishing-cdn.elifesciences.org/10094/elife-10094-fig7-v2.tif", 
                                "filename": "elife-10094-fig7-v2.tif"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "Another score we tested was a 'Square Gridness' score (see Materials\u00a0and\u00a0methods) where we measured the 'Squareness' of the solutions (as opposed to 'Hexagonality'). We found that the unconstrained network had a higher square-Gridness score while the constrained network had a lower square-Gridness score (<a href=\"#fig7\">Figure 7</a>); for both the direct-PCA calculation (square-Gridness = 0.89 \u00b1 0.0074 in the unconstrained case vs. 0.1 \u00b1 0.006 in the constrained case) and the neural-network (square-Gridness = 0.073 \u00b1 0.006 in the constrained case vs. 0.73 \u00b1 0.008 in the unconstrained case)."
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "All in all, these results suggest that when direct PCA eigenvectors and neural network weights were unconstrained they converged to periodic square solutions. However, when constrained to be non-negative, the direct PCA, and the corresponding neural network weights, both converged to a hexagonal solution."
                            }
                        ]
                    }, 
                    {
                        "type": "section", 
                        "id": "s2-3", 
                        "title": "Dependence of the result on the structure of the input", 
                        "content": [
                            {
                                "type": "paragraph", 
                                "text": "We investigated the effect of different inputs on the emergence of the grid structure in the networks' output. We found that some manipulation of the input was necessary in orderto enable the implementation of PCA in the neural network. Specifically, PCA requires a zero-mean input, while simple Gaussian-like place cells do not possess this property. In order to obtain input with zero-mean, we either performed differentiation of the place cells\u2019 activity in time, or used a Mexican-hat like (Laplacian) shape (See Materials\u00a0and\u00a0methods for more details on the different types of inputs). Another option we explored was the usage of positive-negative disks with a total sum of zero activity in space (<a href=\"#fig8\">Figure 8</a>). The motivation for the use of Mexican-hat like transformations is their abundance in the nervous system (<a href=\"#bib43\">Wiesel and Hubel, 1963</a>; <a href=\"#bib12\">Enroth-Cugell and Robson, 1966</a>; <a href=\"#bib9\">Derdikman et al., 2003</a>)."
                            }, 
                            {
                                "type": "image", 
                                "doi": "10.7554/eLife.10094.012", 
                                "id": "fig8", 
                                "label": "Figure 8.", 
                                "title": "Different types of spatial\u00a0input used in our network.", 
                                "caption": [
                                    {
                                        "type": "paragraph", 
                                        "text": "(<b>A</b>) 2D Gaussian function, acting as a simple place cell. (<b>B</b>) Laplacian function or Mexican hat. (<b>C</b>) A positive (inner circle) - negative (outer ring) disk. While inputs as in panel A do not converge to hexagonal grids, inputs as in panels B or C do converge."
                                    }
                                ], 
                                "alt": "", 
                                "uri": "https://publishing-cdn.elifesciences.org/10094/elife-10094-fig8-v2.tif", 
                                "filename": "elife-10094-fig8-v2.tif"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "We found that usage of simple 2-D Gaussian-functions as inputs did not generate hexagonal grid cells as outputs (<a href=\"#fig9\">Figure 9</a>). On the other hand, time-differentiated inputs, positive-negative disks or Laplacian inputs did generate grid-like output cells, both when running the non-negative PCA directly (<a href=\"#fig6\">Figure 6</a>), or by simulating the non-negatively constrained Neural Network (<a href=\"#fig5\">Figure 5</a>). Another approach we used for obtaining zero-mean was to subtract the mean dynamically from every output individually (see Materials\u00a0and\u00a0methods). The latter approach, related to adaptation of the firing rate, was adopted from Kropff &amp; Treves (<a href=\"#bib21\">Kropff and Treves, 2008</a>), who used it to control various aspects of the grid cell's activity. In addition to controlling the firing rate of the grid cells, if applied correctly, the adaptation could be exploited to keep the output's activity stable, with zero-mean rates. We applied this method in our system and in this case the outputs converged to hexagonal grid cells as well, similarly to the previous cases (e.g. derivative in time, or Mexican hats as inputs; data not shown)."
                            }, 
                            {
                                "type": "image", 
                                "doi": "10.7554/eLife.10094.013", 
                                "id": "fig9", 
                                "label": "Figure 9.", 
                                "title": "Spatial projection of outputs\u2019 weights in the neural network when inputs did not have zero mean (such as in <a href=\"#fig8\">Figure 8A</a>).", 
                                "caption": [
                                    {
                                        "type": "paragraph", 
                                        "text": "(<b>A</b>) Various weights plotted spatially as projection onto place cells space. (<b>B</b>) Autocorrelation of (<b>A</b>)."
                                    }
                                ], 
                                "alt": "", 
                                "uri": "https://publishing-cdn.elifesciences.org/10094/elife-10094-fig9-v2.tif", 
                                "filename": "elife-10094-fig9-v2.tif"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "In summary, two conditions were required for the neural network to converge to spatial solutions resembling hexagonal grid cells: (1) non-negativity of the feedforward weights and (2) an effective zero-mean of the inputs (in time or space)."
                            }
                        ]
                    }, 
                    {
                        "type": "section", 
                        "id": "s2-4", 
                        "title": "Stability analysis", 
                        "content": [
                            {
                                "type": "section", 
                                "id": "s2-4-1", 
                                "title": "Convergence to hexagons from various initial spatial conditions", 
                                "content": [
                                    {
                                        "type": "paragraph", 
                                        "text": "In order to numerically test the stability of the hexagonal solution, we initialized the network in different ways, randomly, using linear stripes, squares, rhomboids (squares on hexagonal lattice) and noisy hexagons. In all cases, the network converged to a hexagonal pattern (<a href=\"#fig10\">Figure 10</a>; for squares and stripes, other shapes not shown here)."
                                    }, 
                                    {
                                        "type": "image", 
                                        "doi": "10.7554/eLife.10094.014", 
                                        "id": "fig10", 
                                        "label": "Figure 10.", 
                                        "title": "Evolution in time of the networks\u2019 solutions (upper rows) and their autocorrelations (lower rows).", 
                                        "caption": [
                                            {
                                                "type": "paragraph", 
                                                "text": "The network was initialized in shapes of (<b>A</b>) Squares and of (<b>B</b>) stripes (linear)."
                                            }
                                        ], 
                                        "alt": "", 
                                        "uri": "https://publishing-cdn.elifesciences.org/10094/elife-10094-fig10-v2.tif", 
                                        "filename": "elife-10094-fig10-v2.tif"
                                    }, 
                                    {
                                        "type": "paragraph", 
                                        "text": "We also ran the converged weights in a new simulation with novel trajectories and tested the Gridness scores, and the inter-trial stability in comparison to previous simulations. We found that the hexagonal solutions of the network remained stable although the trajectories varied drastically (data not shown)."
                                    }
                                ]
                            }
                        ]
                    }, 
                    {
                        "type": "section", 
                        "id": "s2-5", 
                        "title": "Asymptotic stability of the equilibria", 
                        "content": [
                            {
                                "type": "paragraph", 
                                "text": "Under certain conditions (e.g., decaying learning rates and independent and identically distributed (i.i.d.) inputs), it was previously proved (<a href=\"#bib18\">Hornik and Kuan, 1992</a>), using techniques from the theory of stochastic approximation, that the system described here can be asymptotically analyzed in terms of (deterministic) Ordinary Differential Equations (ODE), rather than in terms of the stochastic recurrence equations. Since the ODE defining the converged weights is non-linear, we solved the ODEs numerically (see Materials\u00a0and\u00a0methods), by randomly initializing the weight vector. The asymptotic equilibria were reached much faster, compared to the outcome of the recurrence equations. Similarly to the recurrence equations, constraining the weights to be non-negative induced them to converge into a hexagonal shape while a non-constrained system produced square-like outcomes (<a href=\"#fig11\">Figure 11</a>)."
                            }, 
                            {
                                "type": "image", 
                                "doi": "10.7554/eLife.10094.015", 
                                "id": "fig11", 
                                "label": "Figure 11.", 
                                "title": "Numerical convergence of the ODE to hexagonal results when weights are constrained.", 
                                "caption": [
                                    {
                                        "type": "paragraph", 
                                        "text": "(<b>A</b>) + (<b>B</b>): 60\u00b0\u00a0and 90\u00b0 Gridness score histograms. Each score represents a different weight vector of the solution J. (<b>C</b>) + (<b>D</b>): Spatial results for constrained and unconstrained scenarios, respectively. (<b>E</b>) + (<b>F</b>) Spatial autocorrelations of (<b>C</b>) + (<b>D</b>)."
                                    }
                                ], 
                                "alt": "", 
                                "uri": "https://publishing-cdn.elifesciences.org/10094/elife-10094-fig11-v2.tif", 
                                "filename": "elife-10094-fig11-v2.tif"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "Simulation was run 60 times, with 400 outputs per run. 60\u00b0\u00a0Gridness score mean was 1.1 \u00b1 0.0006 when weights were constrained and 0.29 \u00b1 0.0005 when weights were unconstrained. 90\u00b0\u00a0Gridness score mean was 0.006 \u00b1 0.002 when weights were constrained and 0.8 \u00b1 0.0017 when weights were unconstrained."
                            }
                        ]
                    }, 
                    {
                        "type": "section", 
                        "id": "s2-6", 
                        "title": "Effect of place cell parameters on grid structure", 
                        "content": [
                            {
                                "type": "paragraph", 
                                "text": "A more detailed view of the resulting grid spacing showed that it was heavily dependent on the field widths of the place cells inputs. When the environment size was fixed and the output calculated per input size, the grid-spacing (distance between neighboring peaks) increased for larger place cell field widths."
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "To enable a fast parameter sweep over many place cell field widths (and large environment sizes), we took the steady state limit, and the limit of a high density of place cell locations, and used the fast FISTA algorithm to solve the non-negative PCA problem (see Materials\u00a0and\u00a0methods section)."
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "We performed multiple simulations, and found that there was a simple linear dependency between the place field size and the output grid scale. For the case of periodic boundary conditions, we found that grid scale was S = 7.5sigma+0.85, where sigma was the width of the place cell field (<a href=\"#fig12\">Figure 12A</a>). For a different set of simulations with zero boundary conditions, we achieved a similar relation: S=7.54sigma+0.62 (figure not shown). Grid scale was more dependent on place field size and less on box size (<a href=\"#fig12\">Figure 12H</a>). We note that for very large environments, the effects of boundary conditions diminishes. At this limit, this linear relation between place field size and grid scale can be explained from analytical considerations (see Materials and methods section). Intuitively, this follows from dimensional analysis: given an infinite environment, at steady state the length scale of the place cell field width is the only length scale in the model, so any other length scale must be proportional to this scale. More precisely, we can provide a lower bound for the linear fit (<a href=\"#fig12\">Figure 12A</a>), which depends only on the tuning curve of the place cells (see Materials\u00a0and\u00a0methods section). This lower bound was derived for periodic boundary conditions, but works well even with zero boundary conditions (not shown)."
                            }, 
                            {
                                "type": "image", 
                                "doi": "10.7554/eLife.10094.016", 
                                "id": "fig12", 
                                "label": "Figure 12.", 
                                "title": "Effect of changing the place-field size in fixed arena (FISTA algorithm used; periodic boundary conditions and Arena size 500);", 
                                "caption": [
                                    {
                                        "type": "paragraph", 
                                        "text": "(<b>A</b>) Grid scale as a function of place field size (sigma); Linear fit is: Scale = 7.4 Sigma+0.62; the lower bound, equal to <math id=\"inf1\"><mrow><mn>2</mn><mi>\u03c0</mi><mo>/</mo><msub><mi>k</mi><mo>\u2020</mo></msub></mrow></math>, were <math id=\"inf2\"><mrow><msub><mi>k</mi><mo>\u2020</mo></msub></mrow></math> is defined in <a href=\"#equ34\">Equation 32</a> in the Materials\u00a0and\u00a0methods section; (<b>B</b>) Grid orientation as a function of gridness; (<b>C</b>) Grid orientation as a function of sigma \u2013 scatter plot (blue stars) and mean (green line); (<b>D</b>) Histogram of grid orientations; (<b>E</b>) Mean gridness as a function of sigma; and (<b>F</b>) Histogram of mean gridness. (<b>G</b>) Gridness as a function of sigma and (arena-size/sigma) (zero boundary conditions). (<b>H</b>) Grid scale for the same parameters as in G."
                                    }
                                ], 
                                "alt": "", 
                                "uri": "https://publishing-cdn.elifesciences.org/10094/elife-10094-fig12-v2.tif", 
                                "filename": "elife-10094-fig12-v2.tif"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "Furthermore, we found that the grid orientation varied substantially for different place cell field widths, in the possible range of 0\u201315 degrees (<a href=\"#fig12\">Figure 12C,D</a>). For small environments, the orientation strongly depended on the boundary conditions. However, as described in the Methods section, analytical considerations suggest that as the environment grows, the distribution of grid orientations becomes uniform in the range of 0\u201315 degrees, with a mean at 7.5\u00b0. Intuitively, this can be explained by rotational symmetry \u2013 when the environment size is infinite, all directions in the model are equivalent, and so we should get all orientations with equal probability, if we start the model from a uniformly random initialization. In addition, grid orientation was not a clear function of the gridness of the obtained grid cells (<a href=\"#fig12\">Figure 12B</a>). For large enough place cells, gridness was larger than 1 (<a href=\"#fig12\">Figure 12E\u2013G</a>)."
                            }
                        ]
                    }, 
                    {
                        "type": "section", 
                        "id": "s2-7", 
                        "title": "Modules of grid cells", 
                        "content": [
                            {
                                "type": "paragraph", 
                                "text": "It is known that in reality grid cells form in modules of multiple spacings (<a href=\"#bib1\">Barry et al., 2007</a>; <a href=\"#bib37\">Stensola et al., 2012</a>). We tried to address this question of modules in several ways. First, we used different widths for the Gaussian/Laplacian input functions: Initially, we placed a heterogeneous population of widths in a given environment (i.e., uniformly random widths) and ran the single-output network 100 times. The distribution of grid spacings was almost comparable to the results of the largest width if applied alone, and did not exhibit module like behavior. This result is not surprising when thinking about a small place cell overlapping in space with a large place cell. Whenever the agent passes next to the small one, it activates both weights via synaptic learning. This causes the large firing field to overshadow the smaller one. Additionally, when using populations of only two widths of place fields, the grid spacings were dictated by the size of the larger place field (data not shown)."
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "The second option we considered was to use a multi-output neural network, capable of computing all 'eigenvectors' rather than only the principal 'eigenvector' (where by 'eigenvector' we mean here the vectors achieved under the positivity constraint, and not the exact eigenvectors themselves). We used a hierarchical network implementation introduced by <a href=\"#bib31\">Sanger, 1989</a> (see Materials\u00a0and\u00a0methods). Since the 1<sup>st</sup> output\u2019s weights converged to the 1<sup>st</sup>\u00a0'eigenvector', the network (<a href=\"#fig13\">Figure 13A\u2013B</a>) provided to the subsequent outputs (2<sup>nd</sup>, 3<sup>rd</sup>, and so forth) a reduced-version of the data from which the projection of the 1<sup>st</sup>\u00a0'eigenvector' has been subtracted out. This process, reminiscent of Gram-Schmidt orthogonalization, was capable of computing all 'eigenvectors' (in the modified sense) of the input's covariance matrix. It is important to note though that, due to the non-negativity constraint, the vectors achieved in this way were not orthogonal, and thus it cannot be considered a real orthogonalization process, although, as explained in the Methods section, the process does aim for maximum difference between the vectors."
                            }, 
                            {
                                "type": "image", 
                                "doi": "10.7554/eLife.10094.017", 
                                "id": "fig13", 
                                "label": "Figure 13.", 
                                "title": "Hierarchial network capable of computing all 'principal components'.", 
                                "caption": [
                                    {
                                        "type": "paragraph", 
                                        "text": "(<b>A</b>) Each output is a linear sum of all inputs weighted by the corresponding learned weights. (<b>B</b>) Over time, the data the following outputs 'see' is the original data after subtration of the 1st 'eigenvector's' projection onto it. This is an iterative process causing all outputs' weights to converge to the 'prinipcal components' of the data."
                                    }
                                ], 
                                "alt": "", 
                                "uri": "https://publishing-cdn.elifesciences.org/10094/elife-10094-fig13-v2.tif", 
                                "filename": "elife-10094-fig13-v2.tif"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "When constrained to be non-negative, and using the same homogeneous 'place cells' as in the previous network, the networks' weights converged to hexagonal shapes. Here, however, we found that the smaller the 'eigenvalue' was (or the higher the principal component number) the denser the grid became. We were able to identify two main populations of grid-distance 'modules' among the hexagonal spatial solutions with high Gridness scores (&gt;0.7, <a href=\"#fig14\">Figure 14A\u2013B</a>). In addition, we found that the ratio between the distances of the modules was \u22121.4, close to the value of 1.42 found by Stensola et al. (<a href=\"#bib37\">Stensola et al., 2012</a>). Although we searched for additional such jumps, we could only identify this single jump, suggesting that our model can yield up to two 'modules' and not more. The same process was repeated using the direct PCA method, utilizing the covariance matrix of the data after simulation as input for the non-negative PCA algorithms, and considering their ability to calculate only the 1<sup>st</sup>\u00a0'eigenvector'. By iteratively projecting the 1<sup>st\u00a0</sup>'eigenvector' on the simulation data and subtracting the outcome from the original data, we applied the non-negative PCA algorithm to the residual data obtaining the 2<sup>nd\u00a0</sup>'eigenvector' of the original data. This 'eigenvector'\u00a0now constituted the 1<sup>st</sup>\u00a0eigenvector' of the new residual data (see Materials\u00a0and\u00a0methods). Applying this process to as many 'outputs' as needed, we obtained very similar results to the ones presented above using the neural network (data not shown)."
                            }, 
                            {
                                "type": "image", 
                                "doi": "10.7554/eLife.10094.018", 
                                "id": "fig14", 
                                "label": "Figure 14.", 
                                "title": "Modules of grid cells.", 
                                "caption": [
                                    {
                                        "type": "paragraph", 
                                        "text": "(<b>A</b>) In a network with 50 outputs, the grid spacing per output is plotted with respect to the hierarchical place of the output. (<b>B</b>) The grid spacing of outputs with high Gridness score (&gt;0.7). The centroids have a ratio of close to <math id=\"inf3\"><mrow><mo>\u221a</mo><mn>2</mn></mrow></math>. (<b>C</b>) + (<b>D</b>) Example of rate maps of outputs and their spatial autocorrelations for both of the modules."
                                    }
                                ], 
                                "alt": "", 
                                "uri": "https://publishing-cdn.elifesciences.org/10094/elife-10094-fig14-v2.tif", 
                                "filename": "elife-10094-fig14-v2.tif"
                            }
                        ]
                    }
                ]
            }, 
            {
                "type": "section", 
                "id": "s3", 
                "title": "Discussion", 
                "content": [
                    {
                        "type": "paragraph", 
                        "text": "In our work, we explored the nature and behavior of the feedback projections from place cells to grid cells. We shed light on the importance of this relation and showed, both analytically and in simulation, how a simple single-layer neural network could produce hexagonal grid cells when subjected to place cell-like temporal input from a randomly-roaming moving agent. We found that the network resembled a neural network performing PCA (<a href=\"#bib30\">Oja, 1982</a>), with the constraint that the weights were non-negative. Under these conditions, and also under the requirements that place cells have a zero mean in time or space, the first principal component in the 2D arena had a firing pattern resembling a hexagonal grid cell. Furthermore, we found that in the limit of very large arenas, grid orientation converged to a uniform distribution in range of 0\u201315\u00b0. When looking at additional components, grid scale tends to be discretely clustered, such that two modules emerge. This is partially consistent with current experimental findings (<a href=\"#bib37\">Stensola et al., 2012</a>; <a href=\"#bib38\">2015</a>). Furthermore, the inhibitory connectivity between multiple grid cells is consistent with the known functional anatomy in this network (<a href=\"#bib7\">Couey et al., 2013</a>)."
                    }, 
                    {
                        "type": "section", 
                        "id": "s3-1", 
                        "title": "Place-to-Grid as a PCA network", 
                        "content": [
                            {
                                "type": "paragraph", 
                                "text": "As a consequence of the requirements for PCA to hold, we found that the place cell input needed to have\u00a0a zero-mean, otherwise the output was not periodic. Due to the lack of the zero-mean property in 2D Gaussians, we used various approaches to impose zero-mean on the input data. The first, in the time domain, was to differentiate the input and use the derivatives (a random walk produces zero-mean derivatives) as inputs. Another approach was to dynamically subtract the mean in all iterations of the simulation. This approach was reminiscent of the adaptation procedure suggested in the Kropff &amp; Treves paper (<a href=\"#bib21\">Kropff and Treves, 2008</a>). A third approach, applied in the spatial domain was to use inputs with a zero-spatial mean such as Laplacians of Gaussians (Mexican hats in 2D, or differences-of-Gaussians) or negative \u2013 positive disks. Such Mexican-hat inputs are quite typical in the nervous system (<a href=\"#bib43\">Wiesel and Hubel, 1963</a>; <a href=\"#bib12\">Enroth-Cugell and Robson, 1966</a>; <a href=\"#bib9\">Derdikman et al., 2003</a>), although in the case of place cells it is not completely known how they are formed. They could be a result of interaction between place cells and the vast number of inhibitory interneurons in the local hippocampal network (<a href=\"#bib14\">Freund and Buzs\u00e1ki, 1996</a>)."
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "Another condition we found crucial, which was not part of the original PCA network, was a non-negativity constraint on the place-to-grid learned weights. While rather easy to implement in the network, adding this constraint to the non-convex PCA problem was harder to implement. Since the problem is NP-hard (<a href=\"#bib26\">Montanari and Richard, 2014</a>), we turned to numerical methods. We used three different algorithms (<a href=\"#bib26\">Montanari and Richard, 2014</a>; <a href=\"#bib46\">Zass and Shashua, 2006</a>; <a href=\"#bib2\">Beck and Teboulle, 2009</a>) to find the leading 'eigenvector' of every given temporal based input. As shown in the results section, both processes (i.e. direct PCA and the neural network) resulted in hexagonal outcomes when the non-negativity and zero-mean criteria were met. Note that the ease of use of the neural network for solving the positive PCA problem is a nice feature of the neural network implementation, and should be investigated further."
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "We also\u00a0note that while our network focused on the projection from place cells to grid cells, we cannot preclude the importance of the reciprocal projection from grid cells to place cells. Further study will be needed to \u2018close the loop\u2019 and simultaneously consider both of these projections at once."
                            }
                        ]
                    }, 
                    {
                        "type": "section", 
                        "id": "s3-2", 
                        "title": "Similar studies", 
                        "content": [
                            {
                                "type": "paragraph", 
                                "text": "We note that similar work has noticed the relation between place-cell-to-grid-cell transformation and PCA. Notably, <a href=\"#bib36\">Stachenfeld et al., (2014)</a> have demonstrated, from considerations related to reinforcement learning, that grid cells could be related to place cells through a PCA transformation. However, due to the unconstrained nature of their transformation, the resulting grid cells were square-like. Furthermore, there has been an endeavor to model the transformation from place cells to grid cells using independent-component-analysis (<a href=\"#bib13\">Franzius et al., 2007</a>)."
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "We also note that there is now a surge of interest in the feedback projection from place cells to grid-cells, which is inverse to the anatomical downstream direction from grid cells to place cells (<a href=\"#bib45\">Witter and Amaral, 2004</a>) that has guided most of the models to-date (<a href=\"#bib47\">Zilli, 2012</a>; <a href=\"#bib15\">Giocomo et al., 2011</a>). In addition to several papers from the Treves group, in which the projection from place cells to grid cells is studied (<a href=\"#bib21\">Kropff and Treves, 2008</a>; <a href=\"#bib34\">Si and Treves, 2013</a>), there has been also recent work from other groups as well exploring this direction (<a href=\"#bib6\">Castro and Aguiar, 2014</a>; <a href=\"#bib39\">Stepanyuk, 2015</a>). As far as we are aware, none of the previous studies noted the importance of the non-negativity constraint and the requirement of zero mean input. Additionally, to the best of our knowledge, the analytic results and insights provided in this work (see Materials and methods)\u00a0are novel, and provide a mathematically consistent explanation for the emergence of hexagonally-spaced grid cells."
                            }
                        ]
                    }, 
                    {
                        "type": "section", 
                        "id": "s3-3", 
                        "title": "Predictions of our model", 
                        "content": [
                            {
                                "type": "paragraph", 
                                "text": "Based on the findings of this work, it is possible to make several predictions. First, the grid cells must receive zero-mean input over time to produce hexagonally shaped firing patterns. With all feedback projections from place cells being excitatory, the lateral inhibition from other neighboring grid cells might be the balancing parameter to achieve the temporal zero-mean (<a href=\"#bib7\">Couey et al., 2013</a>). Alternatively, an adaptation method, such as the one suggested in <a href=\"#bib21\">Kropff and Treves, (2008)</a> may be applied. Second, if indeed the grid cells are a lower dimensional representation of the place cells in a PCA form, the place-to-grid neural weights distribution should be similar across identically spaced grid cell populations. This is because all grid cells with similar spacing would have maximized the variance over the same input, resulting in similar spatial solutions. As an aside, we note that such a projection may be a source of phase-related correlations in grid cells (<a href=\"#bib40\">Tocker et al., 2015</a>). Third, we found a linear relation between the size of the place cells and the spacing between grid cells. Furthermore, the spacing of the grid cells is mostly determined by the size of the largest place cell \u2013 predicting that the feedback from large place cells is not connected to grid cells with small spacing. Fourth, we found modules of different grid spacings in a hierarchical network with the ratio of distances between successive units close to\u00a0\u221a2. This result is in accordance with the ratio reported in <a href=\"#bib37\">Stensola et al., (2012)</a>. However, we note that there is a difference between our results and experimental results because the analysis predicts that there should only be two modules, while the data show at least 5 modules, with a range of scales, the smallest and most numerous having approximately the scale of the smaller place fields found in the dorsal hippocampus (25\u201330\u00a0cm). Fifth, for large enough environments our model suggests that, from mathematical considerations, the grid orientation should approach a uniform orientation in the possible range of 0\u201315\u00b0. This is in discrepancy with experimental results which measure a peak at 7.5\u00b0, and not a uniform distribution (<a href=\"#bib38\">Stensola et al., 2015</a>). As noted, the discrepancies between our results and reality may relate to the fact that a more advanced model will have to take into account both the downstream projection from grid cells to place cells together with the upstream projection from place cells to grid cells discussed in this paper. Furthermore, such a model will have to take into account the non-uniform distribution of place-cell widths (<a href=\"#bib20\">Kjelstrup et al., 2008</a>)."
                            }
                        ]
                    }, 
                    {
                        "type": "section", 
                        "id": "s3-4", 
                        "title": "Why hexagons?", 
                        "content": [
                            {
                                "type": "paragraph", 
                                "text": "In light of our results, we further asked what is special about the hexagonal shape which renders it a stable solution. Past works have demonstrated that hexagonality is optimal in terms of efficient coding. Two recent papers have addressed the potential benefit of encoding by grid cells. <a href=\"#bib24\">Mathis et al., (2015)</a> considered the decoding of spatial information based on a grid-like periodic representation. Using lower bounds on the reconstruction error based on a Fisher information criterion, they demonstrated that hexagonal grids lead to the highest spatial resolution in two dimensions (extensions to higher dimensions were also provided). The solution is obtained by mapping the problem onto a circle packing problem. The work of <a href=\"#bib41\">Wei et al., (2013)</a> also took a decoding perspective, and showed that hexagonal grids minimize the number of neurons required to encode location with a given resolution. Both papers offer insights into the possible information theoretic benefits of the hexagonal grid solution. In the present paper, we were mainly concerned with a specific biologically motivated learning (development) mechanism that may yield such a solution. Our analysis suggests that the hexagonal patterns can arise as a solution that maximizes the grid cell output variance, under non-negativity constraints. In Fourier space, the solution is a hexagonal lattice with lattice constant near the peak of the Fourier transform of the place cell tuning curve (<a href=\"#fig15\">Figures 15</a> and <a href=\"#fig16\">16</a>; see Materials and methods)."
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "To conclude, this work demonstrates how grid cells could be formed from a simple Hebbian neural network with place cells as inputs, without needing to rely on path-integration mechanisms."
                            }
                        ]
                    }
                ]
            }, 
            {
                "type": "section", 
                "id": "s4", 
                "title": "Materials and methods", 
                "content": [
                    {
                        "type": "paragraph", 
                        "text": "All code was written in MATLAB, and can be obtained on <a href=\"https://github.com/derdikman/Dordek-et-al.-Matlab-code.git\">https://github.com/derdikman/Dordek-et-al.-Matlab-code.git</a> or on request from authors."
                    }, 
                    {
                        "type": "section", 
                        "id": "s4-1", 
                        "title": "Neural network architecture", 
                        "content": [
                            {
                                "type": "paragraph", 
                                "text": "We implemented a single-layer neural network with feedforward connections that was capable of producing a hexagonal-like output (<a href=\"#fig2\">Figure 2</a>). The feedforward connections were updated according to a self-normalizing version of a Hebbian learning rule referred to as the Oja rule (<a href=\"#bib30\">Oja, 1982</a>),"
                            }, 
                            {
                                "type": "mathml", 
                                "id": "equ1", 
                                "label": "(1)", 
                                "mathml": "<math><mi>\u0394</mi><msubsup><mi>J</mi><mi>i</mi><mi>t</mi></msubsup><mo>=</mo><msup><mi>\u03b5</mi><mi>t</mi></msup><mrow><mo>(</mo><msup><mi>\u03c8</mi><mi>t</mi></msup><msubsup><mi>r</mi><mi>i</mi><mi>t</mi></msubsup><mo>\u2212</mo><msup><mrow><mo>(</mo><msup><mi>\u03c8</mi><mi>t</mi></msup><mo>)</mo></mrow><mn>2</mn></msup><msubsup><mi>J</mi><mi>i</mi><mi>t</mi></msubsup><mo>)</mo></mrow><mo>,</mo></math>"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "where <math id=\"inf4\"><mrow><msup><mi>\u03b5</mi><mi>t</mi></msup></mrow></math> denotes the learning rate,\u00a0<math id=\"inf5\"><mrow><mo></mo><msubsup><mi>J</mi><mi>i</mi><mi>t</mi></msubsup></mrow></math> is the <math id=\"inf6\"><mrow><msup><mi>i</mi><mrow><mi>t</mi><mi>h</mi></mrow></msup></mrow></math> weight and <math id=\"inf7\"><mrow><msup><mi>\u03c8</mi><mi>t</mi></msup><mo>,</mo><msubsup><mi>r</mi><mi>i</mi><mi>t</mi></msubsup></mrow></math> are the output and the <math id=\"inf8\"><mrow><msup><mi>i</mi><mrow><mi>t</mi><mi>h</mi></mrow></msup></mrow></math> input of the network, respectively (all at time <math id=\"inf9\"><mi>t</mi></math>). The weights were initialized randomly according to a uniform distribution and then normalized to have norm 1. The output <math id=\"inf10\"><mrow><msup><mi>\u03c8</mi><mi>t</mi></msup></mrow></math> was calculated every iteration by summing up all pre-synaptic activity from the entire input neuron population. The activity of each output was processed through a sigmoidal function (e.g.,\u00a0<math id=\"inf11\"><mrow><mtext>tanh</mtext></mrow></math>) or a simple linear function. Formally,"
                            }, 
                            {
                                "type": "mathml", 
                                "id": "equ2", 
                                "label": "(2)", 
                                "mathml": "<math><msup><mi>\u03c8</mi><mi>t</mi></msup><mo>=</mo><mi>f</mi><mfenced><mrow><msubsup><mo>\u2211</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><msubsup><mi>J</mi><mi>i</mi><mi>t</mi></msubsup><mo>\u22c5</mo><msubsup><mi>r</mi><mi>i</mi><mi>t</mi></msubsup></mrow></mfenced><mo>,</mo></math>"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "where n is the number of input place cells. Since we were initially only concerned with the eigenvector associated with the largest eigenvalue, we did not implement a multiple-output architecture. In this formulation, in which no lateral weights were used, multiple outputs were equivalent to running the same setting with one output several times."
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "As discussed in the introduction, this kind of simple feedforward neural network with linear activation and a local weight update in the form of Oja\u2019s rule (1) is known to perform <i>Principal Components Analysis (PCA)</i> (<a href=\"#bib30\">Oja, 1982</a>; <a href=\"#bib31\">Sanger, 1989</a>; <a href=\"#bib42\">Weingessel and Hornik, 2000</a>). In the case of a single output the feedforward weights converge to the principal eigenvector of the input's covariance matrix. With several outputs, and lateral weights, as described in the section on modules, the weights converge to the leading principal eigenvectors of the covariance matrix, or, in certain cases (<a href=\"#bib42\">Weingessel and Hornik, 2000</a>), to the subspace spanned by the principal eigenvectors. We can thus compare the results of the neural network to those of the mathematical procedure of PCA. Hence, in our simulation, we (1) let the neural networks' weights develop in real time based on the current place cell inputs. In addition, we (2) saved the input activity for every time step to calculate the input covariance matrix and perform (batch) PCA directly."
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "It is worth mentioning that the PCA solution described in this section can be interpreted differently based on the Singular Value Decomposition (SVD). Denoting by <math id=\"inf12\"><mi>R</mi></math> the <math id=\"inf13\"><mrow><mi>T</mi><mo>\u00d7</mo><mi>d</mi></mrow></math> spatio-temporal pattern of place cell activities (after setting the mean to zero), where <math id=\"inf14\"><mi>T</mi></math> is the time duration and <math id=\"inf15\"><mi>d</mi></math> is the number of place cells, the SVD decomposition (see <a href=\"#bib19\">Jolliffe, 2002</a>; sec. 3.5) for <math id=\"inf16\"><mi>R</mi></math> is <math id=\"inf17\"><mi>R</mi><mo>=</mo><mtext>ULA'</mtext></math>. For a matrix <math id=\"inf18\"><mi>R</mi></math> of rank <math id=\"inf19\"><mi>r</mi></math>, <math id=\"inf20\"><mi>L</mi></math> is a <math id=\"inf21\"><mrow><mi>r</mi><mo>\u00d7</mo><mi>r</mi></mrow></math> diagonal matrix whose <math id=\"inf22\"><mi>k</mi></math>th element is equal to <math id=\"inf23\"><mrow><msub><mi>l</mi><mi>k</mi></msub><msup><mrow></mrow><mrow><mn>1</mn><mo>/</mo><mn>2</mn></mrow></msup></mrow></math>, the square root of the <math id=\"inf24\"><mi>k</mi></math>th eigenvalue of the covariance matrix <math id=\"inf25\"><mtext>RR'</mtext></math>\u00a0(computed in the PCA analysis), <math id=\"inf26\"><mi>A</mi></math> is the <math id=\"inf27\"><mrow><mi>d</mi><mo>\u00d7</mo><mi>r</mi></mrow></math> matrix with <math id=\"inf28\"><mi>k</mi></math>th column equal to the <math id=\"inf29\"><mi>k</mi></math>th eigenvector of <math id=\"inf30\"><mtext>RR'</mtext></math>, and <math id=\"inf31\"><mi>U</mi></math> is the <math id=\"inf32\"><mrow><mi>T</mi><mo>\u00d7</mo><mi>r</mi></mrow></math> matrix whose <math id=\"inf33\"><mi>k</mi></math>th column is <math id=\"inf34\"><mrow><msubsup><mi>l</mi><mi>k</mi><mrow><mo>\u2212</mo><mn>1</mn><mo>/</mo><mn>2</mn></mrow></msubsup><mi>R</mi><msub><mi>a</mi><mi>k</mi></msub></mrow></math>. Note that <math id=\"inf35\"><mi>U</mi></math> is a <math id=\"inf36\"><mrow><mi>T</mi><mo>\u00d7</mo><mi>r</mi></mrow></math> dimensional matrix whose <math id=\"inf37\"><mi>k</mi></math>th column represents the temporal dynamics of the <math id=\"inf38\"><mi>k</mi></math><sup>th</sup> grid cell. In other words, the SVD provides a decomposition of the place cell activity in terms of the grid cell activity, as opposed to the grid cell representation in terms of place cell activity we discussed so far. The network learns the spatial weights over place cells (the eigenvectors) as the connections weights from the place cells, and 'projection onto place cell space' (<math id=\"inf39\"><mrow><msubsup><mi>l</mi><mi>k</mi><mrow><mo>\u2212</mo><mn>1</mn><mo>/</mo><mn>2</mn></mrow></msubsup><mi>R</mi><msub><mi>a</mi><mi>k</mi></msub></mrow></math>) is simply the firing rates of the output neuron plotted against the location of the agent."
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "The question we therefore asked was under what conditions, when using <i>place cell-like</i> inputs, a solution resembling hexagonal <i>grid cells</i> emerges. To answer this we used both the neural-network implementation and the direct calculation of the PCA coefficients."
                            }
                        ]
                    }, 
                    {
                        "type": "section", 
                        "id": "s4-2", 
                        "title": "Simulation", 
                        "content": [
                            {
                                "type": "paragraph", 
                                "text": "We simulated an agent moving in a 2D virtual environment consisting of a square arena covered by <math id=\"inf40\"><mi>n</mi></math> uniformly distributed 2D Gaussian-shaped place cells, organized on a grid, given by"
                            }, 
                            {
                                "type": "mathml", 
                                "id": "equ3", 
                                "label": "(3)", 
                                "mathml": "<math><msubsup><mi>r</mi><mi>i</mi><mi>t</mi></msubsup><mrow><mo>(</mo><mi mathvariant=\"bold-italic\">X</mi><mrow><mo>(</mo><mi>t</mi><mo>)</mo></mrow><mo>)</mo></mrow><mo>=</mo><mi>exp</mi><mrow><mo>(</mo><mfrac><mrow><mo>\u2212</mo><msup><mrow><mo>(</mo><mi mathvariant=\"bold-italic\">X</mi><mrow><mo>(</mo><mi>t</mi><mo>)</mo></mrow><mo>\u2212</mo><msub><mi mathvariant=\"bold-italic\">C</mi><mi>i</mi></msub><mo>)</mo></mrow><mn>2</mn></msup></mrow><mrow><mn>2</mn><msup><msub><mi>\u03c3</mi><mi>i</mi></msub><mn>2</mn></msup></mrow></mfrac><mo>)</mo></mrow><mo>,</mo><mtext>\u2009</mtext><mtext>\u2009</mtext><mtext>\u2009</mtext><mtext>\u2009</mtext><mtext>\u2009</mtext><mtext>\u2009</mtext><mtext>\u2009</mtext><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>n</mi></math>"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "where <math id=\"inf41\"><mi mathvariant=\"bold-italic\">X</mi><mo>(</mo><mi>t</mi><mo>)</mo></math> represents the location of the agent. The variables <math id=\"inf42\"><msubsup><mi>r</mi><mi>i</mi><mi>t</mi></msubsup></math>\u00a0constitute the temporal input from place cell <math id=\"inf43\"><mi>i</mi></math>\u00a0at time\u00a0<math id=\"inf44\"><mrow><mo></mo><mi>t</mi></mrow></math>, and\u00a0<math id=\"inf45\"><mo mathvariant=\"bold\"></mo><msub><mi mathvariant=\"bold-italic\">C</mi><mi>i</mi></msub><mo>,</mo><mo></mo><msub><mi>\u03c3</mi><mi>i</mi></msub></math> are the <math id=\"inf46\"><msup><mi>i</mi><mrow><mi>t</mi><mi>h</mi></mrow></msup></math>\u00a0place cell\u2019s field center and width, respectively (see variations on this input structure below). In order to eliminate boundary effects, periodic boundary conditions were assumed. The virtual agent moved about in a random walk scheme (see Appendix) and explored the environment (<a href=\"#fig1\">Figure 1A</a>). The place cell centers were assumed to be uniformly distributed (<a href=\"#fig1\">Figure 1B</a>) and shared the same standard deviation\u00a0<math id=\"inf47\"><mrow><mo></mo><mi>\u03c3</mi></mrow></math>. The activity of all place cells as a function of time <math id=\"inf48\"><mrow><mo>(</mo><mi>r</mi><msub><mrow><mo>(</mo><mi>t</mi><mo>)</mo></mrow><mn>1</mn></msub><mo>,</mo><mi>r</mi><msub><mrow><mo>(</mo><mi>t</mi><mo>)</mo></mrow><mn>2</mn></msub><mo>\u2026</mo><mi>r</mi><msub><mrow><mrow><mo>(</mo><mi>t</mi><mo>)</mo></mrow></mrow><mi>n</mi></msub><mo>)</mo></mrow></math> was dependent on the stochastic movement of the agent, and formed a [<i>Neuron x Time</i>] matrix (<math id=\"inf49\"><mi>r</mi><mo>\u2208</mo><msup><mi>R</mi><mrow><mi>n</mi><mi>x</mi><mi>T</mi></mrow></msup></math>,\u00a0with\u00a0T- being the time dimension, see <a href=\"#fig1\">Figure 1C</a>)."
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "The simulation was run several times with different input arguments (see <a href=\"#tbl1\">Table 1</a>). The agent was simulated for <math id=\"inf50\"><mi>T</mi></math> time steps, allowing the neural network's weights to develop and reach a steady state by using the learning rule (<a href=\"#equ1\">Equations 1,2</a>) and the input (<a href=\"#equ3\">Equation 3</a>) data. The simulation parameters are listed below and include parameters related to the environment, simulation, agent and network variables."
                            }, 
                            {
                                "type": "table", 
                                "doi": "10.7554/eLife.10094.019", 
                                "id": "tbl1", 
                                "label": "Table 1.", 
                                "title": "List of variables used in simulation", 
                                "tables": [
                                    "<table><tbody><tr><td valign=\"top\"><b>Environment:</b></td><td valign=\"top\">Size of arena</td><td valign=\"top\">Place cells field width</td><td valign=\"top\">Place cells distribution</td></tr><tr><td valign=\"top\"><b>Agent:</b></td><td valign=\"top\">Velocity (angular &amp; linear)</td><td valign=\"top\">Initial position</td><td valign=\"top\">-------------------</td></tr><tr><td valign=\"top\"><b>Network:</b></td><td valign=\"top\"># Place cells/ #Grid cells</td><td valign=\"top\">Learning rate</td><td valign=\"top\">Adaptation variable (if used)</td></tr><tr><td valign=\"top\"><b>Simulation:</b></td><td valign=\"top\">Duration (time)</td><td valign=\"top\">Time step</td><td valign=\"top\">-------------------</td></tr></tbody></table>"
                                ]
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "To calculate the PCA directly, we used the MATLAB function <b><i>Princomp</i></b> in order to evaluate the <math id=\"inf51\"><mi>n</mi></math> principal eigenvectors <math id=\"inf52\"><mrow><msubsup><mrow><mo>{</mo><msub><mover accent=\"true\"><mi>q</mi><mo>\u2192</mo></mover><mi>k</mi></msub><mo>}</mo></mrow><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup></mrow></math> and corresponding eigenvalues of the input covariance matrix. As mentioned in the Results section, there exists a near fourfold redundancy in the eigenvectors (X-Y axis and in phase). <a href=\"#fig3\">Figure 3</a> demonstrates this redundancy by plotting the eigenvalues of the covariance matrix. The output response of each eigenvector <math id=\"inf53\"><mrow><msub><mover accent=\"true\"><mi>q</mi><mo>\u2192</mo></mover><mi>k</mi></msub></mrow></math> corresponding to a 2D input location <math id=\"inf54\"><mrow><mo>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>)</mo></mrow></math> is"
                            }, 
                            {
                                "type": "mathml", 
                                "id": "equ4", 
                                "label": "(4)", 
                                "mathml": "<math><mi>\u03a6</mi><msub><mrow><mo>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>)</mo></mrow><mi>k</mi></msub><mo>=</mo><munderover><mo>\u2211</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msubsup><mi>q</mi><mi>k</mi><mi>j</mi></msubsup><mo>\u00a0</mo><mi>exp</mi><mrow><mo>(</mo><mo>\u2212</mo><mfrac><msup><mrow><mo>(</mo><mi>x</mi><mo>\u2212</mo><msubsup><mi>c</mi><mi>x</mi><mi>j</mi></msubsup><mo>)</mo></mrow><mn>2</mn></msup><mrow><mn>2</mn><msubsup><mi>\u03c3</mi><mi>x</mi><mn>2</mn></msubsup></mrow></mfrac><mo>\u2212</mo><mfrac><msup><mrow><mo>(</mo><mi>y</mi><mo>\u2212</mo><msubsup><mi>c</mi><mi>y</mi><mi>j</mi></msubsup><mo>)</mo></mrow><mn>2</mn></msup><mrow><mn>2</mn><msubsup><mi>\u03c3</mi><mi>y</mi><mn>2</mn></msubsup></mrow></mfrac><mo>)</mo></mrow><mo>,</mo><mtext>\u2009</mtext><mtext>\u2009</mtext><mtext>\u2009</mtext><mtext>\u2009</mtext><mi>k</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>...</mn><mo>,</mo><mtext>\u2009</mtext><mi>n</mi></math>"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "where <math id=\"inf55\"><mrow><msubsup><mi>c</mi><mi>x</mi><mi>j</mi></msubsup></mrow></math>\u00a0and <math id=\"inf56\"><mrow><msubsup><mi>c</mi><mi>y</mi><mi>j</mi></msubsup></mrow></math>\u00a0are the <math id=\"inf57\"><mrow><mi>x</mi><mo>,</mo><mi>y</mi></mrow></math> components of the centers of the individual place cell fields. Unless otherwise mentioned, we used place cells in a rectangular grid, such that a place cell is centered at each pixel of the image (that is \u2013 number of place cells equals the number of image pixels)."
                            }
                        ]
                    }, 
                    {
                        "type": "section", 
                        "id": "s4-3", 
                        "title": "Non-negativity constraint", 
                        "content": [
                            {
                                "type": "paragraph", 
                                "text": "Projections between place cells and grid cells are known to be primarily excitatory (<a href=\"#bib45\">Witter and Amaral, 2004</a>), thus if we aim to mimic the biological circuit, a non-negativity constraint should be added to the feedforward weights in the neural network. While implementing a non-negativity constraint in the neural network is rather easy (a simple rectification rule in the weight dynamics, such that weights which are smaller than 0 are set to 0), the equivalent condition for calculating non-negative Principal Components is more intricate. Since this problem is non-convex and, in general, NP-hard (<a href=\"#bib26\">Montanari and Richard, 2014</a>), a numerical procedure was imperative. We used three different algorithms for this purpose."
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "The first (<a href=\"#bib46\">Zass and Shashua, 2006</a>) named NSPCA (Nonnegative Sparse PCA) is based on coordinate-descent. The algorithm computes a non-negative version of the covariance matrix's eigenvectors and relies on solving a numerical optimization problem, converging to a local maximum starting from a random initial point. The local nature of the algorithm did not guarantee a convergence to a global optimum (recall that the problem is non-convex). The algorithm's inputs consisted of the place cell activities\u2019 covariance matrix, <i>\u03b1</i> - a balancing parameter between reconstruction and orthonormality, <i>\u03b2</i>\u00a0\u2013 a variable which controls the amount of sparseness required, and an initial solution vector. For the sake of generality, we set the initial vector to be uniformly random (and normalized), <i>\u03b1</i>\u00a0was set to a relatively high value \u2013 10<sup>4</sup> and since no sparseness was needed, <i>\u03b2</i>\u00a0was set to zero."
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "The second algorithm (<a href=\"#bib26\">Montanari and Richard, 2014</a>) does not require any simulation parameters except an arbitrary initialization. It works directly on the inputs and uses a message passing algorithm to define an iterative algorithm to approximately solve the optimization problem. Under specific assumptions it can be shown that the algorithm asymptotically solves the problem (for large input dimensions)."
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "The third algorithm we use is the parameter free Fast Iterative Threshold and Shrinkage algorithm FISTA (<a href=\"#bib2\">Beck and Teboulle, 2009</a>). As described later in this section, this algorithm is the fastest of the three, and allowed us rapid screening of parameter space."
                            }
                        ]
                    }, 
                    {
                        "type": "section", 
                        "id": "s4-4", 
                        "title": "Different variants of input structure", 
                        "content": [
                            {
                                "type": "paragraph", 
                                "text": "Performing PCA on raw data requires the subtraction of the data mean. Some thought was required in order to determine how to perform this subtraction in the case of the neural network."
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "One way to perform the subtraction in the time domain was to dynamically subtract the mean during simulation by using the discrete 1<sup>st</sup> or 2<sup>nd</sup> derivatives of the inputs in time [i.e. from <a href=\"#equ3\">Equation 3</a>,\u00a0<math id=\"inf58\"><mo>\u2206</mo><mi>r</mi><mrow><mo>(</mo><mi>t</mi><mo>+</mo><mn>1</mn><mo>)</mo></mrow><mo>=</mo><mi>r</mi><mrow><mo>(</mo><mi>t</mi><mo>+</mo><mn>1</mn><mo>)</mo></mrow><mo>\u2212</mo><mi>r</mi><mfenced><mi>t</mi></mfenced></math>]. Under conditions of an isotropic random walk (namely, given any starting position, motion in all directions is equally likely) it is clear that\u00a0<math id=\"inf59\"><mi>E</mi><mrow><mo>[</mo><mrow><mo>\u2206</mo><mi>r</mi><mo>(</mo><mi>t</mi><mo>)</mo></mrow><mo>]</mo></mrow><mo>=</mo><mn>0</mn></math>. Another option for subtracting the mean in the time domain was the use of an adaptation variable, as was initially introduced by <a href=\"#bib21\">Kropff and Treves, (2008)</a>. Although originally exploited for control over the firing rate, it can be viewed as a variable that represents subtraction of a weighted sum of the firing rate history. Instead of using the inputs <math id=\"inf60\"><msubsup><mi>r</mi><mi>i</mi><mi>t</mi></msubsup></math>\u00a0directly in <a href=\"#equ2\">Equation 2</a> to compute the activation\u00a0<math id=\"inf61\"><msup><mi>\u03c8</mi><mi>t</mi></msup></math>, an intermediate adaptation variable <math id=\"inf62\"><mrow><msubsup><mi>\u03c8</mi><mrow><mi>a</mi><mi>d</mi><mi>p</mi></mrow><mi>t</mi></msubsup><mo>(</mo><mi>\u03b4</mi><mo>)</mo></mrow></math> was used (<math id=\"inf63\"><mi>\u03b4</mi></math> being the relative significance of the present temporal sample) as"
                            }, 
                            {
                                "type": "mathml", 
                                "id": "equ5", 
                                "label": "(5)", 
                                "mathml": "<math><msubsup><mi>\u03c8</mi><mrow><mi>a</mi><mi>d</mi><mi>p</mi></mrow><mi>t</mi></msubsup><mo>=</mo><msup><mi>\u03c8</mi><mi>t</mi></msup><mo>\u2212</mo><msup><mover><mi>\u03c8</mi><mo>\u00af</mo></mover><mi>t</mi></msup><mo>,</mo></math>"
                            }, 
                            {
                                "type": "mathml", 
                                "id": "equ6", 
                                "label": "(6)", 
                                "mathml": "<math><msup><mover><mi>\u03c8</mi><mo>\u00af</mo></mover><mi>t</mi></msup><mo>=</mo><mrow><mo>(</mo><mn>1</mn><mo>\u2212</mo><mi>\u03b4</mi><mo>)</mo></mrow><mo>\u22c5</mo><msup><mover><mi>\u03c8</mi><mo>\u00af</mo></mover><mrow><mi>t</mi><mo>\u2212</mo><mn>1</mn></mrow></msup><mo>+</mo><mi>\u03b4</mi><msup><mi>\u03c8</mi><mi>t</mi></msup><mo>.</mo></math>"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "It is not hard to see that for <i>i.i.d.</i> variables\u00a0<math id=\"inf64\"><mrow><mo></mo><msubsup><mi>\u03c8</mi><mrow><mi>a</mi><mi>d</mi><mi>p</mi></mrow><mi>t</mi></msubsup></mrow></math>, the sequence <math id=\"inf65\"><msup><mover><mi>\u03c8</mi><mo>\u00af</mo></mover><mi>t</mi></msup></math> converges for large <math id=\"inf66\"><mi>t</mi></math> to the mean of\u00a0<math id=\"inf67\"><msup><mi>\u03c8</mi><mi>t</mi></msup></math>. Thus, when <math id=\"inf68\"><mrow><mtext>t</mtext><mo>\u2192</mo><mi>\u221e</mi></mrow></math> we find that\u00a0<math id=\"inf69\"><mi>E</mi><mrow><mo>[</mo><msubsup><mi>\u03c8</mi><mrow><mi>a</mi><mi>d</mi><mi>p</mi></mrow><mi>t</mi></msubsup><mo>]</mo></mrow><mo>\u2192</mo><mn>0</mn></math>, specifically, the adaptation variable is of zero asymptotic mean."
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "The second method we used to enforce a zero mean input was simply to create it in advance. Rather than using 2D Gaussian functions (i.e. [<a href=\"#equ3\">Equation 3</a>]) as inputs we used 2D difference-of-Gaussians (all <math id=\"inf70\"><mi>\u03c3</mi></math> are equal in x and y axis):"
                            }, 
                            {
                                "type": "mathml", 
                                "id": "equ7", 
                                "label": "(7)", 
                                "mathml": "<math><msubsup><mi>r</mi><mi>i</mi><mi>t</mi></msubsup><mrow><mo>(</mo><mi mathvariant=\"bold-italic\">X</mi><mrow><mo>(</mo><mi>t</mi><mo>)</mo></mrow><mo>)</mo></mrow><mo>=</mo><msub><mi>c</mi><mrow><mn>1</mn><mo>,</mo><mi>i</mi></mrow></msub><mo>\u00a0</mo><mi>exp</mi><mrow><mo>(</mo><mo>\u2212</mo><mfrac><msup><mrow><mo>(</mo><mi mathvariant=\"bold-italic\">X</mi><mrow><mo>(</mo><mi>t</mi><mo>)</mo></mrow><mo>\u2212</mo><msub><mi mathvariant=\"bold-italic\">C</mi><mi>i</mi></msub><mo>)</mo></mrow><mn>2</mn></msup><mrow><mn>2</mn><msup><msub><mi>\u03c3</mi><mrow><mn>1</mn><mo>,</mo><mi>i</mi></mrow></msub><mn>2</mn></msup></mrow></mfrac><mo>)</mo></mrow><mo>\u2212</mo><msub><mi>c</mi><mrow><mn>2</mn><mo>,</mo><mi>i</mi></mrow></msub><mo>\u00a0</mo><mi>exp</mi><mrow><mo>(</mo><mo>\u2212</mo><mfrac><msup><mrow><mo>(</mo><mi mathvariant=\"bold-italic\">X</mi><mrow><mo>(</mo><mi>t</mi><mo>)</mo></mrow><mo>\u2212</mo><msub><mi mathvariant=\"bold-italic\">C</mi><mi>i</mi></msub><mo>)</mo></mrow><mn>2</mn></msup><mrow><mn>2</mn><msup><msub><mi>\u03c3</mi><mrow><mn>2</mn><mo>,</mo><mi>i</mi></mrow></msub><mn>2</mn></msup></mrow></mfrac><mo>)</mo></mrow><mo>,</mo><mtext>\u2009</mtext><mtext>\u2009</mtext><mtext>\u2009</mtext><mtext>\u2009</mtext><mtext>\u2009</mtext><mtext>\u2009</mtext><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>n</mi></math>"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "where the constants <math id=\"inf71\"><mrow><msub><mi>c</mi><mn>1</mn></msub></mrow></math> and <math id=\"inf72\"><mrow><msub><mi>c</mi><mn>2</mn></msub></mrow></math> are set so the integral of the given Laplacian function is zero (if the environment size is not too small, then <math id=\"inf73\"><msub><mi>c</mi><mrow><mn>1</mn><mo>,</mo><mi>i</mi></mrow></msub><mo>/</mo><msub><mi>c</mi><mrow><mn>2</mn><mo>,</mo><mi>i</mi></mrow></msub><mo>\u00a0</mo><mo>\u2248</mo><mo>\u00a0</mo><msub><mi>\u03c3</mi><mrow><mn>2</mn><mo>,</mo><mi>i</mi></mrow></msub><mo>/</mo><msub><mi>\u03c3</mi><mrow><mn>1</mn><mo>,</mo><mi>i</mi></mrow></msub></math>). Therefore, if we assume a random walk that covers the entire environment uniformly, the temporal mean of the input would be zero as well. Such input data can be inspired by similar behavior of neurons in the retina and the lateral-geniculate nucleus (<a href=\"#bib43\">Wiesel and Hubel, 1963</a>; <a href=\"#bib12\">Enroth-Cugell and Robson, 1966</a>). Finally, we implemented another input data type; positive-negative disks (see Appendix). Analogously to the difference-of-Gaussians function, the integral over input is zero so the same goal (zero-mean) was achieved. It is worthwhile noting that subtracting a constant from a simple Gaussian function is not sufficient since at infinity it does not reach zero."
                            }
                        ]
                    }, 
                    {
                        "type": "section", 
                        "id": "s4-5", 
                        "title": "Quality of solution and Gridness", 
                        "content": [
                            {
                                "type": "paragraph", 
                                "text": "In order to test the hexagonality of the results we used a hexagonal <i>Gridness score</i> (<a href=\"#bib32\">Sargolini et al., 2006</a>). The Gridness score of the spatial fields was calculated from a cropped ring of their autocorrelogram including the six maxima closest to the center. The ring was rotated six times, <math id=\"inf74\"><mrow><msup><mrow><mn>30</mn></mrow><mo>\u2218</mo></msup></mrow></math>\u00a0per rotation, reaching in total angles of\u00a0<math id=\"inf75\"><mrow><mo></mo><msup><mrow><mn>30</mn></mrow><mo>\u2218</mo></msup><mo>,</mo><msup><mrow><mn>60</mn></mrow><mo>\u2218</mo></msup><mo>,</mo><mo></mo><msup><mrow><mn>90</mn></mrow><mo>\u2218</mo></msup><mo>,</mo><msup><mrow><mn>120</mn></mrow><mo>\u2218</mo></msup><mo>,</mo><msup><mrow><mn>150</mn></mrow><mo>\u2218</mo></msup></mrow></math>. Furthermore, for every rotated angle the Pearson correlation with the original un-rotated map was obtained. Denoting by <math id=\"inf76\"><mrow><msub><mi>C</mi><mi>\u03b3</mi></msub></mrow></math> the correlation for a specific rotation angle\u00a0<math id=\"inf77\"><mrow><mo></mo><mi>\u03b3</mi></mrow></math>, the final Gridness score was (<a href=\"#bib21\">Kropff and Treves, 2008</a>):"
                            }, 
                            {
                                "type": "mathml", 
                                "id": "equ8", 
                                "label": "(8)", 
                                "mathml": "<math><mi>G</mi><mi>r</mi><mi>i</mi><mi>d</mi><mi>n</mi><mi>e</mi><mi>s</mi><mi>s</mi><mtext>\u2009</mtext><mtext>\u2009</mtext><mo>=</mo><mtext>\u2009</mtext><mfrac><mn>1</mn><mn>2</mn></mfrac><mrow><mo>(</mo><msub><mi>C</mi><mn>60</mn></msub><mo>+</mo><msub><mi>C</mi><mn>120</mn></msub><mo>)</mo></mrow><mo>\u2212</mo><mfrac><mn>1</mn><mn>3</mn></mfrac><mrow><mo>(</mo><msub><mi>C</mi><mn>30</mn></msub><mo>+</mo><msub><mi>C</mi><mn>90</mn></msub><mo>+</mo><msub><mi>C</mi><mn>150</mn></msub><mo>)</mo></mrow><mo>.</mo></math>"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "In addition to this 'traditional' score we used a <i>Squareness</i> Gridness score in order to examine how square-like the results are spatially. The special reference to the square shape was driven by the tendency of the spatial solution to converge to a rectangular shape when no constrains were applied. The Squareness Gridness score is similar to the hexagonal one, but now the cropped ring of the autocorrelogram is rotated <math id=\"inf78\"><mrow><mo></mo><msup><mrow><mn>45</mn></mrow><mo>\u2218</mo></msup></mrow></math> every iteration to reach angles of\u00a0<math id=\"inf79\"><mrow><mo></mo><msup><mrow><mn>45</mn></mrow><mo>\u2218</mo></msup><mo>,</mo><mtext></mtext><msup><mrow><mn>90</mn></mrow><mo>\u2218</mo></msup><mo>,</mo><mtext></mtext><msup><mrow><mn>135</mn></mrow><mo>\u2218</mo></msup></mrow></math>. As before, denoting <math id=\"inf80\"><mrow><msub><mi>C</mi><mi>\u03b3</mi></msub></mrow></math> as the correlation for a specific rotation angle\u00a0<math id=\"inf81\"><mrow><mo></mo><mi>\u03b3</mi></mrow></math> the new Gridness score was calculated as:"
                            }, 
                            {
                                "type": "mathml", 
                                "id": "equ9", 
                                "label": "(9)", 
                                "mathml": "<math><mi>S</mi><mi>q</mi><mi>u</mi><mi>a</mi><mi>r</mi><mi>e</mi><mo>\u00a0</mo><mi>G</mi><mi>r</mi><mi>i</mi><mi>d</mi><mi>n</mi><mi>e</mi><mi>s</mi><mi>s</mi><mo>=</mo><msub><mi>C</mi><mn>90</mn></msub><mo>\u2212</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mrow><mo>(</mo><msub><mi>C</mi><mn>45</mn></msub><mo>+</mo><msub><mi>C</mi><mn>135</mn></msub><mo>)</mo></mrow><mo>.</mo></math>"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "All errors calculated in gridness measures are SEM (Standard Error of the Mean)."
                            }
                        ]
                    }, 
                    {
                        "type": "section", 
                        "id": "s4-6", 
                        "title": "Hierarchical networks and modules", 
                        "content": [
                            {
                                "type": "paragraph", 
                                "text": "As described in the Results section, we were interested to check whether a hierarchy of outputs could explain the module phenomenon described for real grid cells. We replaced the single-output network with a hierarchical, multiple outputs network, which is capable of computing all 'principal components' of the input data while maintaining the non-negativity constraint as before. The network, introduced by <a href=\"#bib31\">Sanger, 1989</a>, computes each output as a linear summation of the weighted inputs similar to <a href=\"#equ2\">Equation 2</a>. However, the weights are now calculated according to:"
                            }, 
                            {
                                "type": "mathml", 
                                "id": "equ10", 
                                "label": "(10)", 
                                "mathml": "<math><mi>\u0394</mi><msubsup><mi>J</mi><mrow><mi>i</mi><mi>j</mi></mrow><mi>t</mi></msubsup><mo>=</mo><msup><mi>\u03b5</mi><mi>t</mi></msup><mrow><mo>(</mo><msubsup><mi>r</mi><mi>j</mi><mi>t</mi></msubsup><msubsup><mi>\u03c8</mi><mi>i</mi><mi>t</mi></msubsup><mo>\u2212</mo><msubsup><mi>\u03c8</mi><mi>i</mi><mi>t</mi></msubsup><munderover><mo>\u2211</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>i</mi></munderover><msubsup><mi>J</mi><mrow><mi>k</mi><mi>j</mi></mrow><mi>t</mi></msubsup><msubsup><mi>\u03c8</mi><mi>k</mi><mi>t</mi></msubsup><mo>)</mo></mrow><mo>.</mo></math>"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "The first term in the parenthesis when <math id=\"inf82\"><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow></math> was the regular Hebb-Oja derived rule. In other words, the first output calculated the first non-negative 'principal component' (in inverted commas due to the non-negativity) of the data. Following the first one, the weights of each output received a back projection from the previous outputs. This learning rule applied to the data in a similar manner to the Gram-Schmidt process, subtracting the 'influence' of the previous 'principal components' on the data and recalculating the appropriate 'principal components' of the updated input data."
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "In a comparable manner, we applied this technique to the input data <math id=\"inf83\"><mi mathvariant=\"bold-italic\">X</mi></math> in order to obtain non-negative 'eigenvectors' from the direct nonnegative-PCA algorithms. We found <math id=\"inf84\"><msub><mi mathvariant=\"bold-italic\">V</mi><mn>2</mn></msub></math> by subtracting from the data the projection of <math id=\"inf85\"><msub><mi mathvariant=\"bold-italic\">V</mi><mn>1</mn></msub></math> on it,"
                            }, 
                            {
                                "type": "mathml", 
                                "id": "equ11", 
                                "label": "(11)", 
                                "mathml": "<math><mover accent=\"true\"><mi mathvariant=\"bold-italic\">X</mi><mo>~</mo></mover><mo>=</mo><mi mathvariant=\"bold-italic\">X</mi><mo>\u2212</mo><msubsup><mi mathvariant=\"bold-italic\">V</mi><mn>1</mn><mi>T</mi></msubsup><mrow><mo>(</mo><msub><mi mathvariant=\"bold-italic\">V</mi><mn>1</mn></msub><mo>\u22c5</mo><mi mathvariant=\"bold-italic\">X</mi><mo>)</mo></mrow><mo>.</mo></math>"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "Next, we computed\u00a0<math id=\"inf86\"><mo mathvariant=\"bold\"></mo><msub><mi mathvariant=\"bold-italic\">V</mi><mn>2</mn></msub></math>, the first non-negative 'principal component' of\u00a0<math id=\"inf87\"><mover accent=\"true\"><mi mathvariant=\"bold-italic\">X</mi><mo>~</mo></mover></math>, and similarly the subsequent ones."
                            }
                        ]
                    }, 
                    {
                        "type": "section", 
                        "id": "s4-7", 
                        "title": "Stability of hexagonal solutions", 
                        "content": [
                            {
                                "type": "paragraph", 
                                "text": "In order to test the stability of the solutions we obtained under all types of conditions, we applied the ODE method (<a href=\"#bib22\">Kushner and Clark, 1978</a>; <a href=\"#bib18\">Hornik and Kuan, 1992</a>; <a href=\"#bib42\">Weingessel and Hornik, 2000</a>) to the PCA feature extraction algorithm introduced in pervious sections. This method allows one to asymptotically replace the stochastic update equations describing the neural dynamics by smooth differential equations describing the average asymptotic behavior. Under appropriate conditions, the stochastic dynamics converge with probability one to the solution of the ODEs. Although originally this approach was designed for a more general architecture (including lateral connections and asymmetric updating rules), we used a restricted version for our system. In addition, the following analysis is accurate solely for linear output functions. However, since our architecture works well with either linear or non-linear output functions, the conclusions are valid."
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "We can rewrite the relevant updating equations of the linear neural network (in matrix form), (see [<a href=\"#bib42\">Weingessel and Hornik, 2000</a>] <a href=\"#equ16\">Equations 15\u201319</a>):"
                            }, 
                            {
                                "type": "mathml", 
                                "id": "equ12", 
                                "label": "(12)", 
                                "mathml": "<math><msup><mi>\u03c8</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msup><mo>=</mo><mi>Q</mi><mo>\u22c5</mo><msup><mi>J</mi><mi>t</mi></msup><mo>\u22c5</mo><msup><mrow><mo>(</mo><msup><mi>r</mi><mi>t</mi></msup><mo>)</mo></mrow><mi>T</mi></msup><mo>,</mo></math>"
                            }, 
                            {
                                "type": "mathml", 
                                "id": "equ13", 
                                "label": "(13)", 
                                "mathml": "<math><mi>\u0394</mi><msup><mi>J</mi><mi>t</mi></msup><mo>=</mo><msup><mi>\u03b5</mi><mi>t</mi></msup><mrow><mo>(</mo><msup><mi>\u03c8</mi><mi>t</mi></msup><msup><mrow><mo>(</mo><msup><mi>r</mi><mi>t</mi></msup><mo>)</mo></mrow><mi>T</mi></msup><mo>\u2212</mo><mi>\u03a6</mi><mrow><mo>(</mo><msup><mi>\u03c8</mi><mi>t</mi></msup><mo>\u22c5</mo><msup><mrow><mo>(</mo><msup><mi>\u03c8</mi><mi>t</mi></msup><mo>)</mo></mrow><mi>T</mi></msup><mo>)</mo></mrow><msup><mi>J</mi><mi>t</mi></msup><mo>)</mo></mrow><mo>.</mo></math>"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "In our case we set"
                            }, 
                            {
                                "type": "mathml", 
                                "id": "equ14", 
                                "mathml": "<math><mi>Q</mi><mo>=</mo><mi>I</mi><mo>,</mo><mtext>\u2009</mtext><mtext>\u2009</mtext><mtext>\u2009</mtext><mi>\u03a6</mi><mo>=</mo><mi>d</mi><mi>i</mi><mi>a</mi><mi>g</mi><mo>.</mo></math>"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "Consider the following assumptions"
                            }, 
                            {
                                "type": "list", 
                                "prefix": "number", 
                                "items": [
                                    [
                                        {
                                            "type": "paragraph", 
                                            "text": "The input sequence <math id=\"inf88\"><mrow><msup><mi>r</mi><mi>t</mi></msup></mrow></math> consists of independent identically distributed, bounded random variables with zero-mean."
                                        }
                                    ], 
                                    [
                                        {
                                            "type": "paragraph", 
                                            "text": "<math id=\"inf89\"><mrow><mrow><mo>{</mo><mrow><msup><mi>\u03b5</mi><mi>t</mi></msup></mrow><mo>}</mo></mrow></mrow></math> is a positive number sequence satisfying: <math id=\"inf90\"><mstyle displaystyle=\"false\"><munder><mo>\u2211</mo><mi>t</mi></munder></mstyle><mo>\u00a0</mo><msup><mi>\u03b5</mi><mi>t</mi></msup><mo>=</mo><mi>\u221e</mi><mo>,</mo><mo></mo><mo></mo><mo></mo><msup><mrow><mstyle displaystyle=\"false\"><munder><mo>\u2211</mo><mi>t</mi></munder></mstyle><mo>\u00a0</mo><mo>(</mo><msup><mi>\u03b5</mi><mi>t</mi></msup><mo>)</mo></mrow><mn>2</mn></msup><mo>&lt;</mo><mi>\u221e</mi></math>."
                                        }
                                    ]
                                ]
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "A typical suitable sequence is\u00a0<math id=\"inf91\"><mrow><mo></mo><msup><mi>\u03b5</mi><mi>t</mi></msup><mo>=</mo><mfrac><mn>1</mn><mi>t</mi></mfrac><mo>,</mo><mo></mo><mi>t</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>\u2026</mo></mrow></math>."
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "For long times, we denote"
                            }, 
                            {
                                "type": "mathml", 
                                "id": "equ15", 
                                "label": "(14)", 
                                "mathml": "<math><mi>E</mi><mrow><mo>[</mo><msup><mi>\u03c8</mi><mi>t</mi></msup><msup><mrow><mo>(</mo><msup><mi>r</mi><mi>t</mi></msup><mo>)</mo></mrow><mi>T</mi></msup><mo>]</mo></mrow><mo>\u2192</mo><mi>E</mi><mrow><mo>[</mo><mi>J</mi><mo>\u22c5</mo><mi>r</mi><mo>\u22c5</mo><msup><mi>r</mi><mi>T</mi></msup><mo>]</mo></mrow><mo>=</mo><mi>E</mi><mrow><mo>[</mo><mi>J</mi><mo>]</mo></mrow><mo>\u22c5</mo><mi>E</mi><mrow><mo>[</mo><mi>r</mi><mo>\u22c5</mo><msup><mi>r</mi><mi>T</mi></msup><mo>]</mo></mrow><mo>=</mo><mi>J</mi><mi>\u03a3</mi><mo>,</mo></math>"
                            }, 
                            {
                                "type": "mathml", 
                                "id": "equ16", 
                                "label": "(15)", 
                                "mathml": "<math><munder><mi>lim</mi><mrow><mi>t</mi><mo>\u2192</mo><mi>\u221e</mi></mrow></munder><mi>E</mi><mrow><mo>[</mo><mi>\u03c8</mi><msup><mi>\u03c8</mi><mi>T</mi></msup><mo>]</mo></mrow><mo>=</mo><mi>E</mi><mrow><mo>[</mo><mi>J</mi><mo>]</mo></mrow><mo>\u22c5</mo><mi>E</mi><mrow><mo>[</mo><mi>r</mi><msup><mi>r</mi><mi>T</mi></msup><mo>]</mo></mrow><mo>\u22c5</mo><mi>E</mi><mrow><mo>[</mo><msup><mi>J</mi><mi>T</mi></msup><mo>]</mo></mrow><mo>=</mo><mi>J</mi><mi>\u03a3</mi><msup><mi>J</mi><mi>T</mi></msup><mo>.</mo></math>"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "The penultimate equalities in these equations used the fact that the weights converge with probability one to their average value, resulting from the solution of the ODEs. Following <a href=\"#bib42\">Weingessel and Hornik, (2000)</a>, we can analyze <a href=\"#equ12\">Equations 12,13</a> under the above assumptions, via their asymptotically equivalent associated ODEs"
                            }, 
                            {
                                "type": "mathml", 
                                "id": "equ17", 
                                "label": "(16)", 
                                "mathml": "<math><mfrac><mrow><mi>d</mi><mi>J</mi></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mi>J</mi><mi>\u03a3</mi><mo>\u2212</mo><mi>d</mi><mi>i</mi><mi>a</mi><mi>g</mi><mrow><mo>(</mo><mi>J</mi><mi>\u03a3</mi><msup><mi>J</mi><mi>T</mi></msup><mo>)</mo></mrow><mo>\u00a0</mo><mi>J</mi><mo>,</mo></math>"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "with equilibria at"
                            }, 
                            {
                                "type": "mathml", 
                                "id": "equ18", 
                                "label": "(17)", 
                                "mathml": "<math><mi>J</mi><mi>\u03a3</mi><mo>=</mo><mi>d</mi><mi>i</mi><mi>a</mi><mi>g</mi><mrow><mo>(</mo><mi>J</mi><mi>\u03a3</mi><msup><mi>J</mi><mi>T</mi></msup><mo>)</mo></mrow><mo>\u00a0</mo><mi>J</mi><mo>.</mo></math>"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "We solved it numerically by exploiting the same covariance matrix and initializing with random weights\u00a0<math id=\"inf92\"><mrow><mo></mo><mi>J</mi></mrow></math>. In line with our previous findings, we found that constraining <math id=\"inf93\"><mi>J</mi></math> to be non-negative (by a simple cut-off rule) resulted in a hexagonal shape (in the projection of <math id=\"inf94\"><mi>J</mi></math> onto the place cells space; <a href=\"#fig11\">Figure 11</a>). In contrast, when the weights were not constrained they converged to square-like results."
                            }
                        ]
                    }, 
                    {
                        "type": "section", 
                        "id": "s4-8", 
                        "title": "Steady state analysis", 
                        "content": [
                            {
                                "type": "paragraph", 
                                "text": "From this point onwards, we focus on the case of a single output, in which <math id=\"inf95\"><mi>J</mi></math> is a row vector, unless stated otherwise. In the unconstrained case, from <a href=\"#equ18\">Equation 17</a> any <math id=\"inf96\"><mi>J</mi></math> which is a normalized eigenvector of <math id=\"inf97\"><mi>\u03a3</mi></math> would be a fixed point. However, from <a href=\"#equ17\">Equation 16</a>, only the principal eigenvector, which is the solution to the following optimization problem"
                            }, 
                            {
                                "type": "mathml", 
                                "id": "equ19", 
                                "label": "(18)", 
                                "mathml": "<math><msub><mi>max</mi><mrow><mi>J</mi><mo>:</mo><msup><mi>J</mi><mi>T</mi></msup><mi>J</mi><mo>=</mo><mn>1</mn></mrow></msub><mo>\u00a0</mo><mi>J</mi><mi>\u03a3</mi><msup><mi>J</mi><mi>T</mi></msup></math>"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "would correspond to a stable fixed point. This is the standard PCA problem. By adding the constraint <math id=\"inf98\"><mrow><mi>J</mi><mo>\u2265</mo><mn>0</mn></mrow></math> we get the non-negative PCA problem."
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "To speed up simulation and simplify analysis we make further simplifications."
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "First, we assume that the agent\u2019s random movement is ergodic (e.g., an isotropic random walk in a finite box as we used in our simulation), uniform and covering the entire environment, so that"
                            }, 
                            {
                                "type": "mathml", 
                                "id": "equ20", 
                                "label": "(19)", 
                                "mathml": "<math><mi>J</mi><mi>\u03a3</mi><msup><mi>J</mi><mi>T</mi></msup><mo>=</mo><mi>E</mi><mfenced close=\"]\" open=\"[\"><mrow><msup><mi>\u03c8</mi><mn>2</mn></msup><mrow><mo>(</mo><mi mathvariant=\"bold-italic\">X</mi><mrow><mo>(</mo><mi>t</mi><mo>)</mo></mrow><mo>)</mo></mrow></mrow></mfenced><mo>=</mo><mfrac><mn>1</mn><mrow><mo>|</mo><mi>S</mi><mo>|</mo></mrow></mfrac><munder><mo>\u222b</mo><mi>S</mi></munder><msup><mi>\u03c8</mi><mn>2</mn></msup><mrow><mo>(</mo><mtext mathvariant=\"bold\">x</mtext><mo>)</mo></mrow><mi>d</mi><mtext mathvariant=\"bold\">x</mtext><mo>,</mo></math>"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "where <math id=\"inf99\"><mstyle mathvariant=\"bold\"><mi>x</mi></mstyle></math> denotes location vector (in contrast to <math id=\"inf100\"><mrow><mi>X</mi><mrow><mo>(</mo><mi>t</mi><mo>)</mo></mrow></mrow></math>, which is the random process corresponding to the location of the agent), <math id=\"inf101\"><mi>S</mi></math> is the entire environment, and <math id=\"inf102\"><mrow><mrow><mo>|</mo><mi>S</mi><mo>|</mo></mrow></mrow></math> is the size of the environment."
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "Second, we assume that the environment <math id=\"inf103\"><mi>S</mi></math> is uniformly and densely covered by identical place cells, each of which has the same a tuning curve <math id=\"inf104\"><mi>r</mi><mrow><mo>(</mo><mi mathvariant=\"bold\">x</mi><mo>)</mo></mrow></math> (which integrates to zero). In this case, the activity of the linear grid cell becomes a convolution operation"
                            }, 
                            {
                                "type": "mathml", 
                                "id": "equ21", 
                                "label": "(20)", 
                                "mathml": "<math><mi>\u03c8</mi><mrow><mo>(</mo><mtext mathvariant=\"bold\">x</mtext><mo>)</mo></mrow><mo>=</mo><msub><mo>\u222b</mo><mi>S</mi></msub><mi>J</mi><mrow><mo>(</mo><mtext mathvariant=\"bold\">x</mtext><mo mathvariant=\"bold\">'</mo><mo>)</mo></mrow><mi>r</mi><mrow><mo>(</mo><mtext mathvariant=\"bold\">x</mtext><mo mathvariant=\"bold\">\u2212</mo><mtext mathvariant=\"bold\">x</mtext><mo mathvariant=\"bold\">'</mo><mo>)</mo></mrow><mi>d</mi><mtext mathvariant=\"bold\">x</mtext><mo mathvariant=\"bold\">'</mo><mo mathvariant=\"bold\">,</mo></math>"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "where <math id=\"inf105\"><mi>J</mi><mrow><mo>(</mo><mtext mathvariant=\"bold\">x</mtext><mo>)</mo></mrow></math> is the synaptic weight connecting to the place cell at location <math id=\"inf106\"><mstyle mathvariant=\"bold\"><mtext>x</mtext></mstyle></math>."
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "Thus, we can write our objective as"
                            }, 
                            {
                                "type": "mathml", 
                                "id": "equ22", 
                                "label": "(21)", 
                                "mathml": "<math><mfrac><mn>1</mn><mrow><mo>|</mo><mi>S</mi><mo>|</mo></mrow></mfrac><msub><mo>\u222b</mo><mi>S</mi></msub><msup><mi>\u03c8</mi><mn>2</mn></msup><mrow><mo>(</mo><mtext mathvariant=\"bold\">x</mtext><mo>)</mo></mrow><mi>d</mi><mtext mathvariant=\"bold\">x</mtext><mo>=</mo><mfrac><mn>1</mn><mrow><mo>|</mo><mi>S</mi><mo>|</mo></mrow></mfrac><msub><mo>\u222b</mo><mi>S</mi></msub><msup><mrow><mo>(</mo><msub><mo>\u222b</mo><mi>S</mi></msub><mi>J</mi><mrow><mo>(</mo><mtext mathvariant=\"bold\">x</mtext><mo mathvariant=\"bold\">'</mo><mo>)</mo></mrow><mi>r</mi><mrow><mo>(</mo><mtext mathvariant=\"bold\">x</mtext><mo mathvariant=\"bold\">\u2212</mo><mtext mathvariant=\"bold\">x</mtext><mo mathvariant=\"bold\">'</mo><mo>)</mo></mrow><mi>d</mi><mtext mathvariant=\"bold\">x</mtext><mo mathvariant=\"bold\">'</mo><mo>)</mo></mrow><mn>2</mn></msup><mi>d</mi><mtext mathvariant=\"bold\">x</mtext></math>"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "under the constraint that the weights are normalized"
                            }, 
                            {
                                "type": "mathml", 
                                "id": "equ23", 
                                "label": "(22)", 
                                "mathml": "<math><mfrac><mn>1</mn><mfenced close=\"|\" open=\"|\"><mi>S</mi></mfenced></mfrac><msub><mo>\u222b</mo><mi>S</mi></msub><msup><mi>J</mi><mn>2</mn></msup><mo>\u00a0</mo><mo>(</mo><mtext mathvariant=\"bold\">x</mtext><mo>)</mo><mo>\u00a0</mo><mi>d</mi><mtext mathvariant=\"bold\">x</mtext><mo>=</mo><mn>1</mn><mo>,</mo></math>"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "where either <math id=\"inf107\"><mi>J</mi><mo>(</mo><mtext mathvariant=\"bold\">x</mtext><mo>)</mo><mo>\u2208</mo><mi mathvariant=\"normal\">\u211d</mi></math> (PCA) or <math id=\"inf108\"><mi>J</mi><mo>(</mo><mtext mathvariant=\"bold\">x</mtext><mo>)</mo><mo>\u00a0</mo><mo>\u2265</mo><mo>\u00a0</mo><mn>0</mn></math> ('non-negative PCA')."
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "Since we expressed the objective using a convolution operation (different boundary conditions can be assumed), it can be solved numerically considerably faster. In the non-negative case, we used the parameter free Fast Iterative Threshold and Shrinkage algorithm [FISTA (<a href=\"#bib2\">Beck and Teboulle, 2009</a>); in which we do not use shrinkage, since we only have hard constraints], where the gradient was calculated efficiently using convolutions."
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "Moreover, as we show in the following sections, if we assume periodic boundary conditions and use Fourier analysis, we can analytically find the PCA solutions, and obtain important insight on the non-negative PCA solutions."
                            }
                        ]
                    }, 
                    {
                        "type": "section", 
                        "id": "s4-9", 
                        "title": "Fourier notation", 
                        "content": [
                            {
                                "type": "paragraph", 
                                "text": "Any continuously differentiable function <math id=\"inf109\"><mi>f</mi><mrow><mo>(</mo><mtext mathvariant=\"bold\">x</mtext><mo>)</mo></mrow></math>, defined over <math id=\"inf110\"><mi>S</mi><mo>\u225c</mo><msup><mrow><mo>[</mo><mn>0</mn><mo>,</mo><mi>L</mi><mo>]</mo></mrow><mi>D</mi></msup></math>,\u00a0a 'box' region in <math id=\"inf111\"><mi>D</mi></math> dimensions, with periodic boundary conditions, can be written using a Fourier series"
                            }, 
                            {
                                "type": "mathml", 
                                "id": "equ24", 
                                "label": "(23)", 
                                "mathml": "<math><mtable columnalign=\"left\"><mtr><mtd><mover><mi>f</mi><mo>^</mo></mover><mrow><mo>(</mo><mtext mathvariant=\"bold\">k</mtext><mo>)</mo></mrow><mo>\u225c</mo><mfrac><mn>1</mn><mrow><mo>|</mo><mi>S</mi><mo>|</mo></mrow></mfrac><msub><mo>\u222b</mo><mi>S</mi></msub><mi>f</mi><mrow><mo>(</mo><mtext mathvariant=\"bold\">x</mtext><mo>)</mo></mrow><msup><mi>e</mi><mrow><mi>i</mi><mtext mathvariant=\"bold\">k</mtext><mo>\u22c5</mo><mtext mathvariant=\"bold\">x</mtext></mrow></msup><mi>d</mi><mtext mathvariant=\"bold\">x</mtext><mo>,</mo></mtd></mtr><mtr><mtd><mi>f</mi><mrow><mo>(</mo><mtext mathvariant=\"bold\">x</mtext><mo>)</mo></mrow><mo>\u225c</mo><munderover><mo>\u2211</mo><mrow><mtext mathvariant=\"bold\">k</mtext><mo>\u2208</mo><mover><mi>S</mi><mo mathvariant=\"italic\">^</mo></mover></mrow><mrow></mrow></munderover><mover><mi>f</mi><mo>^</mo></mover><mrow><mo>(</mo><mtext mathvariant=\"bold\">k</mtext><mo>)</mo></mrow><msup><mi>e</mi><mrow><mo>\u2212</mo><mi>i</mi><mtext mathvariant=\"bold\">k</mtext><mo>\u22c5</mo><mtext mathvariant=\"bold\">x</mtext></mrow></msup><mo>,</mo></mtd></mtr></mtable></math>"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "where <math id=\"inf112\"><mrow><mrow><mo>|</mo><mi>S</mi><mo>|</mo></mrow><mo>=</mo><msup><mi>L</mi><mi>D</mi></msup></mrow></math> is the volume of the box and"
                            }, 
                            {
                                "type": "mathml", 
                                "id": "equ25", 
                                "mathml": "<math><mrow><mover accent=\"true\"><mi>S</mi><mo>^</mo></mover><mo>\u225c</mo><msub><mrow><mrow><mo>{</mo><mrow><mrow><mo>(</mo><mrow><mfrac><mrow><mn>2</mn><msub><mi>m</mi><mn>1</mn></msub><mi>\u03c0</mi></mrow><mi>L</mi></mfrac><mo>,</mo><mo>\u2026</mo><mo>,</mo><mfrac><mrow><mn>2</mn><msub><mi>m</mi><mi>d</mi></msub><mi>\u03c0</mi></mrow><mi>L</mi></mfrac></mrow><mo>)</mo></mrow></mrow><mo>}</mo></mrow></mrow><mrow><mrow><mo>(</mo><mrow><msub><mi>m</mi><mn>1</mn></msub><mo>,</mo><mo>\u2026</mo><mo>,</mo><msub><mi>m</mi><mi>d</mi></msub></mrow><mo>)</mo></mrow><mo>\u2208</mo><msup><mi>\u2124</mi><mi>D</mi></msup></mrow></msub></mrow></math>"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "is the reciprocal lattice of <i>S</i> in <b>k</b>-space (frequency space)."
                            }
                        ]
                    }, 
                    {
                        "type": "section", 
                        "id": "s4-10", 
                        "title": "PCA solution", 
                        "content": [
                            {
                                "type": "paragraph", 
                                "text": "Assuming periodic boundary conditions, we use Parseval\u2019s identity, and the properties of the convolution, to transform the steady state objective (<a href=\"#equ22\">Equation 21</a>) to its simpler form in the Fourier domain,"
                            }, 
                            {
                                "type": "mathml", 
                                "id": "equ26", 
                                "label": "(24)", 
                                "mathml": "<math><mfrac><mn>1</mn><mrow><mo>|</mo><mi>S</mi><mo>|</mo></mrow></mfrac><msubsup><mo>\u222b</mo><mi>S</mi><mrow></mrow></msubsup><msup><mi>\u03c8</mi><mn>2</mn></msup><mrow><mo>(</mo><mtext mathvariant=\"bold\">x</mtext><mo>)</mo></mrow><mtext>d</mtext><mtext mathvariant=\"bold\">x</mtext><mo>=</mo><munder><mo>\u2211</mo><mrow><mi mathvariant=\"bold\">k</mi><mo>\u2208</mo><mover><mi>S</mi><mo>^</mo></mover></mrow></munder><msup><mrow><mo>|</mo><mover><mi>J</mi><mo>^</mo></mover><mrow><mo>(</mo><mtext mathvariant=\"bold\">k</mtext><mo>)</mo></mrow><mover><mi>r</mi><mo>^</mo></mover><mrow><mo>(</mo><mtext mathvariant=\"bold\">k</mtext><mo>)</mo></mrow><mo>|</mo></mrow><mn>2</mn></msup><mo>.</mo></math>"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "Similarly, the normalization constraint can also be written in the Fourier domain,"
                            }, 
                            {
                                "type": "mathml", 
                                "id": "equ27", 
                                "label": "(25)", 
                                "mathml": "<math><mfrac><mn>1</mn><mrow><mo>|</mo><mi>S</mi><mo>|</mo></mrow></mfrac><msubsup><mo>\u222b</mo><mi>S</mi><mrow></mrow></msubsup><msup><mi>J</mi><mn>2</mn></msup><mrow><mo>(</mo><mtext mathvariant=\"bold\">x</mtext><mo>)</mo></mrow><mtext>d</mtext><mtext mathvariant=\"bold\">x</mtext><mo>=</mo><munder><mo>\u2211</mo><mrow><mi mathvariant=\"bold\">k</mi><mo>\u2208</mo><mover><mi>S</mi><mo>^</mo></mover></mrow></munder><msup><mrow><mo>|</mo><mover><mi>J</mi><mo>^</mo></mover><mrow><mo>(</mo><mtext mathvariant=\"bold\">k</mtext><mo>)</mo></mrow><mo>|</mo></mrow><mn>2</mn></msup><mo>=</mo><mn>1</mn><mo>.</mo></math>"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "Maximizing the objective <a href=\"#equ26\">Equation 24</a> under this constraint in the Fourier domain, we immediately get that any solution is a linear combination of the Fourier components,"
                            }, 
                            {
                                "type": "mathml", 
                                "id": "equ28", 
                                "label": "(26)", 
                                "mathml": "<math><mover><mi>J</mi><mo>^</mo></mover><mo>(</mo><mi mathvariant=\"bold\">k</mi><mo>)</mo><mo>\u00a0</mo><mo>=</mo><mo>{</mo><mtable columnalign=\"left\"><mtr><mtd><mn>1</mn><mo>,</mo><mo>\u00a0</mo><mo>\u00a0</mo><mo>\u00a0</mo><mo>\u00a0</mo><mo>\u00a0</mo><mi mathvariant=\"bold\">k</mi><mo>=</mo><msub><mi mathvariant=\"bold\">k</mi><mo>*</mo></msub></mtd></mtr><mtr><mtd><mn>0</mn><mo>,</mo><mo>\u00a0</mo><mo>\u00a0</mo><mo>\u00a0</mo><mo>\u00a0</mo><mo>\u00a0</mo><mi mathvariant=\"bold\">k</mi><mo>\u2260</mo><msub><mi mathvariant=\"bold\">k</mi><mo>*</mo></msub></mtd></mtr></mtable><mo>.</mo></math>"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "where"
                            }, 
                            {
                                "type": "mathml", 
                                "id": "equ29", 
                                "label": "(27)", 
                                "mathml": "<math><msub><mtext mathvariant=\"bold\">k</mtext><mo mathvariant=\"bold\">*</mo></msub><mo>\u2208</mo><msub><mi>argmax</mi><mrow><mtext mathvariant=\"bold\">k</mtext><mo>\u2208</mo><mover><mi>S</mi><mo mathvariant=\"italic\">^</mo></mover></mrow></msub><mover><mi>r</mi><mo>^</mo></mover><mo>\u00a0</mo><mo>(</mo><mtext mathvariant=\"bold\">k</mtext><mo>)</mo><mo>,</mo></math>"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "and <math id=\"inf113\"><mover><mi>J</mi><mo>^</mo></mover><mrow><mo>(</mo><mtext mathvariant=\"bold\">k</mtext><mo>)</mo></mrow></math> satisfies the normalization constraint. In the original space, the Fourier components are"
                            }, 
                            {
                                "type": "mathml", 
                                "id": "equ30", 
                                "label": "(28)", 
                                "mathml": "<math><mi>J</mi><mo>(</mo><mtext mathvariant=\"bold\">x</mtext><mo>)</mo><mo>=</mo><msup><mi>e</mi><mrow><mi>i</mi><mtext mathvariant=\"bold\">k</mtext><mo>\u00b7</mo><mtext mathvariant=\"bold\">x</mtext><mo>+</mo><mi>i</mi><mi>\u03d5</mi></mrow></msup><mo>,</mo></math>"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "where <math id=\"inf114\"><mrow><mi>\u03d5</mi><mo>\u2208</mo><mrow><mo>[</mo><mrow><mn>0</mn><mo>,</mo><mn>2</mn><mi>\u03c0</mi></mrow><mo>)</mo></mrow></mrow></math> is a free parameter that determines the phase. Also, since <math id=\"inf115\"><mi>J</mi><mrow><mo>(</mo><mtext mathvariant=\"bold\">x</mtext><mo>)</mo></mrow></math> should assume real values, it is composed of real Fourier components"
                            }, 
                            {
                                "type": "mathml", 
                                "id": "equ31", 
                                "label": "(29)", 
                                "mathml": "<math><mi>J</mi><mrow><mo>(</mo><mtext mathvariant=\"bold\">x</mtext><mo>)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><msqrt><mn>2</mn></msqrt></mfrac><mrow><mo>(</mo><msup><mi>e</mi><mrow><mi>i</mi><msub><mtext mathvariant=\"bold\">k</mtext><mo mathvariant=\"bold\">*</mo></msub><mo>\u22c5</mo><mtext mathvariant=\"bold\">x</mtext><mo>+</mo><mi>i</mi><mi>\u03d5</mi></mrow></msup><mo>+</mo><msup><mi>e</mi><mrow><mo>\u2212</mo><mi>i</mi><msub><mtext mathvariant=\"bold\">k</mtext><mo mathvariant=\"bold\">*</mo></msub><mo>\u22c5</mo><mtext mathvariant=\"bold\">x</mtext><mo>\u2212</mo><mi>i</mi><mi>\u03d5</mi></mrow></msup><mo>)</mo></mrow><mo>=</mo><msqrt><mn>2</mn></msqrt><mtext>cos</mtext><mrow><mo>(</mo><msub><mtext mathvariant=\"bold\">k</mtext><mo mathvariant=\"bold\">*</mo></msub><mo mathvariant=\"bold\">\u22c5</mo><mtext mathvariant=\"bold\">x</mtext><mo>+</mo><mi>\u03d5</mi><mo>)</mo></mrow><mi>.</mi></math>"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "This is a valid solution, since <math id=\"inf116\"><mi>r</mi><mrow><mo>(</mo><mtext mathvariant=\"bold\">x</mtext><mo>)</mo></mrow></math> is a real-valued function, <math id=\"inf117\"><mover><mi>r</mi><mo>^</mo></mover><mrow><mo>(</mo><mtext mathvariant=\"bold\">k</mtext><mo>)</mo></mrow><mo>=</mo><mover><mi>r</mi><mo>^</mo></mover><mrow><mo>(</mo><mo>\u2212</mo><mtext mathvariant=\"bold\">k</mtext><mo>)</mo></mrow></math> and therefore <math id=\"inf118\"><mo>-</mo><msub><mtext mathvariant=\"bold\">k</mtext><mo>*</mo></msub><mo>\u2208</mo><mo>\u00a0</mo><msup><msub><mi>argmax</mi><mrow><mtext mathvariant=\"bold\">k</mtext><mo>\u2208</mo><mover><mi mathvariant=\"normal\">S</mi><mo>^</mo></mover></mrow></msub><mover><mi mathvariant=\"normal\">r</mi><mo>^</mo></mover></msup><mo>(</mo><mtext mathvariant=\"bold\">k</mtext><mo>)</mo></math>."
                            }
                        ]
                    }, 
                    {
                        "type": "section", 
                        "id": "s4-11", 
                        "title": "PCA solution for a difference of Gaussians tuning curve", 
                        "content": [
                            {
                                "type": "paragraph", 
                                "text": "In this paper we focused on the case where <math id=\"inf119\"><mi>r</mi><mrow><mo>(</mo><mtext mathvariant=\"bold\">x</mtext><mo>)</mo></mrow></math>\u00a0has the shape of a difference of Gaussians (<a href=\"#equ7\">Equation 7</a>),"
                            }, 
                            {
                                "type": "mathml", 
                                "id": "equ32", 
                                "label": "(30)", 
                                "mathml": "<math><mi>r</mi><mrow><mo>(</mo><mtext mathvariant=\"bold\">x</mtext><mo>)</mo></mrow><mo>\u221d</mo><msub><mi>c</mi><mrow><mn>1</mn><mo>\u00a0</mo></mrow></msub><mi>exp</mi><mrow><mo>(</mo><mo>\u2212</mo><mfrac><msup><mrow><mo>\u2016</mo><mtext mathvariant=\"bold\">x</mtext><mo>\u2016</mo></mrow><mn>2</mn></msup><mrow><mn>2</mn><msubsup><mi>\u03c3</mi><mn>1</mn><mn>2</mn></msubsup></mrow></mfrac><mo>)</mo></mrow><mo>\u2212</mo><msub><mi>c</mi><mn>2</mn></msub><mo>\u00a0</mo><mi>exp</mi><mrow><mo>(</mo><mo>\u2212</mo><mfrac><msup><mrow><mo>\u2016</mo><mtext mathvariant=\"bold\">x</mtext><mo>\u2016</mo></mrow><mn>2</mn></msup><mrow><mn>2</mn><msubsup><mi>\u03c3</mi><mn>2</mn><mn>2</mn></msubsup></mrow></mfrac><mo>)</mo></mrow></math>"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "where <math id=\"inf120\"><mrow><msub><mi>c</mi><mn>1</mn></msub></mrow></math> and <math id=\"inf121\"><mrow><msub><mi>c</mi><mn>2</mn></msub></mrow></math> are some positive normalization constants, set so that <math id=\"inf122\"><msub><mo>\u222b</mo><mi>S</mi></msub><mi>r</mi><mrow><mo>(</mo><mtext mathvariant=\"bold\">x</mtext><mo>)</mo></mrow><mi>d</mi><mtext mathvariant=\"bold\">x</mtext><mo>=</mo><mn>0</mn></math> (see appendix). The Fourier transform of <math id=\"inf123\"><mi>r</mi><mo>(</mo><mtext mathvariant=\"bold\">x</mtext><mo>)</mo></math> is also a difference of Gaussians"
                            }, 
                            {
                                "type": "mathml", 
                                "id": "equ33", 
                                "label": "(31)", 
                                "mathml": "<math><mover><mi>r</mi><mo>^</mo></mover><mrow><mo>(</mo><mtext mathvariant=\"bold\">k</mtext><mo>)</mo></mrow><mo>\u221d</mo><mi>exp</mi><mrow><mo>(</mo><mo>\u2212</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><msubsup><mi>\u03c3</mi><mn>1</mn><mn>2</mn></msubsup><msup><mrow><mo>\u2016</mo><mtext mathvariant=\"bold\">k</mtext><mo>\u2016</mo></mrow><mn>2</mn></msup><mo>)</mo></mrow><mo>\u2212</mo><mi>exp</mi><mrow><mo>(</mo><mo>\u2212</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><msubsup><mi>\u03c3</mi><mn>2</mn><mn>2</mn></msubsup><msup><mrow><mo>\u2016</mo><mtext mathvariant=\"bold\">k</mtext><mo>\u2016</mo></mrow><mn>2</mn></msup><mo>)</mo></mrow></math>"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "<math id=\"inf124\"><mo>\u2200</mo><mtext mathvariant=\"bold\">k</mtext><mo>\u2208</mo><mover><mi>S</mi><mo>^</mo></mover></math>, as we show in the appendix. Therefore the value of the Fourier domain objective only depends on the radius <math id=\"inf125\"><mrow><mrow><mo>\u2016</mo><mstyle mathvariant=\"bold\"><mi>k</mi></mstyle><mo>\u2016</mo></mrow></mrow></math>, and all solutions <math id=\"inf126\"><mrow><msub><mstyle mathvariant=\"bold\"><mi>k</mi></mstyle><mo>*</mo></msub></mrow></math> have the same radius <math id=\"inf127\"><mrow><mrow><mo>\u2016</mo><mrow><msub><mstyle mathvariant=\"bold\"><mi>k</mi></mstyle><mo>*</mo></msub></mrow><mo>\u2016</mo></mrow></mrow></math>. If <math id=\"inf128\"><mrow><mi>L</mi><mo>\u2192</mo><mi>\u221e</mi></mrow></math>, then the <math id=\"inf129\"><mi>k</mi></math>-lattice <math id=\"inf130\"><mover accent=\"true\"><mi>S</mi><mo>^</mo></mover></math> becomes dense (<math id=\"inf131\"><mrow><mover accent=\"true\"><mi>S</mi><mo>^</mo></mover><mo>\u2192</mo><msup><mi>\u211d</mi><mi>D</mi></msup></mrow></math>) and this radius is equal to"
                            }, 
                            {
                                "type": "mathml", 
                                "id": "equ34", 
                                "label": "(32)", 
                                "mathml": "<math><msub><mi mathvariant=\"bold\">k</mi><mo>\u2020</mo></msub><mo>=</mo><msub><mtext>argmax</mtext><mrow><mi mathvariant=\"bold\">k</mi><mo>\u2265</mo><mn>0</mn></mrow></msub><mtext>\u00a0</mtext><mfenced close=\"]\" open=\"[\"><mrow><mi>exp</mi><mrow><mo>(</mo><mo>\u2212</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><msubsup><mi>\u03c3</mi><mn>1</mn><mn>2</mn></msubsup><msup><mi>k</mi><mn>2</mn></msup><mo>)</mo></mrow><mo>\u2212</mo><mi>exp</mi><mrow><mo>(</mo><mo>\u2212</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><msubsup><mi>\u03c3</mi><mn>2</mn><mn>2</mn></msubsup><msup><mi>k</mi><mn>2</mn></msup><mo>)</mo></mrow></mrow></mfenced></math>"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "which is a unique maximizer, that can be easily obtained numerically."
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "Notice that if we multiply the place cell field width by some positive constant <math id=\"inf132\"><mi>c</mi></math>, then the solution <math id=\"inf133\"><mrow><msub><mi>k</mi><mo>\u2020</mo></msub></mrow></math> will be divided by <math id=\"inf134\"><mi>c</mi></math>. The grid spacing, proportional to <math id=\"inf135\"><mrow><mfrac><mn>1</mn><mrow><msub><mi>k</mi><mo>\u2020</mo></msub></mrow></mfrac></mrow></math>, would therefore also be multiplied by <math id=\"inf136\"><mi>c</mi></math>. This entails a linear dependency between the place cell field width and the grid cell spacing, in the limit of a large box size <math id=\"inf137\"><mrow><mrow><mo>(</mo><mrow><mi>L</mi><mo>\u2192</mo><mi>\u221e</mi></mrow><mo>)</mo></mrow></mrow></math>. When the box has a finite size, <i>k</i>-lattice discretization also has a (usually small) effect on the grid spacing."
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "In that case, all solutions <math id=\"inf138\"><mrow><msub><mstyle mathvariant=\"bold\"><mi>k</mi></mstyle><mo>*</mo></msub></mrow></math> are restricted to be on the finite lattice <math id=\"inf139\"><mover accent=\"true\"><mi>S</mi><mo>^</mo></mover></math>. Therefore, the solutions <math id=\"inf140\"><mrow><msub><mstyle mathvariant=\"bold\"><mi>k</mi></mstyle><mo>*</mo></msub></mrow></math> are the points on the lattice <math id=\"inf141\"><mover accent=\"true\"><mi>S</mi><mo>^</mo></mover></math> for which the radius <math id=\"inf142\"><mrow><mrow><mo>\u2016</mo><mrow><msub><mstyle mathvariant=\"bold\"><mi>k</mi></mstyle><mo>*</mo></msub></mrow><mo>\u2016</mo></mrow></mrow></math> is closest to <math id=\"inf143\"><mrow><msub><mi>k</mi><mo>\u2020</mo></msub></mrow></math> (see <a href=\"#fig15\">Figure 15B,C</a>)."
                            }, 
                            {
                                "type": "image", 
                                "doi": "10.7554/eLife.10094.020", 
                                "id": "fig15", 
                                "label": "Figure 15.", 
                                "title": "PCA k-space analysis for a difference of Gaussians tuning curve.", 
                                "caption": [
                                    {
                                        "type": "paragraph", 
                                        "text": "(<b>A</b>) The 1D tuning curve <math id=\"inf144\"><mrow><mi>r</mi><mrow><mo>(</mo><mi>x</mi><mo>)</mo></mrow></mrow></math>. (<b>B</b>) The 1D tuning curve Fourier transform <math id=\"inf145\"><mrow><mover accent=\"true\"><mi>r</mi><mo>^</mo></mover><mrow><mo>(</mo><mi>k</mi><mo>)</mo></mrow></mrow></math>. The black circles indicate k-lattice points. The PCA solution, <math id=\"inf146\"><mrow><msub><mi>k</mi><mo>*</mo></msub></mrow></math>, is given by the circles closest to <math id=\"inf147\"><mrow><msub><mi>k</mi><mo>\u2020</mo></msub></mrow></math>, the peak of <math id=\"inf148\"><mrow><mover accent=\"true\"><mi>r</mi><mo>^</mo></mover><mrow><mo>(</mo><mi>k</mi><mo>)</mo></mrow></mrow></math>\u00a0(red cross). (<b>C</b>) A contour plot of the 2D tuning curve Fourier transform <math id=\"inf149\"><mrow><mover accent=\"true\"><mi>r</mi><mo>^</mo></mover><mrow><mo>(</mo><mstyle mathvariant=\"bold\"><mi>k</mi></mstyle><mo>)</mo></mrow></mrow></math>. In 2D k-space the peak of <math id=\"inf150\"><mrow><mover accent=\"true\"><mi>r</mi><mo>^</mo></mover><mrow><mo>(</mo><mstyle mathvariant=\"bold\"><mi>k</mi></mstyle><mo>)</mo></mrow></mrow></math> becomes a circle (red), and the k-lattice <math id=\"inf151\"><mover accent=\"true\"><mi>S</mi><mo>^</mo></mover></math> is a square lattice (black circles). The lattice point can be partitioned into equivalent groups. Several such groups are marked in blue on the lattice. For example, the PCA solution Fourier components lie on the four lattice points closest to the circle, denoted A1-4. Note the grouping of A,B,C &amp;\u00a0D (4,8,4 and 4, respectively) corresponds to the grouping of the 20 highest principal components in <a href=\"#fig4\">Figure 4</a>. Parameters: <math id=\"inf152\"><mrow><mn>2</mn><msub><mi>\u03c3</mi><mn>1</mn></msub><mo>=</mo><msub><mi>\u03c3</mi><mn>2</mn></msub><mo>=</mo><mn>7.5</mn><mo>,</mo><mi>L</mi><mo>=</mo><mn>100</mn></mrow></math>."
                                    }
                                ], 
                                "alt": "", 
                                "uri": "https://publishing-cdn.elifesciences.org/10094/elife-10094-fig15-v2.tif", 
                                "filename": "elife-10094-fig15-v2.tif"
                            }
                        ]
                    }, 
                    {
                        "type": "section", 
                        "id": "s4-12", 
                        "title": "The degeneracy of the PCA solution", 
                        "content": [
                            {
                                "type": "paragraph", 
                                "text": "The number of real-valued PCA solutions (degeneracy) in 1D is two, as there are exactly two maxima, <math id=\"inf153\"><mrow><msub><mi>k</mi><mo>*</mo></msub></mrow></math> and <math id=\"inf154\"><mrow><mo>\u2212</mo><msub><mi>k</mi><mo>*</mo></msub></mrow></math>. The phase <math id=\"inf155\"><mi>\u03d5</mi></math>, determines how the components at <math id=\"inf156\"><mrow><msub><mi>k</mi><mo>*</mo></msub></mrow></math> and <math id=\"inf157\"><mrow><mo>\u2212</mo><msub><mi>k</mi><mo>*</mo></msub></mrow></math> are linearly combined."
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "However, there are more maxima in the 2D case. Specifically, given a maximum <math id=\"inf158\"><mstyle mathvariant=\"bold\"><msub><mi>k</mi><mo>*</mo></msub></mstyle></math>, we can write <math id=\"inf159\"><mrow><mrow><mo>(</mo><mrow><mi>m</mi><mo>,</mo><mi>n</mi></mrow><mo>)</mo></mrow><mo>=</mo><mfrac><mi>L</mi><mrow><mn>2</mn><mi>\u03c0</mi></mrow></mfrac><msub><mstyle mathvariant=\"bold\"><mi>k</mi></mstyle><mo>*</mo></msub></mrow></math>, where <math id=\"inf160\"><mrow><mo>(</mo><mi>m</mi><mo>,</mo><mi>n</mi><mo>)</mo></mrow><mo>\u2208</mo><msup><mi mathvariant=\"normal\">\u2124</mi><mn>2</mn></msup></math>. Usually there are 7 other different points with the same radius: <math id=\"inf161\"><mrow><mrow><mo>(</mo><mrow><mi>m</mi><mo>,</mo><mo>\u2212</mo><mi>n</mi></mrow><mo>)</mo></mrow></mrow></math>,<math id=\"inf162\"><mrow><mrow><mo>(</mo><mrow><mo>\u2212</mo><mi>m</mi><mo>,</mo><mo>\u2212</mo><mi>n</mi></mrow><mo>)</mo></mrow></mrow></math>,<math id=\"inf163\"><mrow><mrow><mo>(</mo><mrow><mo>\u2212</mo><mi>m</mi><mo>,</mo><mi>n</mi></mrow><mo>)</mo></mrow></mrow></math>,<math id=\"inf164\"><mrow><mrow><mo>(</mo><mrow><mo>\u2212</mo><mi>n</mi><mo>,</mo><mo>\u2212</mo><mi>m</mi></mrow><mo>)</mo></mrow></mrow></math>,<math id=\"inf165\"><mrow><mrow><mo>(</mo><mrow><mi>n</mi><mo>,</mo><mo>\u2212</mo><mi>m</mi></mrow><mo>)</mo></mrow></mrow></math>,<math id=\"inf166\"><mrow><mrow><mo>(</mo><mrow><mo>\u2212</mo><mi>n</mi><mo>,</mo><mi>m</mi></mrow><mo>)</mo></mrow></mrow></math> and <math id=\"inf167\"><mo>(</mo><mi>n</mi><mo>,</mo><mi>m</mi><mo>)</mo></math>, so we will have a degeneracy of eight (corresponding to the symmetries of a square box). This is case of points in group B, shown in <a href=\"#fig15\">Figure 15C</a>."
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "However, we can\u00a0also get a different degeneracy. First, if either <math id=\"inf168\"><mi>m</mi><mo>=</mo><mo>\u00b1</mo><mi>n</mi></math>, <math id=\"inf169\"><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow></math> or <math id=\"inf170\"><mrow><mi>m</mi><mo>=</mo><mn>0</mn></mrow></math> we will have a degeneracy of 4, since then some of the original eight points will coincide (groups A,C and D in <a href=\"#fig15\">Figure 15C</a>). Second, additional points <math id=\"inf171\"><mrow><mrow><mo>(</mo><mrow><mi>k</mi><mo>,</mo><mi>r</mi></mrow><mo>)</mo></mrow></mrow></math> can exist such that <math id=\"inf172\"><mrow><msup><mi>k</mi><mn>2</mn></msup><mo>+</mo><msup><mi>r</mi><mn>2</mn></msup><mo>=</mo><msup><mi>m</mi><mn>2</mn></msup><mo>+</mo><msup><mi>n</mi><mn>2</mn></msup></mrow></math>, (Pythagorean triplets with the same hypotenuse) \u2013 for example, <math id=\"inf173\"><mrow><msup><mrow><mn>15</mn></mrow><mn>2</mn></msup><mo>+</mo><msup><mrow><mn>20</mn></mrow><mn>2</mn></msup><mo>=</mo><msup><mrow><mn>25</mn></mrow><mn>2</mn></msup><mo>=</mo><msup><mn>7</mn><mn>2</mn></msup><mo>+</mo><msup><mrow><mn>24</mn></mrow><mn>2</mn></msup></mrow></math>. These points will also appear in groups of four or eight."
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "Therefore, we will always have a degeneracy which is some multiple of 4. Note that in the full network simulation, the degeneracy is not exact. This is due to the perturbation noise from the agent\u2019s random walk as well as the non-uniform sampling of the place cells."
                            }
                        ]
                    }, 
                    {
                        "type": "section", 
                        "id": "s4-13", 
                        "title": "The PCA solution with a non-negative constraint", 
                        "content": [
                            {
                                "type": "paragraph", 
                                "text": "Next, we add the non-negativity constraint <math id=\"inf174\"><mi>J</mi><mo>(</mo><mtext mathvariant=\"bold\">x</mtext><mo>)</mo><mo>\u2265</mo><mn>0</mn></math>. As mentioned earlier, this constraint renders the optimization problem NP-hard, and prevents us from a complete analytical solution. We therefore combine numerical and mathematical analysis, in order to gain intuition as to why"
                            }, 
                            {
                                "type": "list", 
                                "prefix": "number", 
                                "items": [
                                    [
                                        {
                                            "type": "paragraph", 
                                            "text": "Locally optimal 2D solutions are hexagonal."
                                        }
                                    ], 
                                    [
                                        {
                                            "type": "paragraph", 
                                            "text": "These solutions have a grid spacing near (<math id=\"inf175\"><mrow><mn>4</mn><mi>\u03c0</mi><mo>/</mo><mrow><mo>(</mo><mrow><msqrt><mn>3</mn></msqrt><msub><mi>k</mi><mo>\u2020</mo></msub></mrow><mo>)</mo></mrow></mrow></math>\u00a0(<math id=\"inf176\"><msub><mi>k</mi><mo>\u2020</mo></msub></math> is the peak of <math id=\"inf177\"><mover><mi>r</mi><mo>^</mo></mover><mfenced><mi>k</mi></mfenced></math>)."
                                        }
                                    ], 
                                    [
                                        {
                                            "type": "paragraph", 
                                            "text": "The average grid alignment is approximately 7.5\u00b0, for large environments."
                                        }
                                    ], 
                                    [
                                        {
                                            "type": "paragraph", 
                                            "text": "Why grid cells have modules, and what is their spacing."
                                        }
                                    ]
                                ]
                            }
                        ]
                    }, 
                    {
                        "type": "section", 
                        "id": "s4-14", 
                        "title": "1D Solutions", 
                        "content": [
                            {
                                "type": "paragraph", 
                                "text": "Our numerical results indicate that the Fourier components of any locally optimal 1D solution of non-negative PCA have the following structure:"
                            }, 
                            {
                                "type": "list", 
                                "prefix": "number", 
                                "items": [
                                    [
                                        {
                                            "type": "paragraph", 
                                            "text": "There is a non-negative 'DC component'\u00a0(<i>k</i>\u00a0<i>=</i>\u00a00)."
                                        }
                                    ], 
                                    [
                                        {
                                            "type": "paragraph", 
                                            "text": "The maximal non-DC component, (<i>k</i> \u2260 0) is <math id=\"inf178\"><msub><mi>k</mi><mo>*</mo></msub></math>,\u00a0where <math id=\"inf179\"><msub><mi>k</mi><mo>*</mo></msub></math>\u00a0is 'close' (more details below) to <math id=\"inf180\"><msub><mi>k</mi><mo>\u2020</mo></msub></math>, the peak of <math id=\"inf181\"><mover><mi>r</mi><mo>^</mo></mover><mo>(</mo><mi>k</mi><mo>)</mo></math>."
                                        }
                                    ], 
                                    [
                                        {
                                            "type": "paragraph", 
                                            "text": "All other non-zero Fourier components are <math id=\"inf182\"><msubsup><mfenced close=\"}\" open=\"{\"><mrow><mi>m</mi><msub><mi>k</mi><mo>*</mo></msub></mrow></mfenced><mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow><mo>\u221e</mo></msubsup></math>, weaker harmonies of <math id=\"inf183\"><msub><mi>k</mi><mo>*</mo></msub></math>."
                                        }
                                    ]
                                ]
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "This structure suggests that the component at <math id=\"inf184\"><mrow><msub><mi>k</mi><mo>*</mo></msub></mrow></math> aims to maximize the objective, while the other components guarantee the non-negativity of the solution <math id=\"inf185\"><mrow><mi>J</mi><mrow><mo>(</mo><mi>x</mi><mo>)</mo></mrow></mrow></math>. In order to gain some analytical intuition as to why this is the case, we first examine the limit case that <math id=\"inf186\"><mrow><mi>L</mi><mo>\u2192</mo><mi>\u221e</mi></mrow></math> and <math id=\"inf187\"><mrow><mover accent=\"true\"><mi>r</mi><mo>^</mo></mover><mrow><mo>(</mo><mi>k</mi><mo>)</mo></mrow></mrow></math> is highly peaked at <math id=\"inf188\"><msub><mi>k</mi><mo>\u2020</mo></msub></math>. In that case the Fourier objective (<a href=\"#equ26\">Equation 24</a>) simply becomes <math id=\"inf189\"><mrow><mn>2</mn><msup><mrow><mrow><mo>|</mo><mrow><mover accent=\"true\"><mi>r</mi><mo>^</mo></mover><mrow><mo>(</mo><mrow><msub><mi>k</mi><mo>\u2020</mo></msub></mrow><mo>)</mo></mrow></mrow><mo>|</mo></mrow></mrow><mn>2</mn></msup><msup><mrow><mrow><mo>|</mo><mrow><mover accent=\"true\"><mi>J</mi><mo>^</mo></mover><mrow><mo>(</mo><mrow><msub><mi>k</mi><mo>\u2020</mo></msub></mrow><mo>)</mo></mrow></mrow><mo>|</mo></mrow></mrow><mn>2</mn></msup></mrow></math>. For simplicity, we will rescale our units so that <math id=\"inf190\"><mrow><msup><mrow><mrow><mo>|</mo><mrow><mover accent=\"true\"><mi>r</mi><mo>^</mo></mover><mrow><mo>(</mo><mrow><msub><mi>k</mi><mo>\u2020</mo></msub></mrow><mo>)</mo></mrow></mrow><mo>|</mo></mrow></mrow><mn>2</mn></msup><mo>=</mo><mn>1</mn><mo>/</mo><mn>2</mn></mrow></math>, and the objective becomes <math id=\"inf191\"><mrow><msup><mrow><mrow><mo>|</mo><mrow><mover accent=\"true\"><mi>J</mi><mo>^</mo></mover><mrow><mo>(</mo><mrow><msub><mi>k</mi><mo>\u2020</mo></msub></mrow><mo>)</mo></mrow></mrow><mo>|</mo></mrow></mrow><mn>2</mn></msup></mrow></math>. Therefore, the solution must include a Fourier component at <math id=\"inf192\"><mrow><msub><mi>k</mi><mo>\u2020</mo></msub></mrow></math> or the objective would be zero. The other components exist only to maintain the non-negativity constraint, since if they increase in magnitude, then the objective, which is proportional to <math id=\"inf193\"><msup><mrow><mo>|</mo><mover><mi>J</mi><mo>^</mo></mover><mrow><mo>(</mo><msub><mi>k</mi><mo>\u2020</mo></msub><mo>)</mo></mrow><mo>|</mo></mrow><mn>2</mn></msup></math>,\u00a0must decrease to compensate (due to the normalization constraint \u2013 <a href=\"#equ27\">Equation 25</a>). Note that these components must include a positive 'DC component' at <math id=\"inf194\"><mrow><mi>k</mi><mo>=</mo><mn>0</mn></mrow></math>, or else <math id=\"inf195\"><mrow><mstyle displaystyle=\"true\"><mrow><munder><mo>\u222b</mo><mi>S</mi></munder><mrow><mi>J</mi><mrow><mo>(</mo><mi>x</mi><mo>)</mo></mrow></mrow></mrow></mstyle><mi>d</mi><mi>x</mi><mo>\u221d</mo><mover accent=\"true\"><mi>J</mi><mo>^</mo></mover><mrow><mo>(</mo><mn>0</mn><mo>)</mo></mrow><mo>\u2264</mo><mn>0</mn></mrow></math>, which contradicts the constraints. To find all the Fourier components, we examine a solution composed of only a few (<math id=\"inf196\"><mi>M</mi></math>) components"
                            }, 
                            {
                                "type": "mathml", 
                                "id": "equ35", 
                                "mathml": "<math><mi>J</mi><mrow><mo>(</mo><mi>x</mi><mo>)</mo></mrow><mo>=</mo><mover><mi>J</mi><mo>^</mo></mover><mrow><mo>(</mo><mn>0</mn><mo>)</mo></mrow><mo>+</mo><mn>2</mn><munderover><mo>\u2211</mo><mrow><mi>m</mi><mo>=</mo><mn>1</mn></mrow><mi>M</mi></munderover><msub><mover><mi>J</mi><mo>^</mo></mover><mi>m</mi></msub><mi>cos</mi><mrow><mo>(</mo><msub><mi>k</mi><mi>m</mi></msub><mi>x</mi><mo>+</mo><msub><mi>\u03d5</mi><mi>m</mi></msub><mo>)</mo></mrow><mo>.</mo></math>"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "Clearly, we can set <math id=\"inf197\"><mrow><msub><mi>k</mi><mn>1</mn></msub><mo>=</mo><msub><mi>k</mi><mo>\u2020</mo></msub></mrow></math>, or otherwise, the objective would be zero. Also, we must have"
                            }, 
                            {
                                "type": "mathml", 
                                "id": "equ36", 
                                "mathml": "<math><mover><mi>J</mi><mo>^</mo></mover><mrow><mo>(</mo><mn>0</mn><mo>)</mo></mrow><mo>=</mo><mo>\u2212</mo><msub><mi>min</mi><mi>x</mi></msub><mrow><mo>(</mo><mn>2</mn><munderover><mo>\u2211</mo><mrow><mi>m</mi><mo>=</mo><mn>1</mn></mrow><mi>M</mi></munderover><msub><mover><mi>J</mi><mo>^</mo></mover><mi>m</mi></msub><mi>cos</mi><mrow><mo>(</mo><msub><mi>k</mi><mi>m</mi></msub><mi>x</mi><mo>+</mo><msub><mi>\u03d5</mi><mi>m</mi></msub><mo>)</mo></mrow><mo>)</mo></mrow><mo>\u2265</mo><mn>0</mn><mo>.</mo></math>"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "Otherwise, the solution would be either (1) negative or (2) non-optimal, since we can decrease <math id=\"inf198\"><mrow><mover accent=\"true\"><mi>J</mi><mo>^</mo></mover><mrow><mo>(</mo><mn>0</mn><mo>)</mo></mrow></mrow></math> and increase <math id=\"inf199\"><mrow><mrow><mo>|</mo><mrow><msub><mi>J</mi><mn>1</mn></msub></mrow><mo>|</mo></mrow></mrow></math>."
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "For <math id=\"inf200\"><mrow><mi>M</mi><mo>=</mo><mn>1</mn></mrow></math>, we immediately get that, in the optimal solution, <math id=\"inf201\"><mrow><mn>2</mn><msub><mover accent=\"true\"><mi>J</mi><mo>^</mo></mover><mn>1</mn></msub><mo>=</mo><mover accent=\"true\"><mi>J</mi><mo>^</mo></mover><mrow><mo>(</mo><mn>0</mn><mo>)</mo></mrow><mo>=</mo><msqrt><mrow><mn>2</mn><mo>/</mo><mn>3</mn></mrow></msqrt></mrow></math>\u00a0(<math id=\"inf202\"><mrow><msub><mi>\u03d5</mi><mi>m</mi></msub></mrow></math> does not matter). For <math id=\"inf203\"><mrow><mi>M</mi><mo>=</mo><mn>2</mn><mo>,</mo><mn>3</mn></mrow></math> and <math id=\"inf204\"><mn>4</mn></math> a solution is harder to find directly, so we performed a parameter grid search over all the free parameters (<math id=\"inf205\"><mrow><msub><mi>k</mi><mi>m</mi></msub><mo>,</mo><msub><mover accent=\"true\"><mi>J</mi><mo>^</mo></mover><mi>m</mi></msub></mrow></math> and <math id=\"inf206\"><mrow><msub><mi>\u03d5</mi><mi>m</mi></msub></mrow></math>) in those components. We found that the optimal solution (which maximizes the objective <math id=\"inf207\"><mrow><msup><mrow><mrow><mo>|</mo><mrow><mover accent=\"true\"><mi>J</mi><mo>^</mo></mover><mrow><mo>(</mo><mrow><msub><mi>k</mi><mo>\u2020</mo></msub></mrow><mo>)</mo></mrow></mrow><mo>|</mo></mrow></mrow><mn>2</mn></msup></mrow></math>), had the following form"
                            }, 
                            {
                                "type": "mathml", 
                                "id": "equ37", 
                                "label": "(33)", 
                                "mathml": "<math><mi>J</mi><mrow><mo>(</mo><mi>x</mi><mo>)</mo></mrow><mo>=</mo><munderover><mo>\u2211</mo><mrow><mi>m</mi><mo>=</mo><mo>\u2212</mo><mi>M</mi></mrow><mi>M</mi></munderover><mover><mi>J</mi><mo>^</mo></mover><mrow><mo>(</mo><mi>m</mi><msub><mi>k</mi><mo>\u2020</mo></msub><mo>)</mo></mrow><mi>cos</mi><mrow><mo>(</mo><mi>m</mi><msub><mi>k</mi><mo>\u2020</mo></msub><mrow><mo>(</mo><mi>x</mi><mo>\u2212</mo><msub><mi>x</mi><mn>0</mn></msub><mo>)</mo></mrow><mo>)</mo></mrow><mo>,</mo></math>"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "where <math id=\"inf208\"><mrow><msub><mi>x</mi><mn>0</mn></msub></mrow></math> is a free parameter. This form results from a parameter grid search for <math id=\"inf209\"><mrow><mi>M</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>3</mn></mrow></math> and <math id=\"inf210\"><mn>4</mn></math>, under the assumption that <math id=\"inf211\"><mrow><mi>L</mi><mo>\u2192</mo><mi>\u221e</mi></mrow></math> and <math id=\"inf212\"><mrow><mover accent=\"true\"><mi>r</mi><mo>^</mo></mover><mrow><mo>(</mo><mi>k</mi><mo>)</mo></mrow></mrow></math> is highly peaked. However, our numerical results in the general case (<a href=\"#fig16\">Figure 16A</a>), using the FISTA algorithm, indicate that the locally optimal solution does not change much even if <math id=\"inf213\"><mi>L</mi></math> is finite, and <math id=\"inf214\"><mrow><mover accent=\"true\"><mi>r</mi><mo>^</mo></mover><mrow><mo>(</mo><mi>k</mi><mo>)</mo></mrow></mrow></math> is not highly peaked. Specifically, it has a similar form"
                            }, 
                            {
                                "type": "mathml", 
                                "id": "equ38", 
                                "label": "(34)", 
                                "mathml": "<math><mi>J</mi><mrow><mo>(</mo><mi>x</mi><mo>)</mo></mrow><mo>=</mo><munderover><mo>\u2211</mo><mrow><mi>m</mi><mo>=</mo><mo>\u2212</mo><mi>\u221e</mi></mrow><mi>\u221e</mi></munderover><mover><mi>J</mi><mo>^</mo></mover><mrow><mo>(</mo><mi>m</mi><msub><mi>k</mi><mo>*</mo></msub><mo>)</mo></mrow><mi>cos</mi><mrow><mo>(</mo><mi>m</mi><msub><mi>k</mi><mo>*</mo></msub><mrow><mo>(</mo><mi>x</mi><mo>\u2212</mo><msub><mi>x</mi><mn>0</mn></msub><mo>)</mo></mrow><mo>)</mo></mrow><mo>.</mo></math>"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "Since <math id=\"inf215\"><mrow><mover accent=\"true\"><mi>J</mi><mo>^</mo></mover><mrow><mo>(</mo><mrow><mi>m</mi><msub><mi>k</mi><mo>*</mo></msub></mrow><mo>)</mo></mrow></mrow></math> is rapidly decaying (<a href=\"#fig16\">Figure 16A</a>), effectively only the first few components are non-negligible, as in <a href=\"#equ37\">Equation 33</a>. This can also be seen in the value of the objective obtained in the parameter scan"
                            }, 
                            {
                                "type": "mathml", 
                                "id": "equ39", 
                                "label": "(35)", 
                                "mathml": "<math><mtable><mtr><mtd><mi>M</mi></mtd><mtd><mn>1</mn></mtd><mtd><mn>2</mn></mtd><mtd><mn>3</mn></mtd><mtd><mn>4</mn></mtd></mtr><mtr><mtd><msup><mrow><mo>|</mo><mover><mi>J</mi><mo>^</mo></mover><mrow><mo>(</mo><msub><mi>k</mi><mo>\u2020</mo></msub><mo>)</mo></mrow><mo>|</mo></mrow><mn>2</mn></msup></mtd><mtd><mfrac><mn>1</mn><mn>6</mn></mfrac></mtd><mtd><mn>0.2367</mn></mtd><mtd><mn>0.2457</mn></mtd><mtd><mn>0.2457</mn></mtd></mtr></mtable><mo>,</mo></math>"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "where the contribution of additional high frequency components to the objective quickly becomes negligible. In fact, the value of the objective cannot increase above <math id=\"inf216\"><mrow><mn>0.25</mn></mrow></math>, as we explain in the next section."
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "And so, the main difference between <a href=\"#equ37\">Equations 33 and 34</a> is the base frequency, <math id=\"inf217\"><mrow><msub><mi>k</mi><mo>*</mo></msub></mrow></math>, which is slightly different from <math id=\"inf218\"><msub><mi>k</mi><mo>\u2020</mo></msub></math>. As explained in the appendix, the relation between <math id=\"inf219\"><mrow><msub><mi>k</mi><mo>*</mo></msub></mrow></math> and <math id=\"inf220\"><msub><mi>k</mi><mo>\u2020</mo></msub></math> depends on the <math id=\"inf221\"><mi>k</mi></math>-lattice discretization, as well as on the properties of <math id=\"inf222\"><mrow><mover accent=\"true\"><mi>r</mi><mo>^</mo></mover><mrow><mo>(</mo><mi>k</mi><mo>)</mo></mrow></mrow></math>."
                            }, 
                            {
                                "type": "image", 
                                "doi": "10.7554/eLife.10094.021", 
                                "id": "fig16", 
                                "label": "Figure 16.", 
                                "title": "Fourier components of Non-negative PCA on the <math id=\"inf223\"><mi>k</mi></math>-lattice.", 
                                "caption": [
                                    {
                                        "type": "paragraph", 
                                        "text": "(<b>A</b>) 1D solution (blue) includes: a DC component (<math id=\"inf224\"><mrow><mi>k</mi><mo>=</mo><mn>0</mn></mrow></math>), a maximal component with magnitude near <math id=\"inf225\"><mrow><msub><mi>k</mi><mo>\u2020</mo></msub></mrow></math> (red line), and weaker harmonics of the maximal component. (<b>B</b>) 2D solution includes: a DC component (<i><b>k</b></i>\u00a0=\u00a0(0,0)), a hexgaon of strong components with radius near <math id=\"inf226\"><mrow><msub><mi>k</mi><mo>\u2020</mo></msub></mrow></math> (red circle), and weaker components on the lattice of the strong components. White dots show underlying <math id=\"inf227\"><mi>k</mi></math>-lattice. We used a difference of Gaussians tuning curve, with parameters <math id=\"inf228\"><mrow><mn>2</mn><msub><mi>\u03c3</mi><mn>1</mn></msub><mo>=</mo><msub><mi>\u03c3</mi><mn>2</mn></msub><mo>=</mo><mn>7.5</mn><mo>,</mo><mi>L</mi><mo>=</mo><mn>100</mn></mrow></math>, and the FISTA algorithm."
                                    }
                                ], 
                                "alt": "", 
                                "uri": "https://publishing-cdn.elifesciences.org/10094/elife-10094-fig16-v2.tif", 
                                "filename": "elife-10094-fig16-v2.tif"
                            }
                        ]
                    }, 
                    {
                        "type": "section", 
                        "id": "s4-15", 
                        "title": "2D Solutions", 
                        "content": [
                            {
                                "type": "paragraph", 
                                "text": "The 1D properties, described in the previous section, generalize to the 2D case in the following manner:"
                            }, 
                            {
                                "type": "list", 
                                "prefix": "number", 
                                "items": [
                                    [
                                        {
                                            "type": "paragraph", 
                                            "text": "There is a non-negative DC component <math id=\"inf229\"><mtext>(</mtext><mtext mathvariant=\"bold\">k</mtext><mo>=</mo><mtext>(</mtext><mn>0</mn><mo>,</mo><mn>0</mn><mtext>))</mtext></math>."
                                        }
                                    ], 
                                    [
                                        {
                                            "type": "paragraph", 
                                            "text": "A small 'basis set' of components <math id=\"inf230\"><msubsup><mfenced close=\"}\" open=\"{\"><msubsup><mi mathvariant=\"bold\">k</mi><mo>*</mo><mrow><mo>(</mo><mi mathvariant=\"normal\">i</mi><mo>)</mo></mrow></msubsup></mfenced><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>B</mi></msubsup></math>with similar amplitudes, and with similar radii <math id=\"inf231\"><mfenced close=\"||\" open=\"||\"><msubsup><mi mathvariant=\"bold\">k</mi><mo>*</mo><mrow><mo>(</mo><mi>i</mi><mo>)</mo></mrow></msubsup></mfenced></math> which are all 'close' to <math id=\"inf232\"><msub><mi>k</mi><mo>\u2020</mo></msub></math> (details below)."
                                        }
                                    ], 
                                    [
                                        {
                                            "type": "paragraph", 
                                            "text": "All other non-zero Fourier components are weaker, and restricted to the lattice"
                                        }
                                    ]
                                ]
                            }, 
                            {
                                "type": "mathml", 
                                "id": "equ40", 
                                "mathml": "<math><msub><mfenced close=\"}\" open=\"{\"><mrow><mi mathvariant=\"bold\">k</mi><mo>\u2208</mo><mover><mi>S</mi><mo>^</mo></mover><mo>\u00a0</mo><mo>|</mo><mo>\u00a0</mo><mi mathvariant=\"bold\">k</mi><mo>=</mo><munderover><mo mathvariant=\"bold\">\u2211</mo><mrow><mi mathvariant=\"bold\">i</mi><mo mathvariant=\"bold\">=</mo><mn mathvariant=\"bold\">1</mn></mrow><mi mathvariant=\"bold\">B</mi></munderover><msub><mi>n</mi><mi mathvariant=\"bold\">i</mi></msub><msubsup><mi mathvariant=\"bold\">k</mi><mo mathvariant=\"bold\">*</mo><mrow><mo mathvariant=\"bold\">(</mo><mi mathvariant=\"bold\">i</mi><mo mathvariant=\"bold\">)</mo></mrow></msubsup></mrow></mfenced><mrow><mrow><mo>(</mo><msub><mi>n</mi><mn>1</mn></msub><mo>,</mo><mn>...</mn><mo>,</mo><msub><mi>n</mi><mi>B</mi></msub><mo>)</mo></mrow><mo>\u2208</mo><msup><mi mathvariant=\"normal\">\u2124</mi><mi>B</mi></msup></mrow></msub></math>"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "Interestingly, given these properties of the solution we already get hexagonal patterns, as we explain next."
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "Similarly to the 1D case, the difference between <math id=\"inf233\"><mrow><mrow><mo>\u2016</mo><mrow><msubsup><mstyle mathvariant=\"bold\"><mi>k</mi></mstyle><mo>*</mo><mrow><mrow><mo>(</mo><mi>i</mi><mo>)</mo></mrow></mrow></msubsup></mrow><mo>\u2016</mo></mrow></mrow></math> and <math id=\"inf234\"><msub><mi>k</mi><mo>\u2020</mo></msub></math> is affected by lattice discretization, and the curvature of <math id=\"inf235\"><mrow><mover accent=\"true\"><mi>r</mi><mo>^</mo></mover><mrow><mo>(</mo><mi>k</mi><mo>)</mo></mrow></mrow></math> near <math id=\"inf236\"><msub><mi>k</mi><mo>\u2020</mo></msub></math>. To simplify matters, we focus first on the simple case that <math id=\"inf237\"><mrow><mi>L</mi><mo>\u2192</mo><mi>\u221e</mi></mrow></math> and <math id=\"inf238\"><mrow><mover accent=\"true\"><mi>r</mi><mo>^</mo></mover><mrow><mo>(</mo><mi>k</mi><mo>)</mo></mrow></mrow></math> is sharply peaked around <math id=\"inf239\"><msub><mi>k</mi><mo>\u2020</mo></msub></math>. Therefore, the Fourier objective becomes <math id=\"inf240\"><mrow><mstyle displaystyle=\"true\"><munderover><mo>\u2211</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>B</mi></munderover><mrow><msup><mrow><mrow><mo>|</mo><mrow><mover accent=\"true\"><mi>J</mi><mo>^</mo></mover><mrow><mo>(</mo><mrow><msubsup><mstyle mathvariant=\"bold\"><mi>k</mi></mstyle><mo>*</mo><mrow><mrow><mo>(</mo><mi>i</mi><mo>)</mo></mrow></mrow></msubsup></mrow><mo>)</mo></mrow></mrow><mo>|</mo></mrow></mrow><mn>2</mn></msup></mrow></mstyle></mrow></math>, so the only Fourier components that appear in the objective are <math id=\"inf241\"><mrow><msubsup><mrow><mrow><mo>{</mo><mrow><msubsup><mstyle mathvariant=\"bold\"><mi>k</mi></mstyle><mo>*</mo><mrow><mrow><mo>(</mo><mi>i</mi><mo>)</mo></mrow></mrow></msubsup></mrow><mo>}</mo></mrow></mrow><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>B</mi></msubsup></mrow></math>, which have radius <math id=\"inf242\"><msub><mi>k</mi><mo>\u2020</mo></msub></math>. We examine the values this objective can have."
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "All the base components have the same radius.\u00a0This implies,\u00a0according to the Crystallographic restriction theorem in 2D, that the only allowed lattice angles (in the range between 0 and 90 degrees) are 0,\u00a060 and 90 degrees. Therefore, there are only three possible lattice types in 2D. Next, we examine the value of the objective for each of these lattice types:"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "1) Square lattice, in which <math id=\"inf243\"><msubsup><mtext mathvariant=\"bold\">k</mtext><mo>*</mo><mrow><mo>(</mo><mn>1</mn><mo>)</mo></mrow></msubsup><mo>=</mo><msub><mtext mathvariant=\"bold\">k</mtext><mo>\u2020</mo></msub><mrow><mo>(</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo>)</mo></mrow><mo>,</mo><mo>\u00a0</mo><msubsup><mtext mathvariant=\"bold\">k</mtext><mo>*</mo><mrow><mo>(</mo><mn>2</mn><mo>)</mo></mrow></msubsup><mo>=</mo><msub><mtext mathvariant=\"bold\">k</mtext><mo>\u2020</mo></msub><mrow><mo>(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo>)</mo></mrow></math>, up to a rotation. In this case,"
                            }, 
                            {
                                "type": "mathml", 
                                "id": "equ41", 
                                "mathml": "<math><mi>J</mi><mrow><mo>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>)</mo></mrow><mo>=</mo><munderover><mo>\u2211</mo><mrow><msub><mi>m</mi><mi>x</mi></msub><mo>=</mo><mo>\u2212</mo><mi>\u221e</mi></mrow><mi>\u221e</mi></munderover><munderover><mo>\u2211</mo><mrow><msub><mi>m</mi><mi>y</mi></msub><mo>=</mo><mo>\u2212</mo><mi>\u221e</mi></mrow><mi>\u221e</mi></munderover><msubsup><mover><mi>J</mi><mo>^</mo></mover><mrow><msub><mi>m</mi><mi>x</mi></msub><mo>,</mo><msub><mi>m</mi><mi>y</mi></msub></mrow><mrow></mrow></msubsup><mi>cos</mi><mrow><mo>(</mo><msub><mi>k</mi><mo>\u2020</mo></msub><mrow><mo>(</mo><msub><mi>m</mi><mi>x</mi></msub><mi>x</mi><mo>+</mo><msub><mi>m</mi><mi>y</mi></msub><mi>y</mi><mo>)</mo></mrow><mo>+</mo><msub><mi>\u03d5</mi><mrow><msub><mi>m</mi><mi>x</mi></msub><mo>,</mo><msub><mi>m</mi><mi>y</mi></msub></mrow></msub><mo>)</mo></mrow></math>"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "and the value of the objective is bounded above by <math id=\"inf244\"><mrow><mn>0.25</mn></mrow></math> (see proof in appendix)."
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "2) 1D lattice, in which <math id=\"inf245\"><msubsup><mtext mathvariant=\"bold\">k</mtext><mo>*</mo><mrow><mo>(</mo><mn>1</mn><mo>)</mo></mrow></msubsup><mo>=</mo><msub><mi mathvariant=\"normal\">k</mi><mo>\u2020</mo></msub><mrow><mo>(</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo>)</mo></mrow></math>, up to a rotation. This is a special case of the square lattice, with a subset of <math id=\"inf246\"><mrow><msubsup><mover accent=\"true\"><mi>J</mi><mo>^</mo></mover><mrow><msub><mi>m</mi><mi>x</mi></msub><mo>,</mo><msub><mi>m</mi><mi>y</mi></msub></mrow><mrow></mrow></msubsup></mrow></math>equal to zero, so we can write, as we did in the 1D case"
                            }, 
                            {
                                "type": "mathml", 
                                "id": "equ42", 
                                "mathml": "<math><mrow><mi>J</mi><mrow><mo>(</mo><mi>x</mi><mo>)</mo></mrow><mo>=</mo><mstyle displaystyle=\"true\"><munderover><mo>\u2211</mo><mrow><mi>m</mi><mo>=</mo><mo>\u2212</mo><mi>\u221e</mi></mrow><mi>\u221e</mi></munderover><mrow><msubsup><mover accent=\"true\"><mi>J</mi><mo>^</mo></mover><mi>m</mi><mrow></mrow></msubsup></mrow></mstyle><mi>cos</mi><mrow><mo>(</mo><mrow><msub><mi>k</mi><mo>\u2020</mo></msub><mi>m</mi><mi>x</mi><mo>+</mo><msub><mi>\u03d5</mi><mi>m</mi></msub></mrow><mo>)</mo></mrow></mrow></math>"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "Therefore, the same objective upper bound, <math id=\"inf247\"><mrow><mn>0.25</mn></mrow></math>, holds. Note that some of the solutions we found numerically are close to this bound (<a href=\"#equ39\">Equation 35</a>)."
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "3) Hexagonal lattice, in which the base components are"
                            }, 
                            {
                                "type": "mathml", 
                                "id": "equ43", 
                                "mathml": "<math><mrow><msubsup><mstyle mathvariant=\"bold\"><mi>k</mi></mstyle><mo>*</mo><mrow><mrow><mo>(</mo><mn>1</mn><mo>)</mo></mrow></mrow></msubsup><mo>=</mo><msub><mi>k</mi><mo>\u2020</mo></msub><mrow><mo>(</mo><mrow><mn>1</mn><mo>,</mo><mn>0</mn></mrow><mo>)</mo></mrow><mo>,</mo><msubsup><mstyle mathvariant=\"bold\"><mi>k</mi></mstyle><mo>*</mo><mrow><mrow><mo>(</mo><mn>2</mn><mo>)</mo></mrow></mrow></msubsup><mo>=</mo><msub><mi>k</mi><mo>\u2020</mo></msub><mrow><mo>(</mo><mrow><mo>\u2212</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo>,</mo><mfrac><mrow><msqrt><mn>3</mn></msqrt></mrow><mn>2</mn></mfrac></mrow><mo>)</mo></mrow><mo>,</mo><msubsup><mstyle mathvariant=\"bold\"><mi>k</mi></mstyle><mo>*</mo><mrow><mrow><mo>(</mo><mn>3</mn><mo>)</mo></mrow></mrow></msubsup><mo>=</mo><msub><mi>k</mi><mo>\u2020</mo></msub><mrow><mo>(</mo><mrow><mo>\u2212</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo>,</mo><mo>\u2212</mo><mfrac><mrow><msqrt><mn>3</mn></msqrt></mrow><mn>2</mn></mfrac></mrow><mo>)</mo></mrow></mrow></math>"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "up to a rotation by some angle <math id=\"inf248\"><mi>\u03b1</mi></math>. Our parameter scans indicate that the objective value cannot surpass <math id=\"inf249\"><mrow><mn>0.2</mn></mrow></math> in any solution composed of only the base hexgonal components <math id=\"inf250\"><msubsup><mrow><mo>{</mo><msubsup><mi mathvariant=\"bold\">k</mi><mo>*</mo><mrow><mo>(</mo><mi>m</mi><mo>)</mo></mrow></msubsup><mo>}</mo></mrow><mrow><mi>m</mi><mo>=</mo><mn>1</mn></mrow><mn>3</mn></msubsup></math> and a DC component. However, taking into account also some higher order lattice components, we can find a better solution, with an objective value of <math id=\"inf251\"><mrow><mn>0.2558</mn></mrow></math>. Though this is not necessarily the optimal solution, it surpasses any possible solutions on the other lattice types (bounded below <math id=\"inf252\"><mrow><mn>0.25</mn></mrow></math>, as we proved in the appendix). Specifically, this solution is composed of the base vectors <math id=\"inf253\"><mrow><msubsup><mrow><mrow><mo>{</mo><mrow><msubsup><mstyle mathvariant=\"bold\"><mi>k</mi></mstyle><mo>*</mo><mrow><mrow><mo>(</mo><mi>m</mi><mo>)</mo></mrow></mrow></msubsup></mrow><mo>}</mo></mrow></mrow><mrow><mi>m</mi><mo>=</mo><mn>1</mn></mrow><mn>3</mn></msubsup></mrow></math>\u00a0and their harmonics"
                            }, 
                            {
                                "type": "mathml", 
                                "id": "equ44", 
                                "mathml": "<math><mi>J</mi><mrow><mo>(</mo><mtext mathvariant=\"bold\">x</mtext><mo>)</mo></mrow><mo>=</mo><msub><mover><mi>J</mi><mo>^</mo></mover><mn>0</mn></msub><mo>+</mo><mn>2</mn><munderover><mo>\u2211</mo><mrow><mi>m</mi><mo>=</mo><mn>1</mn></mrow><mn>8</mn></munderover><msub><mover><mi>J</mi><mo>^</mo></mover><mi>m</mi></msub><mi>cos</mi><mrow><mo>(</mo><msubsup><mtext mathvariant=\"bold\">k</mtext><mo mathvariant=\"bold\">*</mo><mrow><mo>(</mo><mi mathvariant=\"normal\">m</mi><mo>)</mo></mrow></msubsup><mo mathvariant=\"bold\">\u22c5</mo><mtext mathvariant=\"bold\">x</mtext><mo>)</mo></mrow></math>"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "with <math id=\"inf254\"><msubsup><mtext mathvariant=\"bold\">k</mtext><mo>*</mo><mrow><mo>(</mo><mn>4</mn><mo>)</mo></mrow></msubsup><mo>=</mo><msubsup><mtext mathvariant=\"bold\">2k</mtext><mo>*</mo><mrow><mo>(</mo><mn>1</mn><mo>)</mo></mrow></msubsup></math>, <math id=\"inf255\"><msubsup><mtext mathvariant=\"bold\">k</mtext><mo>*</mo><mrow><mo>(</mo><mn>5</mn><mo>)</mo></mrow></msubsup><mo>=</mo><msubsup><mtext mathvariant=\"bold\">2k</mtext><mo>*</mo><mrow><mo>(</mo><mn>2</mn><mo>)</mo></mrow></msubsup></math>, <math id=\"inf256\"><msubsup><mtext mathvariant=\"bold\">k</mtext><mo>*</mo><mrow><mo>(</mo><mn>6</mn><mo>)</mo></mrow></msubsup><mo>=</mo><msubsup><mtext mathvariant=\"bold\">2k</mtext><mo>*</mo><mrow><mo>(</mo><mn>3</mn><mo>)</mo></mrow></msubsup></math>,\u00a0<math id=\"inf257\"><msubsup><mtext mathvariant=\"bold\">k</mtext><mo>*</mo><mrow><mo>(</mo><mn>7</mn><mo>)</mo></mrow></msubsup><mo>=</mo><msubsup><mtext mathvariant=\"bold\">k</mtext><mo>*</mo><mrow><mo>(</mo><mn>1</mn><mo>)</mo></mrow></msubsup><mo>+</mo><msubsup><mtext mathvariant=\"bold\">k</mtext><mo>*</mo><mrow><mo>(</mo><mn>2</mn><mo>)</mo></mrow></msubsup></math>, <math id=\"inf258\"><msubsup><mtext mathvariant=\"bold\">k</mtext><mo>*</mo><mrow><mo>(</mo><mn>8</mn><mo>)</mo></mrow></msubsup><mo>=</mo><msubsup><mtext mathvariant=\"bold\">k</mtext><mo>*</mo><mrow><mo>(</mo><mn>1</mn><mo>)</mo></mrow></msubsup><mo>+</mo><msubsup><mtext mathvariant=\"bold\">k</mtext><mo>*</mo><mrow><mo>(</mo><mn>3</mn><mo>)</mo></mrow></msubsup></math>. Also, <math id=\"inf259\"><mrow><msub><mover accent=\"true\"><mi>J</mi><mo>^</mo></mover><mn>0</mn></msub><mo>=</mo><mn>0.6449</mn></mrow></math>, <math id=\"inf260\"><mrow><msub><mover accent=\"true\"><mi>J</mi><mo>^</mo></mover><mn>1</mn></msub><mo>=</mo><msub><mover accent=\"true\"><mi>J</mi><mo>^</mo></mover><mn>2</mn></msub><mo>=</mo><msub><mover accent=\"true\"><mi>J</mi><mo>^</mo></mover><mn>3</mn></msub><mo>=</mo><mn>0.292</mn></mrow></math>, <math id=\"inf261\"><mrow><msub><mover accent=\"true\"><mi>J</mi><mo>^</mo></mover><mn>4</mn></msub><mo>=</mo><msub><mover accent=\"true\"><mi>J</mi><mo>^</mo></mover><mn>5</mn></msub><mo>=</mo><msub><mover accent=\"true\"><mi>J</mi><mo>^</mo></mover><mn>6</mn></msub><mo>=</mo><mo>\u2212</mo><mn>0.0101</mn></mrow></math> and <math id=\"inf262\"><mrow><msub><mover accent=\"true\"><mi>J</mi><mo>^</mo></mover><mn>7</mn></msub><mo>=</mo><msub><mover accent=\"true\"><mi>J</mi><mo>^</mo></mover><mn>8</mn></msub><mo>=</mo><mo>\u2212</mo><mn>0.134</mn></mrow></math>."
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "Thus, any optimal solution must be on the hexagonal lattice, given our approximations. In practice, the lattice hexagonal basis vectors do not have exactly the same radius, and, as in the 1D case, this radius is somewhat smaller then <math id=\"inf263\"><mrow><msub><mi>k</mi><mo>\u2020</mo></msub></mrow></math>, due to the lattice discretization, and due to that <math id=\"inf264\"><mrow><mover accent=\"true\"><mi>r</mi><mo>^</mo></mover><mrow><mo>(</mo><mstyle mathvariant=\"bold\"><mi>k</mi></mstyle><mo>)</mo></mrow></mrow></math> is not sharply peaked. However, the resulting solution lattice is still approximately hexagonal in <math id=\"inf265\"><mi>k</mi></math>-space. For example, this can be seen in the numerically obtained solution in <a href=\"#fig16\">Figure 16B</a> \u2013 where the strongest non-DC Fourier components form an approximate hexagon near <math id=\"inf266\"><mrow><msub><mi>k</mi><mo>\u2020</mo></msub></mrow></math>, from the Fourier components A, defined in <a href=\"#fig17\">Figure 17</a>."
                            }, 
                            {
                                "type": "image", 
                                "doi": "10.7554/eLife.10094.022", 
                                "id": "fig17", 
                                "label": "Figure 17.", 
                                "title": "The modules in Fourier space.", 
                                "caption": [
                                    {
                                        "type": "paragraph", 
                                        "text": "As in <a href=\"#fig15\">Figure 15C</a>, we see a contour plot of the 2D tuning curve Fourier transform <math id=\"inf267\"><mrow><mover accent=\"true\"><mi>r</mi><mo>^</mo></mover><mrow><mo>(</mo><mstyle mathvariant=\"bold\"><mi>k</mi></mstyle><mo>)</mo></mrow></mrow></math> and the k-space the peak of <math id=\"inf268\"><mrow><mover accent=\"true\"><mi>r</mi><mo>^</mo></mover><mrow><mo>(</mo><mstyle mathvariant=\"bold\"><mi>k</mi></mstyle><mo>)</mo></mrow></mrow></math> (red circle), and the k-lattice <math id=\"inf269\"><mover accent=\"true\"><mi>S</mi><mo>^</mo></mover></math> (black circles). The lattice points can be divided into approximately hexgonal shaped groups. Several such groups are marked in blue on the lattice. For example, group A and B are optimal since they are nearest to the red circle. The next best (with the highest-valued contours) group of points, which have an approximate hexgonal shape, is C. Note that group C has a k-radius of approximately the optimal radius times <math id=\"inf270\"><mrow><msqrt><mn>2</mn></msqrt></mrow></math> (cyan circle). Parameters: <math id=\"inf271\"><mrow><mn>2</mn><msub><mi>\u03c3</mi><mn>1</mn></msub><mo>=</mo><msub><mi>\u03c3</mi><mn>2</mn></msub><mo>=</mo><mn>7.5</mn><mo>,</mo><mi>L</mi><mo>=</mo><mn>100</mn></mrow></math>."
                                    }
                                ], 
                                "alt": "", 
                                "uri": "https://publishing-cdn.elifesciences.org/10094/elife-10094-fig17-v2.tif", 
                                "filename": "elife-10094-fig17-v2.tif"
                            }, 
                            {
                                "type": "section", 
                                "id": "s4-15-1", 
                                "title": "Grid spacing", 
                                "content": [
                                    {
                                        "type": "paragraph", 
                                        "text": "In general, we get a hexagonal grid pattern in <math id=\"inf272\"><mi>x</mi></math>-space. If all base Fourier components have a radius of <math id=\"inf273\"><mrow><msub><mi>k</mi><mo>\u2020</mo></msub></mrow></math>, then the grid spacing in <math id=\"inf274\"><mi>x</mi></math>-space would be <math id=\"inf275\"><mrow><mn>4</mn><mi>\u03c0</mi><mo>/</mo><mrow><mo>(</mo><mrow><msqrt><mn>3</mn></msqrt><msub><mi>k</mi><mo>\u2020</mo></msub></mrow><mo>)</mo></mrow></mrow></math>. Since the radius of the basis vectors can be smaller than <math id=\"inf276\"><mrow><msub><mi>k</mi><mo>\u2020</mo></msub></mrow></math>, the value of <math id=\"inf277\"><mrow><mn>4</mn><mi>\u03c0</mi><mo>/</mo><mrow><mo>(</mo><mrow><msqrt><mn>3</mn></msqrt><msub><mi>k</mi><mo>\u2020</mo></msub></mrow><mo>)</mo></mrow></mrow></math> is a lower bound to the actual grid spacing (as demonstrated in <a href=\"#fig12\">Figure 12A</a>), up to lattice discretization effects."
                                    }
                                ]
                            }, 
                            {
                                "type": "section", 
                                "id": "s4-15-2", 
                                "title": "Grid alignment", 
                                "content": [
                                    {
                                        "type": "paragraph", 
                                        "text": "The angle of the hexagonal grid, <math id=\"inf278\"><mi>\u03b1</mi></math>, is determined by the directions of the hexagonal vectors. An angle <math id=\"inf279\"><mi>\u03b1</mi></math> is possible, if there exists a <math id=\"inf280\"><mi>k</mi></math>-lattice point <math id=\"inf281\"><mi mathvariant=\"bold\">k</mi><mo>=</mo><mfrac><mrow><mn>2</mn><mi>\u03c0</mi></mrow><mi>L</mi></mfrac><mrow><mo>(</mo><mi>m</mi><mo>,</mo><mi>n</mi><mo>)</mo></mrow></math> (with <math id=\"inf282\"><mrow><mi>m</mi><mo>,</mo><mi>n</mi></mrow></math> integers), for which <math id=\"inf283\"><mrow><mfrac><mi>\u03c0</mi><mi>L</mi></mfrac><mo>&gt;</mo><msqrt><mrow><mfrac><mrow><mn>2</mn><mi>\u03c0</mi></mrow><mi>L</mi></mfrac><mrow><mo>(</mo><mrow><msup><mi>m</mi><mn>2</mn></msup><mo>+</mo><msup><mi>n</mi><mn>2</mn></msup></mrow><mo>)</mo></mrow><mo>\u2212</mo><msubsup><mi>k</mi><mo>*</mo><mn>2</mn></msubsup></mrow></msqrt></mrow></math>, and then <math id=\"inf284\"><mrow><mi>\u03b1</mi><mo>=</mo><mi>arctan</mi><mfrac><mi>n</mi><mi>m</mi></mfrac></mrow></math>. Since the hexagonal lattice has rotational symmetry of <math id=\"inf285\"><mrow><msup><mrow><mn>60</mn></mrow><mo>\u2218</mo></msup></mrow></math>, we can restrict <math id=\"inf286\"><mi>\u03b1</mi></math> to be in the range <math id=\"inf287\"><mrow><mo>\u2212</mo><msup><mrow><mn>30</mn></mrow><mo>\u2218</mo></msup><mo>\u2264</mo><mi>\u03b1</mi><mo>\u2264</mo><msup><mrow><mn>30</mn></mrow><mo>\u2218</mo></msup></mrow></math>. The grid alignment, which is the minimal angle of the grid with the box boundaries is given by"
                                    }, 
                                    {
                                        "type": "mathml", 
                                        "id": "equ45", 
                                        "label": "(36)", 
                                        "mathml": "<math><mrow><mtext>Grid</mtext><mtext>\u2009</mtext><mtext>aligment</mtext><mo>=</mo><mi>min</mi><mrow><mo>(</mo><mrow><mrow><mo>|</mo><mi>\u03b1</mi><mo>|</mo></mrow><mo>,</mo><mn>9</mn><msup><mn>0</mn><mo>\u2218</mo></msup><mo>\u2212</mo><mrow><mo>(</mo><mrow><mrow><mo>|</mo><mi>\u03b1</mi><mo>|</mo></mrow><mo>+</mo><msup><mrow><mn>60</mn></mrow><mo>\u2218</mo></msup></mrow><mo>)</mo></mrow></mrow><mo>)</mo></mrow><mo>=</mo><mi>min</mi><mrow><mo>(</mo><mrow><mrow><mo>|</mo><mi>\u03b1</mi><mo>|</mo></mrow><mo>,</mo><msup><mrow><mn>30</mn></mrow><mo>\u2218</mo></msup><mo>\u2212</mo><mrow><mo>|</mo><mi>\u03b1</mi><mo>|</mo></mrow></mrow><mo>)</mo></mrow></mrow></math>"
                                    }, 
                                    {
                                        "type": "paragraph", 
                                        "text": "which is limited to the range <math id=\"inf288\"><mrow><mrow><mo>[</mo><mrow><msup><mn>0</mn><mo>\u2218</mo></msup><mo>,</mo><msup><mrow><mn>15</mn></mrow><mo>\u2218</mo></msup></mrow><mo>]</mo></mrow></mrow></math>, since <math id=\"inf289\"><mrow><mo>\u2212</mo><msup><mrow><mn>30</mn></mrow><mo>\u2218</mo></msup><mo>\u2264</mo><mi>\u03b1</mi><mo>\u2264</mo><msup><mrow><mn>30</mn></mrow><mo>\u2218</mo></msup></mrow></math>. There are usually several possible grid alignments which are (approximately) rotated versions of each other (i.e., different <math id=\"inf290\"><mi>\u03b1</mi></math>). Note that, due to the <math id=\"inf291\"><mi>k</mi></math>-lattice discretization, different alignments can result in slightly different objective values. However, the numerical algorithms we used to solve the optimization problem reached many possible grid alignments with a positive probability (<a href=\"#fig12\">Figure 12C</a>), since we started from a random initialization and converged to a local minimum."
                                    }, 
                                    {
                                        "type": "paragraph", 
                                        "text": "In the limit <math id=\"inf292\"><mrow><mi>L</mi><mo>\u2192</mo><mi>\u221e</mi></mrow></math>, the grid alignment will become uniform in the range <math id=\"inf293\"><mrow><mrow><mo>[</mo><mrow><msup><mn>0</mn><mo>\u2218</mo></msup><mo>,</mo><msup><mrow><mn>15</mn></mrow><mo>\u2218</mo></msup></mrow><mo>]</mo></mrow></mrow></math>, and the average grid alignment is <math id=\"inf294\"><mrow><msup><mrow><mn>7.5</mn></mrow><mo>\u2218</mo></msup></mrow></math>."
                                    }
                                ]
                            }, 
                            {
                                "type": "section", 
                                "id": "s4-15-3", 
                                "title": "Hierarchical networks and modules", 
                                "content": [
                                    {
                                        "type": "paragraph", 
                                        "text": "There are multiple routes to generalize non-negative PCA with multiple vectors. In this paper we chose to do so using a 'Gramm-Schmidt' like process, which can be written in the following way. First we define,"
                                    }, 
                                    {
                                        "type": "mathml", 
                                        "id": "equ46", 
                                        "label": "(37)", 
                                        "mathml": "<math><mtable columnalign=\"left\"><mtr><mtd><msub><mi>r</mi><mn>1</mn></msub><mrow><mo>(</mo><mtext mathvariant=\"bold\">x</mtext><mo mathvariant=\"bold\">,</mo><mtext mathvariant=\"bold\">y</mtext><mo>)</mo></mrow><mo>=</mo><mi>r</mi><mrow><mo>(</mo><mtext mathvariant=\"bold\">x</mtext><mo mathvariant=\"bold\">\u2212</mo><mtext mathvariant=\"bold\">y</mtext><mo>)</mo></mrow><mo>=</mo><msub><mi>c</mi><mn>1</mn></msub><mo>\u00a0</mo><mi>exp</mi><mrow><mo>(</mo><mo>\u2212</mo><mfrac><msup><mrow><mo>\u2016</mo><mtext mathvariant=\"bold\">x</mtext><mo mathvariant=\"bold\">\u2212</mo><mtext mathvariant=\"bold\">y</mtext><mo>\u2016</mo></mrow><mn>2</mn></msup><mrow><mn>2</mn><msubsup><mi>\u03c3</mi><mn>1</mn><mn>2</mn></msubsup></mrow></mfrac><mo>)</mo></mrow><mo>\u2212</mo><msub><mi>c</mi><mn>2</mn></msub><mo>\u00a0</mo><mi>exp</mi><mrow><mo>(</mo><mo>\u2212</mo><mfrac><msup><mrow><mo>\u2016</mo><mtext mathvariant=\"bold\">x</mtext><mo mathvariant=\"bold\">\u2212</mo><mtext mathvariant=\"bold\">y</mtext><mo>\u2016</mo></mrow><mn>2</mn></msup><mrow><mn>2</mn><msubsup><mi>\u03c3</mi><mn>2</mn><mn>2</mn></msubsup></mrow></mfrac><mo>)</mo></mrow></mtd></mtr><mtr><mtd><msub><mi>J</mi><mn>0</mn></msub><mrow><mo>(</mo><mtext mathvariant=\"bold\">x</mtext><mo>)</mo></mrow><mo>=</mo><mn>0</mn><mo>,</mo></mtd></mtr></mtable><mo>,</mo></math>"
                                    }, 
                                    {
                                        "type": "paragraph", 
                                        "text": "and then, recursively, this process recovers non-negative 'eigenvectors' by subtracting out the previous components, similarly to Sanger\u2019s multiple PCA algorithm (<a href=\"#bib31\">Sanger, 1989</a>), and enforcing the non-negativity constraint."
                                    }, 
                                    {
                                        "type": "mathml", 
                                        "id": "equ47", 
                                        "label": "(38)", 
                                        "mathml": "<math><msub><mi>r</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>(</mo><mtext mathvariant=\"bold\">x</mtext><mtext>,</mtext><mtext mathvariant=\"bold\">y</mtext><mo>)</mo><mo>=</mo><msub><mi>r</mi><mi>n</mi></msub><mo>(</mo><mtext mathvariant=\"bold\">x</mtext><mtext>,</mtext><mtext mathvariant=\"bold\">y</mtext><mo>)</mo><mo>-</mo><msub><mo>\u222b</mo><mi>s</mi></msub><msub><mi>r</mi><mi>n</mi></msub><mo>(</mo><mtext mathvariant=\"bold\">x</mtext><mtext>,</mtext><mtext mathvariant=\"bold\">z</mtext><mo>)</mo><msub><mi>J</mi><mi>n</mi></msub><mo>(</mo><mtext mathvariant=\"bold\">z</mtext><mo>)</mo><msub><mi>J</mi><mi>n</mi></msub><mo>(</mo><mtext mathvariant=\"bold\">y</mtext><mo>)</mo><mi>d</mi><mtext mathvariant=\"bold\">z</mtext><mspace linebreak=\"newline\"></mspace><msub><mi>J</mi><mi>n</mi></msub><mo>(</mo><mtext mathvariant=\"bold\">y</mtext><mo>)</mo><mo>=</mo><mi>arg</mi><mo>\u00a0</mo><msub><mi>max</mi><mrow><mi>J</mi><mo>(</mo><mtext mathvariant=\"bold\">x</mtext><mo>)</mo><mo>\u2265</mo><mn>0</mn><mo>,</mo><mfrac><mn>1</mn><mfenced close=\"|\" open=\"|\"><mi>S</mi></mfenced></mfrac><msub><mo>\u222b</mo><mi>s</mi></msub><msup><mi>J</mi><mn>2</mn></msup><mo>(</mo><mtext mathvariant=\"bold\">x</mtext><mo>)</mo><mi>d</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mn>1</mn></mrow></msub><msub><mo>\u222b</mo><mi>s</mi></msub><mi>d</mi><mtext mathvariant=\"bold\">x</mtext><msup><mfenced><mrow><msub><mo>\u222b</mo><mi>s</mi></msub><msub><mi>r</mi><mi>n</mi></msub><mo>(</mo><mtext mathvariant=\"bold\">x</mtext><mtext>,</mtext><mtext mathvariant=\"bold\">y</mtext><mo>)</mo><mi>J</mi><mo>(</mo><mtext mathvariant=\"bold\">y</mtext><mo>)</mo><mi>d</mi><mtext mathvariant=\"bold\">y</mtext></mrow></mfenced><mn>2</mn></msup><mtext>.</mtext></math>"
                                    }, 
                                    {
                                        "type": "paragraph", 
                                        "text": "To analyze this, we write the objectives we maximize in the Fourier domain, using Parseval\u2019s Theorem."
                                    }, 
                                    {
                                        "type": "paragraph", 
                                        "text": "For <i>n</i> =1, we recover the old objective (<a href=\"#equ26\">Equation 24</a>):"
                                    }, 
                                    {
                                        "type": "mathml", 
                                        "id": "equ48", 
                                        "label": "(39)", 
                                        "mathml": "<math><munder><mo>\u2211</mo><mstyle mathvariant=\"bold\"><mi>k</mi><mo mathvariant=\"normal\">\u2208</mo><mover><mi mathvariant=\"italic\">S</mi><mo mathvariant=\"italic\">^</mo></mover></mstyle></munder><msup><mfenced close=\"|\" open=\"|\"><mrow><mover><mi>r</mi><mo>^</mo></mover><mrow><mo>(</mo><mtext mathvariant=\"bold\">k</mtext><mo>)</mo></mrow><mover><mi>J</mi><mo>^</mo></mover><mrow><mo>(</mo><mtext mathvariant=\"bold\">k</mtext><mo>)</mo></mrow></mrow></mfenced><mn>2</mn></msup><mo>.</mo></math>"
                                    }, 
                                    {
                                        "type": "paragraph", 
                                        "text": "For <i>n</i> =2, we get"
                                    }, 
                                    {
                                        "type": "mathml", 
                                        "id": "equ49", 
                                        "label": "(40)", 
                                        "mathml": "<math><munder><mo>\u2211</mo><mstyle mathvariant=\"bold\"><mi>k</mi><mo mathvariant=\"normal\">\u2208</mo><mover><mi mathvariant=\"italic\">S</mi><mo mathvariant=\"italic\">^</mo></mover></mstyle></munder><msup><mrow><mo>|</mo><mover><mi>r</mi><mo>^</mo></mover><mrow><mo>(</mo><mtext mathvariant=\"bold\">k</mtext><mo>)</mo></mrow><mrow><mo>(</mo><mover><mi>J</mi><mo>^</mo></mover><mrow><mo>(</mo><mtext mathvariant=\"bold\">k</mtext><mo>)</mo></mrow><mo>\u2212</mo><msub><mover><mi>J</mi><mo>^</mo></mover><mn>1</mn></msub><mrow><mo>(</mo><mtext mathvariant=\"bold\">k</mtext><mo>)</mo></mrow><mrow><mo>(</mo><munder><mo>\u2211</mo><mstyle mathvariant=\"bold\"><mi>q</mi><mo mathvariant=\"normal\">\u2208</mo><mover><mi mathvariant=\"italic\">S</mi><mo mathvariant=\"italic\">^</mo></mover></mstyle></munder><msubsup><mover><mi>J</mi><mo>^</mo></mover><mn>1</mn><mo>*</mo></msubsup><mrow><mo>(</mo><mtext mathvariant=\"bold\">q</mtext><mo>)</mo></mrow><mover><mi>J</mi><mo>^</mo></mover><mrow><mo>(</mo><mtext mathvariant=\"bold\">q</mtext><mo>)</mo></mrow><mo>)</mo></mrow><mo>)</mo></mrow><mo>|</mo></mrow><mn>2</mn></msup><mo>,</mo></math>"
                                    }, 
                                    {
                                        "type": "paragraph", 
                                        "text": "where <math id=\"inf295\"><msup><mover><mi>J</mi><mo>^</mo></mover><mo>*</mo></msup></math>\u00a0is the complex conjugate of <math id=\"inf296\"><mover><mi>J</mi><mo>^</mo></mover></math>. This objective is similar to the original one, except that it penalizes <math id=\"inf297\"><mrow><mover accent=\"true\"><mi>J</mi><mo>^</mo></mover><mrow><mo>(</mo><mstyle mathvariant=\"bold\"><mi>k</mi></mstyle><mo>)</mo></mrow></mrow></math> if its components are similar to those of <math id=\"inf298\"><mrow><msub><mover accent=\"true\"><mi>J</mi><mo>^</mo></mover><mn>1</mn></msub><mrow><mo>(</mo><mstyle mathvariant=\"bold\"><mi>k</mi></mstyle><mo>)</mo></mrow></mrow></math>. As <i>n</i> increases the objective becomes more and more complicated, but as before, it contains terms which penalize <math id=\"inf299\"><mrow><msub><mover accent=\"true\"><mi>J</mi><mo>^</mo></mover><mi>n</mi></msub><mrow><mo>(</mo><mstyle mathvariant=\"bold\"><mi>k</mi></mstyle><mo>)</mo></mrow></mrow></math> if its components are similar to any of the previous solutions (<i>i.e.</i>, <math id=\"inf300\"><mrow><msub><mover accent=\"true\"><mi>J</mi><mo>^</mo></mover><mi>m</mi></msub><mrow><mo>(</mo><mstyle mathvariant=\"bold\"><mi>k</mi></mstyle><mo>)</mo></mrow></mrow></math> for <math id=\"inf301\"><mrow><mi>m</mi><mo>&lt;</mo><mi>n</mi></mrow></math>). This form suggests that each new 'eigenvector' tends to occupy new points in the Fourier lattice (similarly to unconstrained PCA solutions)."
                                    }, 
                                    {
                                        "type": "paragraph", 
                                        "text": "For example, the numerical solution shown in <a href=\"#fig16\">Figure 16B</a> is composed of the Fourier lattice components in group A, defined in <a href=\"#fig17\">Figure 17</a>. A completely equivalent solution would be in group B (it is just a 90 degrees rotation of the first). The next 'eigenvectors' should then include other Fourier-lattice components outside groups A and B. Note that components with smaller <math id=\"inf302\"><mi>k</mi></math>-radius cannot be arranged to be hexagonal (not even approximately), so they will have a low gridness score. In contrast, the next components with higher <math id=\"inf303\"><mi>k</mi></math>-radius (e.g., group C) can form an approximately hexagonal shape together, and would appear as an additional grid cell 'module'. The grid spacing of this new module will decrease by <math id=\"inf304\"><mrow><msqrt><mn>2</mn></msqrt></mrow></math>, since the new <math id=\"inf305\"><mi>k</mi></math>-radius is about <math id=\"inf306\"><mrow><msqrt><mn>2</mn></msqrt></mrow></math> times larger than the <math id=\"inf307\"><mi>k</mi></math>-radius of groups A and B."
                                    }
                                ]
                            }
                        ]
                    }
                ]
            }
        ], 
        "references": [
            {
                "type": "journal", 
                "id": "bib1", 
                "date": "2007", 
                "authors": [
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "C Barry", 
                            "index": "Barry, C"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "R Hayman", 
                            "index": "Hayman, R"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "N Burgess", 
                            "index": "Burgess, N"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "KJ Jeffery", 
                            "index": "Jeffery, KJ"
                        }
                    }
                ], 
                "articleTitle": "Experience-dependent rescaling of entorhinal grids", 
                "journal": "Nature Neuroscience", 
                "volume": "10", 
                "pages": {
                    "first": "682", 
                    "last": "684", 
                    "range": "682\u2013684"
                }, 
                "doi": "10.1038/nn1905"
            }, 
            {
                "type": "journal", 
                "id": "bib2", 
                "date": "2009", 
                "authors": [
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "A Beck", 
                            "index": "Beck, A"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "M Teboulle", 
                            "index": "Teboulle, M"
                        }
                    }
                ], 
                "articleTitle": "A fast iterative shrinkage-thresholding algorithm for linear inverse problems", 
                "journal": "SIAM Journal on Imaging Sciences", 
                "volume": "2", 
                "pages": {
                    "first": "183", 
                    "last": "202", 
                    "range": "183\u2013202"
                }, 
                "doi": "10.1137/080716542"
            }, 
            {
                "type": "journal", 
                "id": "bib3", 
                "date": "2010", 
                "authors": [
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "CN Boccara", 
                            "index": "Boccara, CN"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "F Sargolini", 
                            "index": "Sargolini, F"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "VH Thoresen", 
                            "index": "Thoresen, VH"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "T Solstad", 
                            "index": "Solstad, T"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "MP Witter", 
                            "index": "Witter, MP"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "EI Moser", 
                            "index": "Moser, EI"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "MB Moser", 
                            "index": "Moser, MB"
                        }
                    }
                ], 
                "articleTitle": "Grid cells in pre- and parasubiculum", 
                "journal": "Nature Neuroscience", 
                "volume": "13", 
                "pages": {
                    "first": "987", 
                    "last": "994", 
                    "range": "987\u2013994"
                }, 
                "doi": "10.1038/nn.2602"
            }, 
            {
                "type": "journal", 
                "id": "bib4", 
                "date": "2013", 
                "authors": [
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "T Bonnevie", 
                            "index": "Bonnevie, T"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "B Dunn", 
                            "index": "Dunn, B"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "M Fyhn", 
                            "index": "Fyhn, M"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "T Hafting", 
                            "index": "Hafting, T"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "D Derdikman", 
                            "index": "Derdikman, D"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "JL Kubie", 
                            "index": "Kubie, JL"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "Y Roudi", 
                            "index": "Roudi, Y"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "EI Moser", 
                            "index": "Moser, EI"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "MB Moser", 
                            "index": "Moser, MB"
                        }
                    }
                ], 
                "articleTitle": "Grid cells require excitatory drive from the hippocampus", 
                "journal": "Nature Neuroscience", 
                "volume": "16", 
                "pages": {
                    "first": "309", 
                    "last": "317", 
                    "range": "309\u2013317"
                }, 
                "doi": "10.1038/nn.3311"
            }, 
            {
                "type": "journal", 
                "id": "bib5", 
                "date": "2014", 
                "authors": [
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "N Burgess", 
                            "index": "Burgess, N"
                        }
                    }
                ], 
                "articleTitle": "The 2014 Nobel Prize in Physiology or Medicine: a spatial model for cognitive neuroscience", 
                "journal": "Neuron", 
                "volume": "84", 
                "pages": {
                    "first": "1120", 
                    "last": "1125", 
                    "range": "1120\u20131125"
                }, 
                "doi": "10.1016/j.neuron.2014.12.009"
            }, 
            {
                "type": "journal", 
                "id": "bib6", 
                "date": "2014", 
                "authors": [
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "L Castro", 
                            "index": "Castro, L"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "P Aguiar", 
                            "index": "Aguiar, P"
                        }
                    }
                ], 
                "articleTitle": "A feedforward model for the formation of a grid field where spatial information is provided solely from place cells", 
                "journal": "Biological Cybernetics", 
                "volume": "108", 
                "pages": {
                    "first": "133", 
                    "last": "143", 
                    "range": "133\u2013143"
                }, 
                "doi": "10.1007/s00422-013-0581-3"
            }, 
            {
                "type": "journal", 
                "id": "bib7", 
                "date": "2013", 
                "authors": [
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "JJ Couey", 
                            "index": "Couey, JJ"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "A Witoelar", 
                            "index": "Witoelar, A"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "SJ Zhang", 
                            "index": "Zhang, SJ"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "K Zheng", 
                            "index": "Zheng, K"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "J Ye", 
                            "index": "Ye, J"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "B Dunn", 
                            "index": "Dunn, B"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "R Czajkowski", 
                            "index": "Czajkowski, R"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "MB Moser", 
                            "index": "Moser, MB"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "EI Moser", 
                            "index": "Moser, EI"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "Y Roudi", 
                            "index": "Roudi, Y"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "MP Witter", 
                            "index": "Witter, MP"
                        }
                    }
                ], 
                "articleTitle": "Recurrent inhibitory circuitry as a mechanism for grid formation", 
                "journal": "Nature Neuroscience", 
                "volume": "16", 
                "pages": {
                    "first": "318", 
                    "last": "324", 
                    "range": "318\u2013324"
                }, 
                "doi": "10.1038/nn.3310"
            }, 
            {
                "type": "journal", 
                "id": "bib8", 
                "date": "2009", 
                "authors": [
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "H Dai", 
                            "index": "Dai, H"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "Z Geary", 
                            "index": "Geary, Z"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "LP Kadanoff", 
                            "index": "Kadanoff, LP"
                        }
                    }
                ], 
                "articleTitle": "Asymptotics of eigenvalues and eigenvectors of Toeplitz matrices", 
                "journal": "Journal of Statistical Mechanics: Theory and Experiment", 
                "volume": "2009", 
                "pages": "P05012", 
                "doi": "10.1088/1742-5468/2009/05/P05012"
            }, 
            {
                "type": "journal", 
                "id": "bib9", 
                "date": "2003", 
                "authors": [
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "D Derdikman", 
                            "index": "Derdikman, D"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "R Hildesheim", 
                            "index": "Hildesheim, R"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "E Ahissar", 
                            "index": "Ahissar, E"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "A Arieli", 
                            "index": "Arieli, A"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "A Grinvald", 
                            "index": "Grinvald, A"
                        }
                    }
                ], 
                "articleTitle": "Imaging spatiotemporal dynamics of surround inhibition in the barrels somatosensory cortex", 
                "journal": "Journal of Neuroscience", 
                "volume": "23", 
                "pages": {
                    "first": "3100", 
                    "last": "3105", 
                    "range": "3100\u20133105"
                }
            }, 
            {
                "type": "book", 
                "id": "bib10", 
                "date": "2014", 
                "authors": [
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "D Derdikman", 
                            "index": "Derdikman, D"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "JJ Knierim", 
                            "index": "Knierim, JJ"
                        }
                    }
                ], 
                "bookTitle": "Space,Time and Memory in the Hippocampal Formation", 
                "publisher": {
                    "name": [
                        "Springer Vienna"
                    ], 
                    "address": {
                        "formatted": [
                            "Vienna"
                        ], 
                        "components": {
                            "locality": [
                                "Vienna"
                            ]
                        }
                    }
                }, 
                "doi": "10.1007/978-3-7091-1292-2"
            }, 
            {
                "type": "journal", 
                "id": "bib11", 
                "date": "2015", 
                "authors": [
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "H Eichenbaum", 
                            "index": "Eichenbaum, H"
                        }
                    }
                ], 
                "articleTitle": "Perspectives on 2014 nobel prize", 
                "journal": "Hippocampus", 
                "volume": "25", 
                "pages": {
                    "first": "679", 
                    "last": "681", 
                    "range": "679\u2013681"
                }, 
                "doi": "10.1002/hipo.22445"
            }, 
            {
                "type": "journal", 
                "id": "bib12", 
                "date": "1966", 
                "authors": [
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "C Enroth-Cugell", 
                            "index": "Enroth-Cugell, C"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "JG Robson", 
                            "index": "Robson, JG"
                        }
                    }
                ], 
                "articleTitle": "The contrast sensitivity of retinal ganglion cells of the cat", 
                "journal": "The Journal of Physiology", 
                "volume": "187", 
                "pages": {
                    "first": "517", 
                    "last": "552", 
                    "range": "517\u2013552"
                }
            }, 
            {
                "type": "journal", 
                "id": "bib13", 
                "date": "2007", 
                "authors": [
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "M Franzius", 
                            "index": "Franzius, M"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "H Sprekeler", 
                            "index": "Sprekeler, H"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "L Wiskott", 
                            "index": "Wiskott, L"
                        }
                    }
                ], 
                "articleTitle": "Slowness and sparseness lead to place, head-direction, and spatial-view cells", 
                "journal": "PLoS Computational Biology", 
                "volume": "3", 
                "pages": "e166", 
                "doi": "10.1371/journal.pcbi.0030166"
            }, 
            {
                "type": "journal", 
                "id": "bib14", 
                "date": "1996", 
                "authors": [
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "TF Freund", 
                            "index": "Freund, TF"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "G Buzs\u00e1ki", 
                            "index": "Buzs\u00e1ki, G"
                        }
                    }
                ], 
                "articleTitle": "Interneurons of the hippocampus", 
                "journal": "Hippocampus", 
                "volume": "6", 
                "pages": {
                    "first": "347", 
                    "last": "470", 
                    "range": "347\u2013470"
                }, 
                "doi": "10.1002/(SICI)1098-1063(1996)6:4&amp;lt;347::AID-HIPO1&amp;gt;3.0.CO;2-I"
            }, 
            {
                "type": "journal", 
                "id": "bib15", 
                "date": "2011", 
                "authors": [
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "LM Giocomo", 
                            "index": "Giocomo, LM"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "MB Moser", 
                            "index": "Moser, MB"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "EI Moser", 
                            "index": "Moser, EI"
                        }
                    }
                ], 
                "articleTitle": "Computational models of grid cells", 
                "journal": "Neuron", 
                "volume": "71", 
                "pages": {
                    "first": "589", 
                    "last": "603", 
                    "range": "589\u2013603"
                }, 
                "doi": "10.1016/j.neuron.2011.07.023"
            }, 
            {
                "type": "journal", 
                "id": "bib16", 
                "date": "2006", 
                "authors": [
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "RM Gray", 
                            "index": "Gray, RM"
                        }
                    }
                ], 
                "articleTitle": "Toeplitz and circulant matrices: A review", 
                "journal": "Now Publishers Inc", 
                "volume": "2", 
                "pages": {
                    "first": "155", 
                    "last": "239", 
                    "range": "155\u2013239"
                }
            }, 
            {
                "type": "journal", 
                "id": "bib17", 
                "date": "2005", 
                "authors": [
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "T Hafting", 
                            "index": "Hafting, T"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "M Fyhn", 
                            "index": "Fyhn, M"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "S Molden", 
                            "index": "Molden, S"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "MB Moser", 
                            "index": "Moser, MB"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "EI Moser", 
                            "index": "Moser, EI"
                        }
                    }
                ], 
                "articleTitle": "Microstructure of a spatial map in the entorhinal cortex", 
                "journal": "Nature", 
                "volume": "436", 
                "pages": {
                    "first": "801", 
                    "last": "806", 
                    "range": "801\u2013806"
                }, 
                "doi": "10.1038/nature03721"
            }, 
            {
                "type": "journal", 
                "id": "bib18", 
                "date": "1992", 
                "authors": [
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "K Hornik", 
                            "index": "Hornik, K"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "C-M Kuan", 
                            "index": "Kuan, C-M"
                        }
                    }
                ], 
                "articleTitle": "Convergence analysis of local feature extraction algorithms", 
                "journal": "Neural Networks", 
                "volume": "5", 
                "pages": {
                    "first": "229", 
                    "last": "240", 
                    "range": "229\u2013240"
                }, 
                "doi": "10.1016/S0893-6080(05)80022-X"
            }, 
            {
                "type": "unknown", 
                "id": "bib19", 
                "date": "2002", 
                "authors": [
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "I Jolliffe", 
                            "index": "Jolliffe, I"
                        }
                    }
                ], 
                "title": "Principal component analysis", 
                "details": "Wiley Online Library, 10.1002/0470013192.bsa501"
            }, 
            {
                "type": "journal", 
                "id": "bib20", 
                "date": "2008", 
                "authors": [
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "KB Kjelstrup", 
                            "index": "Kjelstrup, KB"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "T Solstad", 
                            "index": "Solstad, T"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "VH Brun", 
                            "index": "Brun, VH"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "T Hafting", 
                            "index": "Hafting, T"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "S Leutgeb", 
                            "index": "Leutgeb, S"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "MP Witter", 
                            "index": "Witter, MP"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "EI Moser", 
                            "index": "Moser, EI"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "MB Moser", 
                            "index": "Moser, MB"
                        }
                    }
                ], 
                "articleTitle": "Finite scale of spatial representation in the hippocampus", 
                "journal": "Science", 
                "volume": "321", 
                "pages": {
                    "first": "140", 
                    "last": "143", 
                    "range": "140\u2013143"
                }, 
                "doi": "10.1126/science.1157086"
            }, 
            {
                "type": "journal", 
                "id": "bib21", 
                "date": "2008", 
                "authors": [
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "E Kropff", 
                            "index": "Kropff, E"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "A Treves", 
                            "index": "Treves, A"
                        }
                    }
                ], 
                "articleTitle": "The emergence of grid cells: Intelligent design or just adaptation?", 
                "journal": "Hippocampus", 
                "volume": "18", 
                "pages": {
                    "first": "1256", 
                    "last": "1269", 
                    "range": "1256\u20131269"
                }, 
                "doi": "10.1002/hipo.20520"
            }, 
            {
                "type": "unknown", 
                "id": "bib22", 
                "date": "1978", 
                "authors": [
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "HJ Kushner", 
                            "index": "Kushner, HJ"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "DS Clark", 
                            "index": "Clark, DS"
                        }
                    }
                ], 
                "title": "Applied Mathematical Sciences, Vol. 26", 
                "details": "Stochastic Approximation Methods for Constrained and Unconstrained Systems, Applied Mathematical Sciences, Vol. 26, New York, NY, Springer New York, 10.1007/978-1-4684-9352-8"
            }, 
            {
                "type": "journal", 
                "id": "bib23", 
                "date": "2010", 
                "authors": [
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "RF Langston", 
                            "index": "Langston, RF"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "JA Ainge", 
                            "index": "Ainge, JA"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "JJ Couey", 
                            "index": "Couey, JJ"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "CB Canto", 
                            "index": "Canto, CB"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "TL Bjerknes", 
                            "index": "Bjerknes, TL"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "MP Witter", 
                            "index": "Witter, MP"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "EI Moser", 
                            "index": "Moser, EI"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "MB Moser", 
                            "index": "Moser, MB"
                        }
                    }
                ], 
                "articleTitle": "Development of the spatial representation system in the rat", 
                "journal": "Science", 
                "volume": "328", 
                "pages": {
                    "first": "1576", 
                    "last": "1580", 
                    "range": "1576\u20131580"
                }, 
                "doi": "10.1126/science.1188210"
            }, 
            {
                "type": "journal", 
                "id": "bib24", 
                "date": "2015", 
                "authors": [
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "A Mathis", 
                            "index": "Mathis, A"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "MB Stemmler", 
                            "index": "Stemmler, MB"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "AVM Herz", 
                            "index": "Herz, AVM"
                        }
                    }
                ], 
                "articleTitle": "Probable nature of higher-dimensional symmetries underlying mammalian grid-cell activity patterns", 
                "journal": "eLife", 
                "volume": "4", 
                "pages": "e05979", 
                "doi": "10.7554/eLife.05979"
            }, 
            {
                "type": "journal", 
                "id": "bib25", 
                "date": "1980", 
                "authors": [
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "M-L Mittelstaedt", 
                            "index": "Mittelstaedt, M-L"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "H Mittelstaedt", 
                            "index": "Mittelstaedt, H"
                        }
                    }
                ], 
                "articleTitle": "Homing by path integration in a mammal", 
                "journal": "Naturwissenschaften", 
                "volume": "67", 
                "pages": {
                    "first": "566", 
                    "last": "567", 
                    "range": "566\u2013567"
                }, 
                "doi": "10.1007/BF00450672"
            }, 
            {
                "type": "web", 
                "id": "bib26", 
                "date": "2014", 
                "authors": [
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "A Montanari", 
                            "index": "Montanari, A"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "E Richard", 
                            "index": "Richard, E"
                        }
                    }
                ], 
                "title": "Non-negative principal component analysis: Message passing algorithms and sharp asymptotics", 
                "uri": "http://arxiv.org/abs/1406.4775"
            }, 
            {
                "type": "unknown", 
                "id": "bib27", 
                "date": "2015", 
                "authors": [
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "RG Morris", 
                            "index": "Morris, RG"
                        }
                    }
                ], 
                "title": "The mantle of the heavens: Reflections on the 2014 Nobel Prize for medicine or physiology", 
                "details": "Hippocampus, 25, 10.1002/hipo.22455"
            }, 
            {
                "type": "journal", 
                "id": "bib28", 
                "date": "1971", 
                "authors": [
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "J O'Keefe", 
                            "index": "O'Keefe, J"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "J Dostrovsky", 
                            "index": "Dostrovsky, J"
                        }
                    }
                ], 
                "articleTitle": "The hippocampus as a spatial map. Preliminary evidence from unit activity in the freely-moving rat", 
                "journal": "Brain Research", 
                "volume": "34", 
                "pages": {
                    "first": "171", 
                    "last": "175", 
                    "range": "171\u2013175"
                }
            }, 
            {
                "type": "unknown", 
                "id": "bib29", 
                "date": "1978", 
                "authors": [
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "J O'Keefe", 
                            "index": "O'Keefe, J"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "L Nadel", 
                            "index": "Nadel, L"
                        }
                    }
                ], 
                "title": "The hippocampus as a cognitive map, Oxford, Oxford University Press", 
                "details": "The hippocampus as a cognitive map, Oxford, Oxford University Press"
            }, 
            {
                "type": "journal", 
                "id": "bib30", 
                "date": "1982", 
                "authors": [
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "E Oja", 
                            "index": "Oja, E"
                        }
                    }
                ], 
                "articleTitle": "A simplified neuron model as a principal component analyzer", 
                "journal": "Journal of Mathematical Biology", 
                "volume": "15", 
                "pages": {
                    "first": "267", 
                    "last": "273", 
                    "range": "267\u2013273"
                }
            }, 
            {
                "type": "journal", 
                "id": "bib31", 
                "date": "1989", 
                "authors": [
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "TD Sanger", 
                            "index": "Sanger, TD"
                        }
                    }
                ], 
                "articleTitle": "Optimal unsupervised learning in a single-layer linear feedforward neural network", 
                "journal": "Neural Networks", 
                "volume": "2", 
                "pages": {
                    "first": "459", 
                    "last": "473", 
                    "range": "459\u2013473"
                }, 
                "doi": "10.1016/0893-6080(89)90044-0"
            }, 
            {
                "type": "journal", 
                "id": "bib32", 
                "date": "2006", 
                "authors": [
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "F Sargolini", 
                            "index": "Sargolini, F"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "M Fyhn", 
                            "index": "Fyhn, M"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "T Hafting", 
                            "index": "Hafting, T"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "BL McNaughton", 
                            "index": "McNaughton, BL"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "MP Witter", 
                            "index": "Witter, MP"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "MB Moser", 
                            "index": "Moser, MB"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "EI Moser", 
                            "index": "Moser, EI"
                        }
                    }
                ], 
                "articleTitle": "Conjunctive representation of position, direction, and velocity in entorhinal cortex", 
                "journal": "Science", 
                "volume": "312", 
                "pages": {
                    "first": "758", 
                    "last": "762", 
                    "range": "758\u2013762"
                }, 
                "doi": "10.1126/science.1125572"
            }, 
            {
                "type": "journal", 
                "id": "bib33", 
                "date": "2008", 
                "authors": [
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "F Savelli", 
                            "index": "Savelli, F"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "D Yoganarasimha", 
                            "index": "Yoganarasimha, D"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "JJ Knierim", 
                            "index": "Knierim, JJ"
                        }
                    }
                ], 
                "articleTitle": "Influence of boundary removal on the spatial representations of the medial entorhinal cortex", 
                "journal": "Hippocampus", 
                "volume": "18", 
                "pages": {
                    "first": "1270", 
                    "last": "1282", 
                    "range": "1270\u20131282"
                }, 
                "doi": "10.1002/hipo.20511"
            }, 
            {
                "type": "journal", 
                "id": "bib34", 
                "date": "2013", 
                "authors": [
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "B Si", 
                            "index": "Si, B"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "A Treves", 
                            "index": "Treves, A"
                        }
                    }
                ], 
                "articleTitle": "A model for the differentiation between grid and conjunctive units in medial entorhinal cortex", 
                "journal": "Hippocampus", 
                "volume": "23", 
                "pages": {
                    "first": "1410", 
                    "last": "1424", 
                    "range": "1410\u20131424"
                }, 
                "doi": "10.1002/hipo.22194"
            }, 
            {
                "type": "journal", 
                "id": "bib35", 
                "date": "2008", 
                "authors": [
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "T Solstad", 
                            "index": "Solstad, T"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "CN Boccara", 
                            "index": "Boccara, CN"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "E Kropff", 
                            "index": "Kropff, E"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "MB Moser", 
                            "index": "Moser, MB"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "EI Moser", 
                            "index": "Moser, EI"
                        }
                    }
                ], 
                "articleTitle": "Representation of geometric borders in the entorhinal cortex", 
                "journal": "Science", 
                "volume": "322", 
                "pages": {
                    "first": "1865", 
                    "last": "1868", 
                    "range": "1865\u20131868"
                }, 
                "doi": "10.1126/science.1166466"
            }, 
            {
                "type": "journal", 
                "id": "bib36", 
                "date": "2014", 
                "authors": [
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "KL Stachenfeld", 
                            "index": "Stachenfeld, KL"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "M Botvinick", 
                            "index": "Botvinick, M"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "SJ Gershman", 
                            "index": "Gershman, SJ"
                        }
                    }
                ], 
                "articleTitle": "Design Principles of the Hippocampal Cognitive Map", 
                "journal": "NIPS Proceedings", 
                "pages": {
                    "first": "2528", 
                    "last": "2536", 
                    "range": "2528\u20132536"
                }
            }, 
            {
                "type": "journal", 
                "id": "bib37", 
                "date": "2012", 
                "authors": [
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "H Stensola", 
                            "index": "Stensola, H"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "T Stensola", 
                            "index": "Stensola, T"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "T Solstad", 
                            "index": "Solstad, T"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "K Fr\u00f8land", 
                            "index": "Fr\u00f8land, K"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "MB Moser", 
                            "index": "Moser, MB"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "EI Moser", 
                            "index": "Moser, EI"
                        }
                    }
                ], 
                "articleTitle": "The entorhinal grid map is discretized", 
                "journal": "Nature", 
                "volume": "492", 
                "pages": {
                    "first": "72", 
                    "last": "78", 
                    "range": "72\u201378"
                }, 
                "doi": "10.1038/nature11649"
            }, 
            {
                "type": "journal", 
                "id": "bib38", 
                "date": "2015", 
                "authors": [
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "T Stensola", 
                            "index": "Stensola, T"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "H Stensola", 
                            "index": "Stensola, H"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "MB Moser", 
                            "index": "Moser, MB"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "EI Moser", 
                            "index": "Moser, EI"
                        }
                    }
                ], 
                "articleTitle": "Shearing-induced asymmetry in entorhinal grid cells", 
                "journal": "Nature", 
                "volume": "518", 
                "pages": {
                    "first": "207", 
                    "last": "212", 
                    "range": "207\u2013212"
                }, 
                "doi": "10.1038/nature14151"
            }, 
            {
                "type": "journal", 
                "id": "bib39", 
                "date": "2015", 
                "authors": [
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "A Stepanyuk", 
                            "index": "Stepanyuk, A"
                        }
                    }
                ], 
                "articleTitle": "Self-organization of grid fields under supervision of place cells in a neuron model with associative plasticity", 
                "journal": "Biologically Inspired Cognitive Architectures", 
                "volume": "13", 
                "pages": {
                    "first": "48", 
                    "last": "62", 
                    "range": "48\u201362"
                }, 
                "doi": "10.1016/j.bica.2015.06.006"
            }, 
            {
                "type": "journal", 
                "id": "bib40", 
                "date": "2015", 
                "authors": [
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "G Tocker", 
                            "index": "Tocker, G"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "O Barak", 
                            "index": "Barak, O"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "D Derdikman", 
                            "index": "Derdikman, D"
                        }
                    }
                ], 
                "articleTitle": "Grid cells correlation structure suggests organized feedforward projections into superficial layers of the medial entorhinal cortex", 
                "journal": "Hippocampus", 
                "volume": "25", 
                "pages": {
                    "first": "1599", 
                    "last": "1613", 
                    "range": "1599\u20131613"
                }, 
                "doi": "10.1002/hipo.22481"
            }, 
            {
                "type": "web", 
                "id": "bib41", 
                "date": "2013", 
                "authors": [
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "X-X Wei", 
                            "index": "Wei, X-X"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "J Prentice", 
                            "index": "Prentice, J"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "V Balasubramanian", 
                            "index": "Balasubramanian, V"
                        }
                    }
                ], 
                "title": "The sense of place: grid cells in the brain and the transcendental number e", 
                "uri": "http://arxiv.org/abs/1304.0031"
            }, 
            {
                "type": "journal", 
                "id": "bib42", 
                "date": "2000", 
                "authors": [
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "A Weingessel", 
                            "index": "Weingessel, A"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "K Hornik", 
                            "index": "Hornik, K"
                        }
                    }
                ], 
                "articleTitle": "Local PCA algorithms", 
                "journal": "Neural Networks, IEEE Transactions", 
                "volume": "11", 
                "pages": {
                    "first": "1242", 
                    "last": "1250", 
                    "range": "1242\u20131250"
                }
            }, 
            {
                "type": "journal", 
                "id": "bib43", 
                "date": "1963", 
                "authors": [
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "TN Wiesel", 
                            "index": "Wiesel, TN"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "DH Hubel", 
                            "index": "Hubel, DH"
                        }
                    }
                ], 
                "articleTitle": "Effects of visual deprivation on morphology and physiology of cells in the cat's lateral geniculate body", 
                "journal": "Journal of Neurophysiology", 
                "volume": "26", 
                "pages": {
                    "first": "978", 
                    "last": "993", 
                    "range": "978\u2013993"
                }
            }, 
            {
                "type": "journal", 
                "id": "bib44", 
                "date": "2010", 
                "authors": [
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "TJ Wills", 
                            "index": "Wills, TJ"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "F Cacucci", 
                            "index": "Cacucci, F"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "N Burgess", 
                            "index": "Burgess, N"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "J O'Keefe", 
                            "index": "O'Keefe, J"
                        }
                    }
                ], 
                "articleTitle": "Development of the hippocampal cognitive map in preweanling rats", 
                "journal": "Science", 
                "volume": "328", 
                "pages": {
                    "first": "1573", 
                    "last": "1576", 
                    "range": "1573\u20131576"
                }, 
                "doi": "10.1126/science.1188224"
            }, 
            {
                "type": "book-chapter", 
                "id": "bib45", 
                "date": "2004", 
                "authors": [
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "MP Witter", 
                            "index": "Witter, MP"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "DG Amaral", 
                            "index": "Amaral, DG"
                        }
                    }
                ], 
                "editors": [
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "G Paxinos", 
                            "index": "Paxinos, G"
                        }
                    }
                ], 
                "bookTitle": "The Rat Nervous System", 
                "publisher": {
                    "name": [
                        "Elsevier"
                    ], 
                    "address": {
                        "formatted": [
                            "San Diego, CA"
                        ], 
                        "components": {
                            "locality": [
                                "San Diego, CA"
                            ]
                        }
                    }
                }, 
                "edition": "3rd ed", 
                "chapterTitle": "Hippocampal Formation", 
                "pages": {
                    "first": "635", 
                    "last": "704", 
                    "range": "635\u2013704"
                }, 
                "doi": "10.1016/B978-012547638-6/50022-5"
            }, 
            {
                "type": "journal", 
                "id": "bib46", 
                "date": "2006", 
                "authors": [
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "R Zass", 
                            "index": "Zass, R"
                        }
                    }, 
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "A Shashua", 
                            "index": "Shashua, A"
                        }
                    }
                ], 
                "articleTitle": "Nonnegative Sparse PCA", 
                "journal": "NIPS Proceedings", 
                "pages": {
                    "first": "1561", 
                    "last": "1568", 
                    "range": "1561\u20131568"
                }
            }, 
            {
                "type": "unknown", 
                "id": "bib47", 
                "date": "2012", 
                "authors": [
                    {
                        "type": "person", 
                        "name": {
                            "preferred": "EA Zilli", 
                            "index": "Zilli, EA"
                        }
                    }
                ], 
                "title": "Models of grid cell spatial firing published 2005-2011", 
                "details": "Frontiers in Neural Circuits, 6, 10.3389/fncir.2012.00016"
            }
        ], 
        "appendices": [
            {
                "id": "app1", 
                "title": "Appendix", 
                "content": [
                    {
                        "type": "section", 
                        "id": "s36", 
                        "title": "Movement schema of agent and environment data", 
                        "content": [
                            {
                                "type": "paragraph", 
                                "text": "The relevant simulation data used:"
                            }, 
                            {
                                "type": "table", 
                                "id": "tblu1", 
                                "tables": [
                                    "<table><thead><tr><th valign=\"top\">Size of arena 10X10</th><th valign=\"top\">Place cells field width: 0.75</th><th valign=\"top\">Place cells distribution: <br/>uniform</th></tr></thead><tbody><tr><td valign=\"top\">Velocity: 0.25 (linear), <br/>0.1-6.3 (angular)</td><td valign=\"top\"># Place cells: 625</td><td valign=\"top\">Learning rate: 1/(t+1e5)</td></tr></tbody></table>"
                                ]
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "The agent was moved around the virtual environment according to:"
                            }, 
                            {
                                "type": "mathml", 
                                "id": "equ50", 
                                "mathml": "<math><mtable columnalign=\"left\"><mtr><mtd><msup><mi>D</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msup><mo>=</mo><mi>modulo</mi><mrow><mo>(</mo><mrow><msup><mi>D</mi><mi>t</mi></msup><mo>+</mo><mi>\u03c9</mi><mo>\u22c5</mo><mi>Z</mi><mo>,</mo><mn>2</mn><mi>\u03c0</mi></mrow><mo>)</mo></mrow></mtd></mtr><mtr><mtd><msup><mi>x</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msup><mo>=</mo><msup><mi>x</mi><mi>t</mi></msup><mo>+</mo><mi>\u03bd</mi><mo>\u22c5</mo><mi>cos</mi><mrow><mo>(</mo><mrow><msup><mi>D</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msup></mrow><mo>)</mo></mrow></mtd></mtr><mtr><mtd><msup><mi>y</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msup><mo>=</mo><msup><mi>y</mi><mi>t</mi></msup><mo>+</mo><mi>\u03bd</mi><mo>\u22c5</mo><mi>sin</mi><mrow><mo>(</mo><mrow><msup><mi>D</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msup></mrow><mo>)</mo></mrow></mtd></mtr></mtable></math>"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "where <math id=\"inf308\"><mrow><msup><mi>D</mi><mi>t</mi></msup></mrow></math> is the current direction angle, <math id=\"inf309\"><mi>\u03c9</mi></math> is the angular velocity, <math id=\"inf310\"><mi>Z</mi><mo>-</mo><mi>N</mi><mrow><mo>(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo>)</mo></mrow></math>\u00a0where <math id=\"inf311\"><mi>N</mi></math> is the standard normal Gaussian distribution, <math id=\"inf312\"><mi>\u03bd</mi></math> is the linear velocity, and <math id=\"inf313\"><mrow><mrow><mo>(</mo><mrow><msup><mi>x</mi><mi>t</mi></msup><mo>,</mo><msup><mi>y</mi><mi>t</mi></msup></mrow><mo>)</mo></mrow></mrow></math> is the current position of the agent. Edges were treated as periodic \u2013 when agent arrived to one side of box it was teleported to the other side."
                            }
                        ]
                    }, 
                    {
                        "type": "section", 
                        "id": "s37", 
                        "title": "Positive-negative disks", 
                        "content": [
                            {
                                "type": "paragraph", 
                                "text": "Positive-negative disks are used with the following activity rules:"
                            }, 
                            {
                                "type": "mathml", 
                                "id": "equ51", 
                                "mathml": "<math><mo></mo><mrow><mo>(</mo><msubsup><mi>r</mi><mi>j</mi><mi>t</mi></msubsup><mrow><mo>(</mo><msup><mi>x</mi><mi>t</mi></msup><mo>,</mo><msup><mi>y</mi><mi>t</mi></msup><mo>)</mo></mrow><mo>)</mo></mrow><mo>=</mo><mo>{</mo><mtable><mtr><mtd><mn>1</mn></mtd></mtr><mtr><mtd><mfrac><msubsup><mi>\u03c1</mi><mn>1</mn><mn>2</mn></msubsup><mrow><msubsup><mi>\u03c1</mi><mn>2</mn><mn>2</mn></msubsup><mo>\u2212</mo><msubsup><mi>\u03c1</mi><mn>1</mn><mn>2</mn></msubsup></mrow></mfrac></mtd></mtr><mtr><mtd><mn>0</mn></mtd></mtr></mtable><mtable columnalign=\"left\"><mtr><mtd><mo>,</mo><mo>\u00a0</mo><mo>\u00a0</mo><mo>\u00a0</mo><mo>\u00a0</mo><mo>\u00a0</mo><mo>\u00a0</mo><mo>\u00a0</mo><mo>\u00a0</mo><mo>\u00a0</mo><msqrt><msup><mrow><mo>(</mo><msup><mi>x</mi><mi>t</mi></msup><mo>\u2212</mo><msub><mi>c</mi><mrow><mi>x</mi><mo>,</mo><mi>j</mi></mrow></msub><mo>)</mo></mrow><mn>2</mn></msup><mo>+</mo><msup><mrow><mo>(</mo><msup><mi>y</mi><mi>t</mi></msup><mo>\u2212</mo><msub><mi>c</mi><mrow><mi>y</mi><mo>,</mo><mi>j</mi></mrow></msub><mo>)</mo></mrow><mn>2</mn></msup></msqrt><mo>&lt;</mo><msub><mi>\u03c1</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd><mo>,</mo><mo>\u00a0</mo><mo>\u00a0</mo><mo>\u00a0</mo><msub><mi>\u03c1</mi><mn>1</mn></msub><mo>&lt;</mo><msqrt><msup><mrow><mo>(</mo><msup><mi>x</mi><mi>t</mi></msup><mo>\u2212</mo><msub><mi>c</mi><mrow><mi>x</mi><mo>,</mo><mi>j</mi></mrow></msub><mo>)</mo></mrow><mn>2</mn></msup><mo>+</mo><msup><mrow><mo>(</mo><msup><mi>y</mi><mi>t</mi></msup><mo>\u2212</mo><msub><mi>c</mi><mrow><mi>y</mi><mo>,</mo><mi>j</mi></mrow></msub><mo>)</mo></mrow><mn>2</mn></msup></msqrt><mo>&lt;</mo><msub><mi>\u03c1</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd><mo>,</mo><mo>\u00a0</mo><mo>\u00a0</mo><mo>\u00a0</mo><msub><mi>\u03c1</mi><mn>2</mn></msub><mo>&lt;</mo><msqrt><msup><mrow><mo>(</mo><msup><mi>x</mi><mi>t</mi></msup><mo>\u2212</mo><msub><mi>c</mi><mrow><mi>x</mi><mo>,</mo><mi>j</mi></mrow></msub><mo>)</mo></mrow><mn>2</mn></msup><mo>+</mo><msup><mrow><mo>(</mo><msup><mi>y</mi><mi>t</mi></msup><mo>\u2212</mo><msub><mi>c</mi><mrow><mi>y</mi><mo>,</mo><mi>j</mi></mrow></msub><mo>)</mo></mrow><mn>2</mn></msup></msqrt></mtd></mtr></mtable></math>"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "Where\u00a0<math id=\"inf314\"><msub><mi>c</mi><mi>x</mi></msub><mo>,</mo><mo>\u00a0</mo><msub><mi>c</mi><mi>y</mi></msub></math> are the centers of the disks, and <math id=\"inf315\"><msub><mi>\u03c1</mi><mn>1</mn></msub><mo>,</mo><mo>\u00a0</mo><msub><mi>\u03c1</mi><mn>2</mn></msub></math> are the radii of the inner circle and the outer ring, respectively. The constant value in the negative ring was chosen to yield zero integral over the disk."
                            }
                        ]
                    }, 
                    {
                        "type": "section", 
                        "id": "s38", 
                        "title": "Fourier transform of the difference of Gaussians function", 
                        "content": [
                            {
                                "type": "paragraph", 
                                "text": "Here we prove that if we are given a difference of Gaussians function,"
                            }, 
                            {
                                "type": "mathml", 
                                "id": "equ52", 
                                "mathml": "<math><mi>r</mi><mrow><mo>(</mo><mtext mathvariant=\"bold\">x</mtext><mo>)</mo></mrow><mo>=</mo><munderover><mo>\u2211</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mn>2</mn></munderover><msup><mrow><mo>(</mo><mo>\u2212</mo><mn>1</mn><mo>)</mo></mrow><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msup><msub><mi>c</mi><mrow><mi>i</mi><mo>\u00a0</mo></mrow></msub><mi>exp</mi><mrow><mo>(</mo><mo>\u2212</mo><mfrac><mstyle mathvariant=\"bold\"><mi>x</mi><mo mathvariant=\"normal\">\u00b7</mo><mi>x</mi></mstyle><mrow><mn>2</mn><msubsup><mi>\u03c3</mi><mi>i</mi><mn>2</mn></msubsup></mrow></mfrac><mo>)</mo></mrow><mo>,</mo></math>"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "in which the appropriate normalization constants for a bounded box are"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "<math id=\"inf316\"><mrow><msub><mi>c</mi><mi>i</mi></msub><mo>=</mo><msup><mrow><mrow><mo>[</mo><mrow><mstyle displaystyle=\"true\"><mrow><msubsup><mo>\u222b</mo><mrow><mo>\u2212</mo><mi>L</mi></mrow><mi>L</mi></msubsup><mrow><mi>exp</mi></mrow></mrow></mstyle><mrow><mo>(</mo><mrow><mo>\u2212</mo><mfrac><mrow><msup><mi>z</mi><mn>2</mn></msup></mrow><mrow><mn>2</mn><msubsup><mi>\u03c3</mi><mi>i</mi><mn>2</mn></msubsup></mrow></mfrac></mrow><mo>)</mo></mrow><mi>d</mi><mi>z</mi></mrow><mo>]</mo></mrow></mrow><mrow><mo>\u2212</mo><mn>1</mn></mrow></msup><mo>=</mo><msup><mrow><mrow><mo>[</mo><mrow><msqrt><mrow><mn>2</mn><mi>\u03c0</mi><msubsup><mi>\u03c3</mi><mi>i</mi><mn>2</mn></msubsup></mrow></msqrt><mrow><mo>[</mo><mrow><mn>2</mn><mi>F</mi><mrow><mo>(</mo><mrow><mi>L</mi><mo>/</mo><msub><mi>\u03c3</mi><mi>i</mi></msub></mrow><mo>)</mo></mrow><mo>\u2212</mo><mn>1</mn></mrow><mo>]</mo></mrow></mrow><mo>]</mo></mrow></mrow><mrow><mo>\u2212</mo><mi>D</mi></mrow></msup></mrow></math>,"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "with <math id=\"inf317\"><mrow><mi>F</mi><mrow><mo>(</mo><mi>x</mi><mo>)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mrow><msqrt><mrow><mn>2</mn><mi>\u03c0</mi><msubsup><mi>\u03c3</mi><mi>i</mi><mn>2</mn></msubsup></mrow></msqrt></mrow></mfrac><mstyle displaystyle=\"true\"><mrow><msubsup><mo>\u222b</mo><mrow><mo>\u2212</mo><mi>\u221e</mi></mrow><mi>x</mi></msubsup><mrow><mi>exp</mi></mrow></mrow></mstyle><mrow><mo>(</mo><mrow><mo>\u2212</mo><mfrac><mrow><msup><mi>z</mi><mn>2</mn></msup></mrow><mrow><mn>2</mn><msubsup><mi>\u03c3</mi><mi>i</mi><mn>2</mn></msubsup></mrow></mfrac></mrow><mo>)</mo></mrow><mi>d</mi><mi>z</mi></mrow></math>\u00a0being the cumulative normal distribution, then <math id=\"inf318\"><mo>\u2200</mo><mi mathvariant=\"bold\">k</mi><mo>\u2208</mo><mover><mi>S</mi><mo mathvariant=\"italic\">^</mo></mover><mo>=</mo><msub><mfenced close=\"}\" open=\"{\"><mfenced><mrow><mfrac><mrow><msub><mi>m</mi><mn>1</mn></msub><mn>2</mn><mi>\u03c0</mi></mrow><mi>L</mi></mfrac><mo>,</mo><mo>\u2026</mo><mo>,</mo><mfrac><mrow><msub><mi>m</mi><mi>D</mi></msub><mn>2</mn><mi>\u03c0</mi></mrow><mi>L</mi></mfrac></mrow></mfenced></mfenced><mrow><mfenced><mrow><msub><mi>m</mi><mn>1</mn></msub><mo mathvariant=\"italic\">,</mo><mo mathvariant=\"italic\">\u2026</mo><mo mathvariant=\"italic\">,</mo><msub><mi>m</mi><mi>D</mi></msub></mrow></mfenced><mo>\u2208</mo><msup><mi mathvariant=\"normal\">\u2124</mi><mi>D</mi></msup></mrow></msub></math>, we have"
                            }, 
                            {
                                "type": "mathml", 
                                "id": "equ53", 
                                "mathml": "<math><mover><mi>r</mi><mo>^</mo></mover><mo>(</mo><mtext mathvariant=\"bold\">k</mtext><mo>)</mo><mo>\u225c</mo><mfrac><mn>1</mn><mfenced close=\"|\" open=\"|\"><mi>S</mi></mfenced></mfrac><msub><mo>\u222b</mo><mi>S</mi></msub><mo>\u00a0</mo><mi>r</mi><mo>(</mo><mtext mathvariant=\"bold\">x</mtext><mo>)</mo><mo>\u00a0</mo><msup><mi>e</mi><mrow><mi>i</mi><mtext mathvariant=\"bold\">k</mtext><mo>\u00b7</mo><mtext mathvariant=\"bold\">x</mtext></mrow></msup><mo>\u00a0</mo><mi>d</mi><mtext mathvariant=\"bold\">x</mtext><mo>\u00a0</mo><mo>=</mo><mo>\u00a0</mo><mfrac><mn>1</mn><mfenced close=\"|\" open=\"|\"><mi>S</mi></mfenced></mfrac><munderover><mo>\u2211</mo><mrow><mi mathvariant=\"normal\">i</mi><mo>=</mo><mn>1</mn></mrow><mn>2</mn></munderover><mtext>(</mtext><mo>-</mo><mn>1</mn><msup><mtext>)</mtext><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msup><mtext>exp</mtext><mo>(</mo><mo>-</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><msubsup><mi>\u03c3</mi><mi>i</mi><mn>2</mn></msubsup><mo>\u00a0</mo><mtext mathvariant=\"bold\">k</mtext><mo mathvariant=\"bold\">\u00b7</mo><mtext mathvariant=\"bold\">k</mtext><mo>)</mo><mo>.</mo></math>"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "Note that the normalization constants <math id=\"inf319\"><mrow><msub><mi>c</mi><mi>i</mi></msub></mrow></math> vanish after the Fourier transform, and that in the limit <math id=\"inf320\"><mrow><mi>L</mi><mo>\u226b</mo><msub><mi>\u03c3</mi><mn>1</mn></msub><mo>,</mo><msub><mi>\u03c3</mi><mn>2</mn></msub></mrow></math> we obtain the standard result for the Fourier transform of an unbounded Gaussian distribution."
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "Proof: For simplicity of notation, we assume <math id=\"inf321\"><mrow><mi>D</mi><mo>=</mo><mn>2</mn></mrow></math>. However, the calculation is identical for any <math id=\"inf322\"><mi>D</mi></math>."
                            }, 
                            {
                                "type": "mathml", 
                                "id": "equ54", 
                                "mathml": "<math><mstyle><mtable columnalign=\"left left left\"><mtr><mtd><mover><mi>r</mi><mo>^</mo></mover><mrow><mo>(</mo><mi mathvariant=\"bold\">k</mi><mo>)</mo></mrow></mtd><mtd><mo>=</mo></mtd><mtd><mfrac><mn>1</mn><mrow><mo>|</mo><mi>S</mi><mo>|</mo></mrow></mfrac><msub><mo>\u222b</mo><mi>S</mi></msub><mi>r</mi><mrow><mo>(</mo><mi mathvariant=\"bold\">x</mi><mo>)</mo></mrow><msup><mi>e</mi><mrow><mi>i</mi><mi mathvariant=\"bold\">k</mi><mo>\u22c5</mo><mi mathvariant=\"bold\">x</mi></mrow></msup><mi>d</mi><mi mathvariant=\"bold\">x</mi></mtd></mtr><mtr><mtd></mtd><mtd><mo>=</mo></mtd><mtd><mfrac><mn>1</mn><mrow><mo>|</mo><mi>S</mi><mo>|</mo></mrow></mfrac><munderover><mo>\u2211</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mn>2</mn></munderover><msubsup><mo>\u222b</mo><mrow><mo>\u2212</mo><mi>L</mi></mrow><mi>L</mi></msubsup><mi>d</mi><mi>x</mi><msubsup><mo>\u222b</mo><mrow><mo>\u2212</mo><mi>L</mi></mrow><mi>L</mi></msubsup><mi>d</mi><mi>y</mi><mfenced close=\"]\" open=\"[\"><mrow><msup><mrow><mo>(</mo><mo>\u2212</mo><mn>1</mn><mo>)</mo></mrow><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msup><msub><mi>c</mi><mi>i</mi></msub><mo>\u00a0</mo><mtext>exp</mtext><mrow><mo>(</mo><mo>\u2212</mo><mfrac><mrow><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><msup><mi>y</mi><mn>2</mn></msup></mrow><mrow><mn>2</mn><msubsup><mi>\u03c3</mi><mi>i</mi><mn>2</mn></msubsup></mrow></mfrac><mo>)</mo></mrow></mrow></mfenced><mtext>exp</mtext><mrow><mo>(</mo><mi>i</mi><mrow><mo>(</mo><msub><mi>k</mi><mi>x</mi></msub><mi>x</mi><mo>+</mo><msub><mi>k</mi><mi>y</mi></msub><mi>y</mi><mo>)</mo></mrow><mo>)</mo></mrow></mtd></mtr><mtr><mtd></mtd><mtd><mo>=</mo></mtd><mtd><mfrac><mn>1</mn><mrow><mo>|</mo><mi>S</mi><mo>|</mo></mrow></mfrac><munderover><mo>\u2211</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mn>2</mn></munderover><mfenced close=\"]\" open=\"[\"><mrow><msubsup><mo>\u222b</mo><mrow><mo>\u2212</mo><mi>L</mi></mrow><mi>L</mi></msubsup><mi>d</mi><mi>x</mi><mfenced close=\"]\" open=\"[\"><mrow><msup><mrow><mo>(</mo><mo>\u2212</mo><mn>1</mn><mo>)</mo></mrow><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msup><msub><mi>c</mi><mi>i</mi></msub><mo>\u00a0</mo><mtext>exp</mtext><mrow><mo>(</mo><mo>\u2212</mo><mfrac><msup><mi>x</mi><mn>2</mn></msup><mrow><mn>2</mn><msubsup><mi>\u03c3</mi><mi>i</mi><mn>2</mn></msubsup></mrow></mfrac><mo>)</mo></mrow></mrow></mfenced><mtext>exp</mtext><mrow><mo>(</mo><mi>i</mi><msub><mi>k</mi><mi>x</mi></msub><mi>x</mi><mo>)</mo></mrow></mrow></mfenced></mtd></mtr><mtr><mtd></mtd><mtd></mtd><mtd><mo>\u00a0</mo><mo>\u00b7</mo><mo>\u00a0</mo><mfenced close=\"]\" open=\"[\"><mrow><msubsup><mo>\u222b</mo><mrow><mo>\u2212</mo><mi>L</mi></mrow><mi>L</mi></msubsup><mi>d</mi><mi>y</mi><mfenced close=\"]\" open=\"[\"><mrow><msup><mrow><mo>(</mo><mo>\u2212</mo><mn>1</mn><mo>)</mo></mrow><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msup><mtext>exp</mtext><mrow><mo>(</mo><mo>\u2212</mo><mfrac><msup><mi>y</mi><mn>2</mn></msup><mrow><mn>2</mn><msubsup><mi>\u03c3</mi><mi>i</mi><mn>2</mn></msubsup></mrow></mfrac><mo>)</mo></mrow></mrow></mfenced><mtext>exp</mtext><mrow><mo>(</mo><mi>i</mi><msub><mi>k</mi><mi>y</mi></msub><mi>y</mi><mo>)</mo></mrow></mrow></mfenced></mtd></mtr><mtr><mtd></mtd><mtd><mo>=</mo></mtd><mtd><mfrac><msup><mn>2</mn><mi>D</mi></msup><mrow><mo>|</mo><mi>S</mi><mo>|</mo></mrow></mfrac><munderover><mo>\u2211</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mn>2</mn></munderover><msup><mrow><mo>(</mo><mo>\u2212</mo><mn>1</mn><mo>)</mo></mrow><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msup><msub><mi>c</mi><mi>i</mi></msub><munder><mo>\u220f</mo><mrow><mi>z</mi><mo>\u2208</mo><mrow><mo>{</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>}</mo></mrow></mrow></munder><msubsup><mo>\u222b</mo><mn>0</mn><mi>L</mi></msubsup><mi>d</mi><mi>z</mi><mo>\u00a0</mo><mtext>exp</mtext><mrow><mo>(</mo><mo>\u2212</mo><mfrac><msup><mi>z</mi><mn>2</mn></msup><mrow><mn>2</mn><msubsup><mi>\u03c3</mi><mi>i</mi><mn>2</mn></msubsup></mrow></mfrac><mo>)</mo></mrow><mfenced close=\"]\" open=\"[\"><mrow><mtext>exp</mtext><mrow><mo>(</mo><mi>i</mi><msub><mi>k</mi><mi>z</mi></msub><mi>z</mi><mo>)</mo></mrow><mo>+</mo><mtext>exp</mtext><mrow><mo>(</mo><mo>\u2212</mo><mi>i</mi><msub><mi>k</mi><mi>z</mi></msub><mi>z</mi><mo>)</mo></mrow></mrow></mfenced></mtd></mtr><mtr><mtd></mtd><mtd><mo>=</mo></mtd><mtd><mfrac><msup><mn>2</mn><mi>D</mi></msup><mrow><mo>|</mo><mi>S</mi><mo>|</mo></mrow></mfrac><munderover><mo>\u2211</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mn>2</mn></munderover><msup><mrow><mo>(</mo><mo>\u2212</mo><mn>1</mn><mo>)</mo></mrow><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msup><msub><mi>c</mi><mi>i</mi></msub><munder><mo>\u220f</mo><mrow><mi>z</mi><mo>\u2208</mo><mrow><mo>{</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>}</mo></mrow></mrow></munder><msubsup><mo>\u222b</mo><mn>0</mn><mi>L</mi></msubsup><mi>d</mi><mi>z</mi><mo>\u00a0</mo><mtext>exp</mtext><mrow><mo>(</mo><mo>\u2212</mo><mfrac><msup><mi>z</mi><mn>2</mn></msup><mrow><mn>2</mn><msubsup><mi>\u03c3</mi><mi>i</mi><mn>2</mn></msubsup></mrow></mfrac><mo>)</mo></mrow><mtext>cos</mtext><mrow><mo>(</mo><msub><mi>k</mi><mi>z</mi></msub><mi>z</mi><mo>)</mo></mrow></mtd></mtr></mtable></mstyle></math>"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "To solve this integral, we define"
                            }, 
                            {
                                "type": "mathml", 
                                "id": "equ55", 
                                "mathml": "<math><msub><mi>I</mi><mi>i</mi></msub><mo>\u00a0</mo><mo>(</mo><mi>a</mi><mo>)</mo><mo>=</mo><msubsup><mo>\u222b</mo><mn>0</mn><mi>L</mi></msubsup><mo>\u00a0</mo><mi>d</mi><mi>z</mi><mo>\u00a0</mo><mi>exp</mi><mfenced><mrow><mo>-</mo><mfrac><msup><mi>z</mi><mn>2</mn></msup><mrow><mn>2</mn><msubsup><mi>\u03c3</mi><mi>i</mi><mn>2</mn></msubsup></mrow></mfrac></mrow></mfenced><mo>\u00a0</mo><mi>cos</mi><mo>\u00a0</mo><mo>(</mo><mi>a</mi><mi>z</mi><mo>)</mo><mo>.</mo></math>"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "Its derivative is"
                            }, 
                            {
                                "type": "mathml", 
                                "id": "equ56", 
                                "mathml": "<math><mtable columnalign=\"left\"><mtr><mtd><mstyle displaystyle=\"true\"><msub><msup><mi>I</mi><mo>'</mo></msup><mi>i</mi></msub><mrow><mo>(</mo><mi>a</mi><mo>)</mo></mrow><mo>=</mo><mo>\u2212</mo><msubsup><mo>\u222b</mo><mn>0</mn><mi>L</mi></msubsup><mi>d</mi><mi>z</mi><mi>z</mi><mo>\u00a0</mo><mi>exp</mi><mrow><mo>(</mo><mo>\u2212</mo><mfrac><msup><mi>z</mi><mn>2</mn></msup><mrow><mn>2</mn><msubsup><mi>\u03c3</mi><mi>i</mi><mn>2</mn></msubsup></mrow></mfrac><mo>)</mo></mrow><mtext>sin</mtext><mrow><mo>(</mo><mi>a</mi><mi>z</mi><mo>)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle=\"true\"><mo>=</mo><msubsup><mrow><msubsup><mi>\u03c3</mi><mi>i</mi><mn>2</mn></msubsup><mi>e</mi><mi>x</mi><mi>p</mi><mrow><mo>(</mo><mo>\u2212</mo><mfrac><msup><mi>z</mi><mn>2</mn></msup><mrow><mn>2</mn><msubsup><mi>\u03c3</mi><mi>i</mi><mn>2</mn></msubsup></mrow></mfrac><mo>)</mo></mrow><mtext>sin</mtext><mrow><mo>(</mo><mi>a</mi><mi>z</mi><mo>)</mo></mrow><mo mathsize=\"15px\">|</mo></mrow><mrow><mi>z</mi><mo>=</mo><mn>0</mn></mrow><mi>L</mi></msubsup><mo>\u2212</mo><mi>a</mi><msubsup><mi>\u03c3</mi><mi>i</mi><mn>2</mn></msubsup><msubsup><mo>\u222b</mo><mn>0</mn><mi>L</mi></msubsup><mi>d</mi><mi>z</mi><mo>\u00a0</mo><mi>exp</mi><mrow><mo>(</mo><mo>\u2212</mo><mfrac><msup><mi>z</mi><mn>2</mn></msup><mrow><mn>2</mn><msubsup><mi>\u03c3</mi><mi>i</mi><mn>2</mn></msubsup></mrow></mfrac><mo>)</mo></mrow><mi>cos</mi><mrow><mo>(</mo><mi>a</mi><mi>z</mi><mo>)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mo>=</mo><mo>\u2212</mo><mi>a</mi><msubsup><mi>\u03c3</mi><mi>i</mi><mn>2</mn></msubsup><msub><mi>I</mi><mi>i</mi></msub><mrow><mo>(</mo><mi>a</mi><mo>)</mo></mrow></mtd></mtr></mtable></math>"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "where in the last equality we used the fact that <math id=\"inf323\"><mrow><mi>a</mi><mi>L</mi><mo>=</mo><mn>2</mn><mi>\u03c0</mi><mi>n</mi></mrow></math> (where\u00a0<math id=\"inf324\"><mi>n</mi></math> is an integer) if <math id=\"inf325\"><mrow><mi>a</mi><mo>\u2208</mo><mover accent=\"true\"><mi>S</mi><mo>^</mo></mover></mrow></math>. Solving this differential equation, we obtain"
                            }, 
                            {
                                "type": "mathml", 
                                "id": "equ57", 
                                "mathml": "<math><mrow><msub><mi>I</mi><mi>i</mi></msub><mrow><mo>(</mo><mi>a</mi><mo>)</mo></mrow><mo>=</mo><msub><mi>I</mi><mi>i</mi></msub><mrow><mo>(</mo><mn>0</mn><mo>)</mo></mrow><mi>exp</mi><mrow><mo>(</mo><mrow><mo>\u2212</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><msubsup><mi>\u03c3</mi><mi>i</mi><mn>2</mn></msubsup><msup><mi>a</mi><mn>2</mn></msup></mrow><mo>)</mo></mrow></mrow></math>"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "where"
                            }, 
                            {
                                "type": "mathml", 
                                "id": "equ58", 
                                "mathml": "<math><msub><mi>I</mi><mi>i</mi></msub><mo>(</mo><mn>0</mn><mo>)</mo><mo>=</mo><msubsup><mo>\u222b</mo><mn>0</mn><mi>L</mi></msubsup><mi>d</mi><mi>z</mi><mo>\u00a0</mo><mi>exp</mi><mo>(</mo><mo>-</mo><mfrac><msup><mi>z</mi><mn>2</mn></msup><mrow><mn>2</mn><msubsup><mi>\u03c3</mi><mi>i</mi><mn>2</mn></msubsup></mrow></mfrac><mo>)</mo><mo>=</mo><msqrt><mn>2</mn><mi>\u03c0</mi><msubsup><mi>\u03c3</mi><mi>i</mi><mn>2</mn></msubsup></msqrt><mo>\u00a0</mo><mfenced close=\"]\" open=\"[\"><mrow><mi>F</mi><mo>(</mo><mfrac><mi>L</mi><msub><mi>\u03c3</mi><mi>i</mi></msub></mfrac><mo>)</mo><mo>-</mo><mi>F</mi><mo>(</mo><mn>0</mn><mo>)</mo></mrow></mfenced><mo>=</mo><msqrt><mn>2</mn><mi>\u03c0</mi><msubsup><mi>\u03c3</mi><mi>i</mi><mn>2</mn></msubsup></msqrt><mo>\u00a0</mo><mfenced close=\"]\" open=\"[\"><mrow><mi mathvariant=\"normal\">F</mi><mo>(</mo><mfrac><mi>L</mi><msub><mi>\u03c3</mi><mi>i</mi></msub></mfrac><mo>)</mo><mo>-</mo><mfrac><mn>1</mn><mn>2</mn></mfrac></mrow></mfenced><mo>.</mo></math>"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "substituting this into our last expression for <math id=\"inf326\"><mi>r</mi><mrow><mo>(</mo><mi mathvariant=\"bold\">k</mi><mo>)</mo></mrow></math> we obtain"
                            }, 
                            {
                                "type": "mathml", 
                                "id": "equ59", 
                                "mathml": "<math><mi>r</mi><mrow><mo>(</mo><mi mathvariant=\"bold\">k</mi><mo>)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mrow><mo>|</mo><mi>S</mi><mo>|</mo></mrow></mfrac><munderover><mo>\u2211</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mn>2</mn></munderover><msup><mrow><mo>(</mo><mo>\u2212</mo><mn>1</mn><mo>)</mo></mrow><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msup><mi>exp</mi><mrow><mo>(</mo><mo>\u2212</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><msubsup><mi>\u03c3</mi><mi>i</mi><mn>2</mn></msubsup><munder><mo>\u2211</mo><mrow><mi>z</mi><mo>\u2208</mo><mrow><mo>{</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>}</mo></mrow></mrow></munder><msubsup><mi>k</mi><mi>z</mi><mn>2</mn></msubsup><mo>)</mo></mrow><mo>,</mo></math>"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "which is what we wanted to prove."
                            }
                        ]
                    }, 
                    {
                        "type": "section", 
                        "id": "s39", 
                        "title": "Why the 'unconstrained'\u00a0<math id=\"inf327\"><mrow><msub><mi>k</mi><mo>\u2020</mo></msub></mrow></math>\u00a0is a lower bound on 'constrained' <math id=\"inf328\"><mrow><msub><mi>k</mi><mo>*</mo></msub></mrow></math>", 
                        "content": [
                            {
                                "type": "paragraph", 
                                "text": "In section 'The PCA solution with a non-negative constraint \u2013 1D Solutions', we mention that the main difference between the Equations (<a href=\"#equ37\">Equations 33 and 34</a>) is the base frequency, <math id=\"inf329\"><mrow><msub><mi>k</mi><mo>*</mo></msub></mrow></math>, which is slightly different from <math id=\"inf330\"><mrow><msub><mi>k</mi><mo>\u2020</mo></msub></mrow></math>."
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "Here we explain how the relation between <math id=\"inf331\"><mrow><msub><mi>k</mi><mo>*</mo></msub></mrow></math> and <math id=\"inf332\"><mrow><msub><mi>k</mi><mo>\u2020</mo></msub></mrow></math> depends on the <math id=\"inf333\"><mi>k</mi></math>-lattice discretization, as well as the properties of <math id=\"inf334\"><mrow><mover accent=\"true\"><mi>r</mi><mo>^</mo></mover><mrow><mo>(</mo><mi>k</mi><mo>)</mo></mrow></mrow></math>. The discretization effect is similar to the unconstrained case, and can cause a difference of at most <math id=\"inf335\"><mrow><mi>\u03c0</mi><mo>/</mo><mi>L</mi></mrow></math> between <math id=\"inf336\"><mrow><msub><mi>k</mi><mo>*</mo></msub></mrow></math> to <math id=\"inf337\"><mrow><msub><mi>k</mi><mo>\u2020</mo></msub></mrow></math>. However, even if <math id=\"inf338\"><mrow><mi>L</mi><mo>\u2192</mo><mi>\u221e</mi></mrow></math>, we can expect <math id=\"inf339\"><mrow><msub><mi>k</mi><mo>*</mo></msub></mrow></math> to be slightly smaller than <math id=\"inf340\"><mrow><msub><mi>k</mi><mo>\u2020</mo></msub></mrow></math>. To see that, suppose we have a solution as described above, with <math id=\"inf341\"><mrow><msub><mi>k</mi><mo>*</mo></msub><mo>=</mo><msub><mi>k</mi><mo>\u2020</mo></msub><mo>+</mo><mi>\u03b4</mi><mi>k</mi></mrow></math> and <math id=\"inf342\"><mrow><mi>\u03b4</mi><mi>k</mi></mrow></math> is a small perturbation (which does not affect the non-negativity constraint). We write the perturbed <math id=\"inf343\"><mi>k</mi></math>-space objective of this solution"
                            }, 
                            {
                                "type": "mathml", 
                                "id": "equ60", 
                                "mathml": "<math><mrow><mstyle displaystyle=\"true\"><munderover><mo>\u2211</mo><mrow><mi>m</mi><mo>=</mo><mo>\u2212</mo><mi>\u221e</mi></mrow><mi>\u221e</mi></munderover><mrow><msup><mrow><mrow><mo>|</mo><mrow><mover accent=\"true\"><mi>J</mi><mo>^</mo></mover><mrow><mo>(</mo><mrow><mi>m</mi><msub><mi>k</mi><mo>\u2020</mo></msub></mrow><mo>)</mo></mrow></mrow><mo>|</mo></mrow></mrow><mn>2</mn></msup><msup><mrow><mrow><mo>|</mo><mrow><mover accent=\"true\"><mi>r</mi><mo>^</mo></mover><mrow><mo>(</mo><mrow><mi>m</mi><mrow><mo>(</mo><mrow><msub><mi>k</mi><mo>\u2020</mo></msub><mo>+</mo><mi>\u03b4</mi><mi>k</mi></mrow><mo>)</mo></mrow></mrow><mo>)</mo></mrow></mrow><mo>|</mo></mrow></mrow><mn>2</mn></msup></mrow></mstyle></mrow></math>"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "Since <math id=\"inf344\"><mrow><msub><mi>k</mi><mo>\u2020</mo></msub></mrow></math> is the peak of <math id=\"inf345\"><mrow><msup><mrow><mrow><mo>|</mo><mrow><mover accent=\"true\"><mi>r</mi><mo>^</mo></mover><mrow><mo>(</mo><mi>k</mi><mo>)</mo></mrow></mrow><mo>|</mo></mrow></mrow><mn>2</mn></msup></mrow></math>, if <math id=\"inf346\"><mrow><msup><mrow><mrow><mo>|</mo><mrow><mover accent=\"true\"><mi>r</mi><mo>^</mo></mover><mrow><mo>(</mo><mi>k</mi><mo>)</mo></mrow></mrow><mo>|</mo></mrow></mrow><mn>2</mn></msup></mrow></math> is monotonically decreasing for <math id=\"inf347\"><mrow><mi>k</mi><mo>&gt;</mo><msub><mi>k</mi><mo>\u2020</mo></msub></mrow></math> (as is the case for the difference of Gaussians function), then any positive perturbation <math id=\"inf348\"><mrow><mi>\u03b4</mi><mi>k</mi><mo>&gt;</mo><mn>0</mn></mrow></math> would decrease the objective."
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "However, a sufficiently small negative perturbation <math id=\"inf349\"><mrow><mi>\u03b4</mi><mi>k</mi><mo>&lt;</mo><mn>0</mn></mrow></math> would improve the objective. We can see this from the Taylor expansion of the objective,"
                            }, 
                            {
                                "type": "mathml", 
                                "id": "equ61", 
                                "mathml": "<math><mrow><mstyle displaystyle=\"true\"><munderover><mo>\u2211</mo><mrow><mi>m</mi><mo>=</mo><mo>\u2212</mo><mi>\u221e</mi></mrow><mi>\u221e</mi></munderover><mrow><msup><mrow><mrow><mo>|</mo><mrow><mover accent=\"true\"><mi>J</mi><mo>^</mo></mover><mrow><mo>(</mo><mrow><mi>m</mi><msub><mi>k</mi><mo>\u2020</mo></msub></mrow><mo>)</mo></mrow></mrow><mo>|</mo></mrow></mrow><mn>2</mn></msup><mrow><mo>(</mo><mrow><msup><mrow><mrow><mo>|</mo><mrow><mover accent=\"true\"><mi>r</mi><mo>^</mo></mover><mrow><mo>(</mo><mrow><mi>m</mi><msub><mi>k</mi><mo>\u2020</mo></msub></mrow><mo>)</mo></mrow></mrow><mo>|</mo></mrow></mrow><mn>2</mn></msup><mo>+</mo><msub><mrow><mrow><mrow><mfrac><mrow><mi>d</mi><msup><mrow><mrow><mo>|</mo><mrow><mover accent=\"true\"><mi>r</mi><mo>^</mo></mover><mrow><mo>(</mo><mi>k</mi><mo>)</mo></mrow></mrow><mo>|</mo></mrow></mrow><mn>2</mn></msup></mrow><mrow><mi>d</mi><mi>k</mi></mrow></mfrac></mrow><mo>|</mo></mrow></mrow><mrow><mi>k</mi><mo>=</mo><mi>m</mi><msub><mi>k</mi><mo>\u2020</mo></msub></mrow></msub><mi>m</mi><mi>\u03b4</mi><mi>k</mi><mo>+</mo><mi>O</mi><msup><mrow><mrow><mo>(</mo><mrow><mi>\u03b4</mi><mi>k</mi></mrow><mo>)</mo></mrow></mrow><mn>2</mn></msup></mrow><mo>)</mo></mrow></mrow></mstyle></mrow></math>"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "In which the derivative <math id=\"inf350\"><mrow><msub><mrow><mrow><mrow><mfrac><mrow><mi>d</mi><msup><mrow><mrow><mo>|</mo><mrow><mover accent=\"true\"><mi>r</mi><mo>^</mo></mover><mrow><mo>(</mo><mi>k</mi><mo>)</mo></mrow></mrow><mo>|</mo></mrow></mrow><mn>2</mn></msup></mrow><mrow><mi>d</mi><mi>k</mi></mrow></mfrac></mrow><mo>|</mo></mrow></mrow><mrow><mi>k</mi><mo>=</mo><mi>m</mi><msub><mi>k</mi><mo>\u2020</mo></msub></mrow></msub></mrow></math> is zero for <math id=\"inf351\"><mrow><mi>m</mi><mo>=</mo><mn>1</mn></mrow></math> (since <math id=\"inf352\"><mrow><msub><mi>k</mi><mo>\u2020</mo></msub></mrow></math> is the peak of <math id=\"inf353\"><mrow><msup><mrow><mrow><mo>|</mo><mrow><mover accent=\"true\"><mi>r</mi><mo>^</mo></mover><mrow><mo>(</mo><mi>k</mi><mo>)</mo></mrow></mrow><mo>|</mo></mrow></mrow><mn>2</mn></msup></mrow></math>) and negative for <math id=\"inf354\"><mrow><mi>m</mi><mo>&gt;</mo><mn>1</mn></mrow></math>, if <math id=\"inf355\"><mrow><msup><mrow><mrow><mo>|</mo><mrow><mover accent=\"true\"><mi>r</mi><mo>^</mo></mover><mrow><mo>(</mo><mi>k</mi><mo>)</mo></mrow></mrow><mo>|</mo></mrow></mrow><mn>2</mn></msup></mrow></math> is monotonically decreasing for <math id=\"inf356\"><mrow><mi>k</mi><mo>&gt;</mo><msub><mi>k</mi><mo>\u2020</mo></msub></mrow></math>. If we gradually increase the magnitude of this negative perturbation <math id=\"inf357\"><mrow><mi>\u03b4</mi><mi>k</mi><mo>&lt;</mo><mn>0</mn></mrow></math>, at some point the objective will stop increasing and start decreasing, because, for the difference of Gaussians function, <math id=\"inf358\"><mrow><msup><mrow><mrow><mo>|</mo><mrow><mover accent=\"true\"><mi>r</mi><mo>^</mo></mover><mrow><mo>(</mo><mi>k</mi><mo>)</mo></mrow></mrow><mo>|</mo></mrow></mrow><mn>2</mn></msup></mrow></math> increases more sharply for <math id=\"inf359\"><mrow><mi>k</mi><mo>&lt;</mo><msub><mi>k</mi><mo>\u2020</mo></msub></mrow></math> than it decreases for <math id=\"inf360\"><mrow><mi>k</mi><mo>&gt;</mo><msub><mi>k</mi><mo>\u2020</mo></msub></mrow></math>. We can thus treat the 'unconstrained'\u00a0<math id=\"inf361\"><mrow><msub><mi>k</mi><mo>\u2020</mo></msub></mrow></math>\u00a0as an upper bound for the 'constrained' <math id=\"inf362\"><mrow><msub><mi>k</mi><mo>*</mo></msub></mrow></math>, if we ignore discretization effects (<i>i.e.</i>, the limit <math id=\"inf363\"><mrow><mi>L</mi><mo>\u2192</mo><mi>\u221e</mi></mrow></math>)."
                            }
                        ]
                    }, 
                    {
                        "type": "section", 
                        "id": "s40", 
                        "title": "Upper bound on the constrained objective \u2013 2D square lattice", 
                        "content": [
                            {
                                "type": "paragraph", 
                                "text": "In the Methods section 'The PCA solution with a non-negative constraint \u2013 2D Solutions' we examine different 2D lattice-based solutions, including a square lattice, which is a solution of the following constrained minimization problem"
                            }, 
                            {
                                "type": "mathml", 
                                "id": "equ62", 
                                "mathml": "<math><mtable columnalign=\"left\"><mtr><mtd><msub><mi>max</mi><msubsup><mrow><mo>{</mo><msub><mi>J</mi><mi>m</mi></msub><mo>}</mo></mrow><mrow><mi>m</mi><mo>=</mo><mn>0</mn></mrow><mi>\u221e</mi></msubsup></msub><msubsup><mover><mi>J</mi><mo>^</mo></mover><mrow><mn>1</mn><mo>,</mo><mn>0</mn></mrow><mn>2</mn></msubsup><mo>+</mo><msubsup><mover><mi>J</mi><mo>^</mo></mover><mrow><mn>0</mn><mo>,</mo><mn>1</mn></mrow><mn>2</mn></msubsup></mtd></mtr><mtr><mtd><mtext>s</mtext><mtext>.t</mtext><mtext>.:</mtext><mtext>\u2009</mtext><mtext>\u2009</mtext><mtext>\u2009</mtext><mrow><mo>(</mo><mn>1</mn><mo>)</mo></mrow><munderover><mo>\u2211</mo><mrow><msub><mi>m</mi><mi>x</mi></msub><mo>=</mo><mo>\u2212</mo><mi>\u221e</mi></mrow><mi>\u221e</mi></munderover><munderover><mo>\u2211</mo><mrow><mo>\u00a0</mo><msub><mi>m</mi><mi>y</mi></msub><mo>=</mo><mo>\u2212</mo><mi>\u221e</mi></mrow><mi>\u221e</mi></munderover><msubsup><mover><mi>J</mi><mo>^</mo></mover><mrow><msub><mi>m</mi><mi>x</mi></msub><mo>,</mo><msub><mi>m</mi><mi>y</mi></msub></mrow><mn>2</mn></msubsup><mo>=</mo><mn>1</mn></mtd></mtr><mtr><mtd><mtext>\u2009</mtext><mtext>\u2009</mtext><mtext>\u2009</mtext><mtext>\u2009</mtext><mtext>\u2009</mtext><mtext> </mtext><mrow><mo>\u00a0</mo><mo>\u00a0</mo><mo>\u00a0</mo><mo>(</mo><mn>2</mn><mo>)</mo></mrow><mtext>\u2009</mtext><munderover><mo>\u2211</mo><mrow><msub><mi>m</mi><mi>x</mi></msub><mo>=</mo><mo>\u2212</mo><mi>\u221e</mi></mrow><mi>\u221e</mi></munderover><munderover><mo>\u2211</mo><mrow><mo>\u00a0</mo><msub><mi>m</mi><mi>y</mi></msub><mo>=</mo><mo>\u2212</mo><mi>\u221e</mi></mrow><mi>\u221e</mi></munderover><msubsup><mover><mi>J</mi><mo>^</mo></mover><mrow><msub><mi>m</mi><mi>x</mi></msub><mo>,</mo><msub><mi>m</mi><mi>y</mi></msub></mrow><mrow></mrow></msubsup><mi>cos</mi><mrow><mo>(</mo><msub><mi>k</mi><mo>\u2020</mo></msub><mrow><mo>(</mo><msub><mi>m</mi><mi>x</mi></msub><mi>x</mi><mo>+</mo><msub><mi>m</mi><mi>y</mi></msub><mi>y</mi><mo>)</mo></mrow><mo>+</mo><msub><mi>\u03d5</mi><mrow><msub><mi>m</mi><mi>x</mi></msub><mo>,</mo><msub><mi>m</mi><mi>y</mi></msub></mrow></msub><mo>)</mo></mrow><mo>\u2265</mo><mn>0</mn></mtd></mtr></mtable><mo>.</mo></math>"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "Here we prove that the objective is bounded above by <math id=\"inf364\"><mrow><mfrac><mn>1</mn><mn>4</mn></mfrac></mrow></math>, <i>i.e.</i>, <math id=\"inf365\"><mrow><msubsup><mover accent=\"true\"><mi>J</mi><mo>^</mo></mover><mrow><mn>1</mn><mo>,</mo><mn>0</mn></mrow><mn>2</mn></msubsup><mo>+</mo><msubsup><mover accent=\"true\"><mi>J</mi><mo>^</mo></mover><mrow><mn>0</mn><mo>,</mo><mn>1</mn></mrow><mn>2</mn></msubsup><mo>\u2264</mo><mfrac><mn>1</mn><mn>4</mn></mfrac></mrow></math>."
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "Without loss of generality we assume <math id=\"inf366\"><mrow><msub><mi>\u03d5</mi><mrow><mn>1</mn><mo>,</mo><mn>0</mn></mrow></msub><mo>=</mo><msub><mi>\u03d5</mi><mrow><mn>0</mn><mo>,</mo><mn>1</mn></mrow></msub><mo>=</mo><mn>0</mn><mo>,</mo><msub><mi>k</mi><mo>\u2020</mo></msub><mo>=</mo><mn>1</mn></mrow></math> (we can always shift and scale <math id=\"inf367\"><mrow><mi>x</mi><mo>,</mo><mi>y</mi></mrow></math>). We denote"
                            }, 
                            {
                                "type": "mathml", 
                                "id": "equ63", 
                                "mathml": "<math><mi>P</mi><mrow><mo>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>)</mo></mrow><mo>=</mo><mn>2</mn><msubsup><mover><mi>J</mi><mo>^</mo></mover><mrow><mn>0</mn><mo>,</mo><mn>1</mn></mrow><mrow></mrow></msubsup><mi>cos</mi><mrow><mo>(</mo><mi>x</mi><mo>)</mo></mrow><mo>+</mo><mn>2</mn><msubsup><mover><mi>J</mi><mo>^</mo></mover><mrow><mn>1</mn><mo>,</mo><mn>0</mn></mrow><mrow></mrow></msubsup><mi>cos</mi><mrow><mo>(</mo><mi>y</mi><mo>)</mo></mrow></math>"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "and"
                            }, 
                            {
                                "type": "mathml", 
                                "id": "equ64", 
                                "mathml": "<math><mrow><mi>A</mi><mrow><mo>(</mo><mrow><mi>x</mi><mo>,</mo><mi>y</mi></mrow><mo>)</mo></mrow><mo>=</mo><mstyle displaystyle=\"true\"><munderover><mo>\u2211</mo><mrow><msub><mi>m</mi><mi>x</mi></msub><mo>=</mo><mo>\u2212</mo><mi>\u221e</mi></mrow><mi>\u221e</mi></munderover><mrow><mstyle displaystyle=\"true\"><munderover><mo>\u2211</mo><mrow><msub><mi>m</mi><mi>y</mi></msub><mo>=</mo><mo>\u2212</mo><mi>\u221e</mi></mrow><mi>\u221e</mi></munderover><mrow><msubsup><mover accent=\"true\"><mi>J</mi><mo>^</mo></mover><mrow><msub><mi>m</mi><mi>x</mi></msub><mo>,</mo><msub><mi>m</mi><mi>y</mi></msub></mrow><mrow></mrow></msubsup></mrow></mstyle></mrow></mstyle><mi>cos</mi><mrow><mo>(</mo><mrow><mrow><mo>(</mo><mrow><msub><mi>m</mi><mi>x</mi></msub><mi>x</mi><mo>+</mo><msub><mi>m</mi><mi>y</mi></msub><mi>y</mi></mrow><mo>)</mo></mrow><mo>+</mo><msub><mi>\u03d5</mi><mrow><msub><mi>m</mi><mi>x</mi></msub><mo>,</mo><msub><mi>m</mi><mi>y</mi></msub></mrow></msub></mrow><mo>)</mo></mrow><mo>\u2212</mo><mi>P</mi><mrow><mo>(</mo><mrow><mi>x</mi><mo>,</mo><mi>y</mi></mrow><mo>)</mo></mrow></mrow></math>"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "We examine the domain <math id=\"inf368\"><mrow><msup><mrow><mrow><mo>[</mo><mrow><mn>0</mn><mo>,</mo><mn>2</mn><mi>\u03c0</mi></mrow><mo>]</mo></mrow></mrow><mn>2</mn></msup></mrow></math>. We denote by <math id=\"inf369\"><mrow><msup><mi>C</mi><mo>\u00b1</mo></msup></mrow></math> the regions in which <math id=\"inf370\"><mrow><mi>P</mi><mrow><mo>(</mo><mrow><mi>x</mi><mo>,</mo><mi>y</mi></mrow><mo>)</mo></mrow></mrow></math> is positive or negative, respectively. Note that"
                            }, 
                            {
                                "type": "mathml", 
                                "id": "equ65", 
                                "mathml": "<math><mi>P</mi><mrow><mo>(</mo><mrow><mo>(</mo><mi>x</mi><mo>+</mo><mi>\u03c0</mi><mo>)</mo></mrow><mi>mod</mi><mo>\u00a0</mo><mn>2</mn><mi>\u03c0</mi><mo>,</mo><mrow><mo>(</mo><mi>y</mi><mo>+</mo><mi>\u03c0</mi><mo>)</mo></mrow><mi>mod</mi><mo>\u00a0</mo><mn>2</mn><mi>\u03c0</mi><mo>)</mo></mrow><mo>=</mo><mo>\u2212</mo><mi>P</mi><mrow><mo>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>)</mo></mrow></math>"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "so both regions have the same area, and"
                            }, 
                            {
                                "type": "mathml", 
                                "id": "equ66", 
                                "label": "(A1)", 
                                "mathml": "<math><munder><mo>\u222b</mo><msup><mi>C</mi><mo>\u2212</mo></msup></munder><msup><mi>P</mi><mn>2</mn></msup><mrow><mo>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>)</mo></mrow><mi>d</mi><mi>x</mi><mi>d</mi><mi>y</mi><mo>=</mo><munder><mo>\u222b</mo><msup><mi>C</mi><mo>+</mo></msup></munder><msup><mi>P</mi><mn>2</mn></msup><mrow><mo>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>)</mo></mrow><mi>d</mi><mi>x</mi><mi>d</mi><mi>y</mi><mo>.</mo></math>"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "From the non-negativity constraint (2), we must have"
                            }, 
                            {
                                "type": "mathml", 
                                "id": "equ67", 
                                "label": "(A2)", 
                                "mathml": "<math><mo>\u2200</mo><mrow><mo>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>)</mo></mrow><mo>\u2208</mo><msup><mi>C</mi><mo>\u2212</mo></msup><mo>:</mo><mi>A</mi><mrow><mo>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>)</mo></mrow><mo>\u2265</mo><mo>\u2212</mo><mi>P</mi><mrow><mo>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>)</mo></mrow><mo>.</mo></math>"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "Also, note that <math id=\"inf371\"><mrow><mi>P</mi><mrow><mo>(</mo><mrow><mi>x</mi><mo>,</mo><mi>y</mi></mrow><mo>)</mo></mrow></mrow></math> and <math id=\"inf372\"><mrow><mi>A</mi><mrow><mo>(</mo><mrow><mi>x</mi><mo>,</mo><mi>y</mi></mrow><mo>)</mo></mrow></mrow></math> do not share any common Fourier (cosine) components. Therefore, they are orthogonal, with the inner product being the integral of their product on the region <math id=\"inf373\"><mrow><msup><mrow><mrow><mo>[</mo><mrow><mn>0</mn><mo>,</mo><mn>2</mn><mi>\u03c0</mi></mrow><mo>]</mo></mrow></mrow><mn>2</mn></msup></mrow></math>"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "<math id=\"inf374\"><mstyle><mtable columnalign=\"left left left\"><mtr><mtd><mn>0</mn></mtd><mtd><mo>=</mo></mtd><mtd><mstyle displaystyle=\"true\"><munder><mo>\u222b</mo><msup><mrow><mo>[</mo><mn>0</mn><mo>,</mo><mn>2</mn><mi>\u03c0</mi><mo>]</mo></mrow><mn>2</mn></msup></munder></mstyle><mi>P</mi><mrow><mo>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>)</mo></mrow><mi>A</mi><mrow><mo>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>)</mo></mrow><mi>d</mi><mi>x</mi><mi>d</mi><mi>y</mi></mtd></mtr><mtr><mtd></mtd><mtd><mo>=</mo></mtd><mtd><mstyle displaystyle=\"true\"><munder><mo>\u222b</mo><msup><mi>C</mi><mo>+</mo></msup></munder></mstyle><mi>P</mi><mrow><mo>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>)</mo></mrow><mi>A</mi><mrow><mo>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>)</mo></mrow><mi>d</mi><mi>x</mi><mi>d</mi><mi>y</mi><mo>+</mo><mstyle displaystyle=\"true\"><munder><mo>\u222b</mo><msup><msup><mi>C</mi><mo>\u2212</mo></msup><mrow></mrow></msup></munder></mstyle><mi>P</mi><mrow><mo>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>)</mo></mrow><mi>A</mi><mrow><mo>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>)</mo></mrow><mi>d</mi><mi>x</mi><mi>d</mi><mi>y</mi></mtd></mtr><mtr><mtd></mtd><mtd><mo>\u2264</mo></mtd><mtd><mstyle displaystyle=\"true\"><munder><mo>\u222b</mo><msup><mi>C</mi><mo>+</mo></msup></munder></mstyle><mi>P</mi><mrow><mo>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>)</mo></mrow><mi>A</mi><mrow><mo>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>)</mo></mrow><mi>d</mi><mi>x</mi><mi>d</mi><mi>y</mi><mo>\u2212</mo><mstyle displaystyle=\"true\"><munder><mo>\u222b</mo><msup><mi>C</mi><mo>+</mo></msup></munder></mstyle><msup><mi>P</mi><mn>2</mn></msup><mrow><mo>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>)</mo></mrow><mi>d</mi><mi>x</mi><mi>d</mi><mi>y</mi></mtd></mtr></mtable></mstyle></math>,"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "where in the last line we used the bound from <a href=\"#equ67\">Equation (A2)</a>, and then <a href=\"#equ66\">Equation (A1)</a>. Using this result, together with Cauchy-Schwartz inequality, we have"
                            }, 
                            {
                                "type": "mathml", 
                                "id": "equ68", 
                                "mathml": "<math><mstyle><munder><mo>\u222b</mo><msup><mi>C</mi><mo>+</mo></msup></munder><msup><mi>P</mi><mn>2</mn></msup><mrow><mo>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>)</mo></mrow><mi>d</mi><mi>x</mi><mi>d</mi><mi>y</mi><mo>\u2264</mo><munder><mo>\u222b</mo><msup><mi>C</mi><mo>+</mo></msup></munder><mi>P</mi><mrow><mo>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>)</mo></mrow><mi>A</mi><mrow><mo>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>)</mo></mrow><mi>d</mi><mi>x</mi><mi>d</mi><mi>y</mi><mo>\u2264</mo><msqrt><munder><mo>\u222b</mo><msup><mi>C</mi><mo>+</mo></msup></munder><msup><mi>P</mi><mn>2</mn></msup><mrow><mo>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>)</mo></mrow><mi>d</mi><mi>x</mi><mi>d</mi><mi>y</mi><munder><mo>\u222b</mo><msup><mi>C</mi><mo>+</mo></msup></munder><msup><mi>A</mi><mn>2</mn></msup><mrow><mo>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>)</mo></mrow><mi>d</mi><mi>x</mi><mi>d</mi><mi>y</mi></msqrt><mo>,</mo></mstyle></math>"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "So,"
                            }, 
                            {
                                "type": "mathml", 
                                "id": "equ69", 
                                "mathml": "<math><munder><mo>\u222b</mo><msup><mi>C</mi><mo>+</mo></msup></munder><msup><mi>P</mi><mn>2</mn></msup><mrow><mo>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>)</mo></mrow><mi>d</mi><mi>x</mi><mi>d</mi><mi>y</mi><mo>\u2264</mo><munder><mo>\u222b</mo><msup><mi>C</mi><mo>+</mo></msup></munder><msup><mi>A</mi><mn>2</mn></msup><mrow><mo>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>)</mo></mrow><mi>d</mi><mi>x</mi><mi>d</mi><mi>y</mi><mo>,</mo></math>"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "Summing this equation with <a href=\"#equ67\">Equation (A2),</a> squared and integrated over the region <math id=\"inf375\"><mrow><msup><mi>C</mi><mo>\u2212</mo></msup></mrow></math>, and dividing by <math id=\"inf376\"><mrow><msup><mrow><mrow><mo>(</mo><mrow><mn>2</mn><mi>\u03c0</mi></mrow><mo>)</mo></mrow></mrow><mn>2</mn></msup></mrow></math>, we obtain"
                            }, 
                            {
                                "type": "mathml", 
                                "id": "equ70", 
                                "mathml": "<math><mfrac><mn>1</mn><msup><mrow><mo>(</mo><mn>2</mn><mi>\u03c0</mi><mo>)</mo></mrow><mn>2</mn></msup></mfrac><munder><mo>\u222b</mo><msup><mrow><mo>[</mo><mn>0</mn><mo>,</mo><mn>2</mn><mi>\u03c0</mi><mo>]</mo></mrow><mn>2</mn></msup></munder><msup><mi>P</mi><mn>2</mn></msup><mrow><mo>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>)</mo></mrow><mi>d</mi><mi>x</mi><mi>d</mi><mi>y</mi><mo>\u2264</mo><mfrac><mn>1</mn><msup><mrow><mo>(</mo><mn>2</mn><mi>\u03c0</mi><mo>)</mo></mrow><mn>2</mn></msup></mfrac><munder><mo>\u222b</mo><msup><mrow><mo>[</mo><mn>0</mn><mo>,</mo><mn>2</mn><mi>\u03c0</mi><mo>]</mo></mrow><mn>2</mn></msup></munder><msup><mi>A</mi><mn>2</mn></msup><mrow><mo>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>)</mo></mrow><mi>d</mi><mi>x</mi><mi>d</mi><mi>y</mi><mo>,</mo></math>"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "using the orthogonality of the Fourier components (<i>i.e.</i>, Parseval\u2019s theorem) to perform the integrals over <math id=\"inf377\"><mrow><msup><mi>P</mi><mn>2</mn></msup><mrow><mo>(</mo><mrow><mi>x</mi><mo>,</mo><mi>y</mi></mrow><mo>)</mo></mrow></mrow></math> and <math id=\"inf378\"><msup><mi>A</mi><mn>2</mn></msup><mrow><mo>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>)</mo></mrow></math>, we get"
                            }, 
                            {
                                "type": "mathml", 
                                "id": "equ71", 
                                "mathml": "<math><mn>2</mn><msubsup><mover><mi>J</mi><mo>^</mo></mover><mrow><mn>1</mn><mo>,</mo><mn>0</mn></mrow><mn>2</mn></msubsup><mo>+</mo><mn>2</mn><msubsup><mover><mi>J</mi><mo>^</mo></mover><mrow><mn>0</mn><mo>,</mo><mn>1</mn></mrow><mn>2</mn></msubsup><mo>\u2264</mo><munderover><mo>\u2211</mo><mrow><msub><mi>m</mi><mi>x</mi></msub><mo>=</mo><mo>\u2212</mo><mi>\u221e</mi></mrow><mi>\u221e</mi></munderover><munderover><mo>\u2211</mo><mrow><msub><mi>m</mi><mi>y</mi></msub><mo>=</mo><mo>\u2212</mo><mi>\u221e</mi></mrow><mi>\u221e</mi></munderover><msubsup><mover><mi>J</mi><mo>^</mo></mover><mrow><msub><mi>m</mi><mi>x</mi></msub><mo>,</mo><msub><mi>m</mi><mi>y</mi></msub></mrow><mn>2</mn></msubsup><mo>\u2212</mo><mn>2</mn><msubsup><mover><mi>J</mi><mo>^</mo></mover><mrow><mn>1</mn><mo>,</mo><mn>0</mn></mrow><mn>2</mn></msubsup><mo>\u2212</mo><mn>2</mn><msubsup><mover><mi>J</mi><mo>^</mo></mover><mrow><mn>0</mn><mo>,</mo><mn>1</mn></mrow><mn>2</mn></msubsup><mo>.</mo></math>"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "Lastly, plugging in the normalization constraint <math id=\"inf379\"><mrow><mstyle displaystyle=\"true\"><munderover><mo>\u2211</mo><mrow><msub><mi>m</mi><mi>x</mi></msub><mo>=</mo><mo>\u2212</mo><mi>\u221e</mi></mrow><mi>\u221e</mi></munderover><mrow><mstyle displaystyle=\"true\"><munderover><mo>\u2211</mo><mrow><msub><mi>m</mi><mi>y</mi></msub><mo>=</mo><mo>\u2212</mo><mi>\u221e</mi></mrow><mi>\u221e</mi></munderover><mrow><msubsup><mover accent=\"true\"><mi>J</mi><mo>^</mo></mover><mrow><msub><mi>m</mi><mi>x</mi></msub><mo>,</mo><msub><mi>m</mi><mi>y</mi></msub></mrow><mn>2</mn></msubsup></mrow></mstyle></mrow></mstyle><mo>=</mo><mn>1</mn></mrow></math>, we find"
                            }, 
                            {
                                "type": "mathml", 
                                "id": "equ72", 
                                "mathml": "<math><mrow><mfrac><mn>1</mn><mn>4</mn></mfrac><mo>\u2265</mo><msubsup><mover accent=\"true\"><mi>J</mi><mo>^</mo></mover><mrow><mn>1</mn><mo>,</mo><mn>0</mn></mrow><mn>2</mn></msubsup><mo>+</mo><msubsup><mover accent=\"true\"><mi>J</mi><mo>^</mo></mover><mrow><mn>0</mn><mo>,</mo><mn>1</mn></mrow><mn>2</mn></msubsup></mrow></math>"
                            }, 
                            {
                                "type": "paragraph", 
                                "text": "as required."
                            }
                        ]
                    }
                ]
            }
        ], 
        "acknowledgements": [
            {
                "type": "paragraph", 
                "text": "We would like to thank Alexander Mathis and Omri Barak for comments on the manuscript, and Gilad Tocker and Matan Sela for helpful discussions and advice. The research was supported by the Israel\u00a0Science\u00a0Foundation grants 955/13 and 1882/13, by a Rappaport Institute grant, and by the Allen and Jewel Prince Center for Neurodegenerative Disorders of the Brain. The work of RM and Y D was partially supported by the Ollendorff Center of the Department of Electrical Engineering, Technion. DD is a David and Inez Myers Career Advancement Chair in Life Sciences fellow.\u00a0The work of DS was partially supported by the Gruss Lipper Charitable Foundation, and by the Intelligence Advanced Research Projects Activity (IARPA) via Department of Interior/Interior Business Center (DoI/IBC) contract number D16PC00003. The U.S. Government is authorized to reproduce and distribute reprints for Governmental purposes notwithstanding any copyright annotation thereon. Disclaimer: The views and conclusions contained herein are those of the authors and should not be interpreted as necessarily representing the official policies or endorsements, either expressed or implied, of IARPA, DoI/IBC, or the U.S. Government."
            }
        ], 
        "decisionLetter": {
            "doi": "10.7554/eLife.10094.027", 
            "description": [
                {
                    "type": "paragraph", 
                    "text": "In the interests of transparency, eLife includes the editorial decision letter and accompanying author responses. A lightly edited version of the letter sent to the authors after peer review is shown, indicating the most substantive concerns; minor comments are not usually included."
                }
            ], 
            "content": [
                {
                    "type": "paragraph", 
                    "text": "Thank you for submitting your work entitled \"Extracting grid characteristics from spatially distributed place cell inputs using non-negative PCA\" for peer review at <i>eLife</i>. Your submission has been favorably evaluated by Timothy Behrens (Senior editor), Reviewing editor Michael Frank, and two reviewers."
                }, 
                {
                    "type": "paragraph", 
                    "text": "The reviewers have discussed the reviews with one another and the Reviewing editor has drafted this decision to help you prepare a revised submission."
                }, 
                {
                    "type": "paragraph", 
                    "text": "Summary:"
                }, 
                {
                    "type": "paragraph", 
                    "text": "The authors present analytical and neural network simulations which demonstrate that, under certain constraints, the first principal component of place cell firing patterns in a 2D arena resemble hexagonal grid cell firing patterns. Specifically, these constraints require that the principal components be constrained to non-negativity, and that the place cell inputs have a zero mean in time or space. In addition, they suggest that interesting features of grid cell firing, namely the tendency for grid scale to be discretely clustered, and for the grid to align at approximately 7 degrees to the walls of a square arena. This is an important result which adds to a growing body of recent studies that have emphasised the importance of the projection from place cells to grid cells, as opposed to the grid cell to place cell projection that has been the subject of several previous theoretical studies."
                }, 
                {
                    "type": "paragraph", 
                    "text": "As you will see however, the Reviewers felt that it was important to provide some intuition and cogent explanation about how the results were obtained, and several questions arose along these lines. It is not clear how the dual constraints of (eigenvector) non-negativity and orthogonality are actually satisfied, nor is it clear why they get 7degree alignment or a ratio of 1.4 for the jump in grid scale."
                }, 
                {
                    "type": "paragraph", 
                    "text": "In addition to the revisions articulated below, the following suggestion arose from discussion amongst the Reviewers/editors."
                }, 
                {
                    "type": "paragraph", 
                    "text": "<a href=\"#fig13\">Figure 13</a> of the manuscript tracks the evolution of the network from different initial conditions."
                }, 
                {
                    "type": "paragraph", 
                    "text": "One might go some way in clarifying the questions of how and why the observed phenomena occur by tracking individual objective measures, in a manner similar to <a href=\"#fig13\">Figure 13</a>."
                }, 
                {
                    "type": "paragraph", 
                    "text": "To wit, one of the algorithms you use trades off two objectives:"
                }, 
                {
                    "type": "paragraph", 
                    "text": "(i) maximize the variance of the projection of the data onto the [non-negative] principal component"
                }, 
                {
                    "type": "paragraph", 
                    "text": "(ii) enforce approximate orthogonormality by minimizing || I \u2013 e<sup>T</sup> e||, where I is the identity matrix, and e is the normalized \"eigenvector,\" subject to the non-negativity constraint."
                }, 
                {
                    "type": "paragraph", 
                    "text": "In addition, one ought to quantify the degree of non-negativity. There are several ways one might go about this, but one approach would be to normalize the eigenvector to unit length, then take the norm of the vector composed of only the positive entries and subtract the norm of the vector of negative entries."
                }, 
                {
                    "type": "paragraph", 
                    "text": "Essential revisions:"
                }, 
                {
                    "type": "paragraph", 
                    "text": "1) This manuscript is of sufficient general interest for publication in <i>eLife</i>, although there is a general lack of detail when describing the methodology. There is also significant overlap with a recent paper at NIPS 2014 (Stachenfeld et al., 2014). I find both papers (Dordek et al., submitted, and Stachenfeld et al.) extremely interesting, and they both have different focusses. But I do think that there needs to be some link to/discussion of Stachenfeld et al."
                }, 
                {
                    "type": "paragraph", 
                    "text": "2) Perhaps the most important issue is that they provide little intuition into the interesting subsidiary results. There is a section on \"Why Hexagons?\" but none on why other aspects of the results occur. This becomes more important given the fact that Stachenfeld also see the basic result. Why do grid scales have a ratio of 1.4 (indeed is this figure reliable)? Why do they see a non-zero alignment of grids to borders (and is this figure reliable)? Alignment angle appears to depend on place field size, but how does overall place cell firing coverage (and covariance) vary with place field size? How does the alignment angle covary with gridness (the very nice grid-like patterns they show tend to look aligned)?"
                }, 
                {
                    "type": "paragraph", 
                    "text": "3) \"Due to the isotropic nature of the data (generated by the agent's motion), there was a 2D redundancy in the X-Y plane in conjunction with a dual phase redundancy in 1D, resulting in a fourfold total redundancy of every solution\" \u2013 this statement requires unpacking. Presumably the dual phase redundancy is caused by the periodic boundary conditions? What are the implications for non-periodic boundary conditions? This sentence needs to be explained to the non-expert reader."
                }, 
                {
                    "type": "paragraph", 
                    "text": "4) Similarly, <a href=\"#fig4\">Figure 4A</a> is cryptic \u2013 how does the figure show fourfold redundancy? The authors also use a reduced number of place cells to obtain this result (225 vs. 625 in other simulations) \u2013 what are the reasons for this change? This should be explained and justified in the text."
                }, 
                {
                    "type": "paragraph", 
                    "text": "5) More generally, when changing place field size, what happens to the number of place cells \u2013 presumably the density of firing overlap (covariance) needs to be maintained as this will strongly affect the results?"
                }, 
                {
                    "type": "paragraph", 
                    "text": "6) It is not clear how the non-negative weights are implemented alongside zero mean inputs, and we could not gain any additional insight from the Methods section. This issue needs to be elaborated upon in the text, otherwise it seems implicitly contradictory. Does it imply that the output GC can have negative firing rates? i.e. are there positive and negative place cell firing rates (with a mean of zero), coupled with positive place cell to grid cell synaptic weights, to give both negative and positive inputs to the output grid cell? Presumably the time step to time step changes in grid cell firing rate between negative and positive values will have a large impact on the direction of synaptic weight change \u2013 is this the case?"
                }, 
                {
                    "type": "paragraph", 
                    "text": "7) <a href=\"#fig7\">Figure 7C, D</a>; also 14B \u2013 the analytical PCA results for constrained weights appear to exhibit a bimodal distribution of 90 degree gridness scores \u2013 what in the data accounts for this? Can the authors provide any comment or insight?"
                }, 
                {
                    "type": "paragraph", 
                    "text": "\"The dependency was almost linear\" \u2013 presumably there is a mathematical reason for this, based on the relationship between the covariance matrix and eigenvectors? Can the authors provide any comment or insight into this relationship?"
                }, 
                {
                    "type": "paragraph", 
                    "text": "8) The methods are generally lacking in detail that would allow these simulations to be replicated, based on details provided in the manuscript (see specific details below). The authors should ensure that sufficient detail to allow replication is incorporated. They may also like to consider uploading their code to ModelDB, or a similar online repository, for the sake of transparency and to allow independent replication."
                }, 
                {
                    "type": "paragraph", 
                    "text": "9) The representation of space lies on a torus in this model, which means that the eigenvectors should be periodic and the spatial frequencies quantized. We fail to grasp why, in <a href=\"#fig3\">Figure 3</a>, the first spatial frequency should be 2 and not 1 (i.e., we have two peaks in each direction), and why the eigenvectors 3B is periodic, but in 3A they are not."
                }, 
                {
                    "type": "paragraph", 
                    "text": "10) The eigenvectors of a correlation matrix are orthogonal. If we normalize these eigenvectors and furthermore enforce an additional constraint that the entries of each eigenvector must be positive semidefinite, then the \"synaptic weights\" of different eigenvectors should not overlap. In other words, if an entry in the first eigenvector is non-zero, it ought to be zero in all other eigenvectors."
                }, 
                {
                    "type": "paragraph", 
                    "text": "11) While the algorithms the authors use relax this last constraint, it is not clear how skewing or shearing a square pattern that results from PCA helps satisfy the dual constraints of non-negativity and orthogonality."
                }, 
                {
                    "type": "paragraph", 
                    "text": "This is a key point in the paper, and begs for an intuitive explanation, or at least more analysis or quantification of the degree to which the constraints are satisfied."
                }, 
                {
                    "type": "paragraph", 
                    "text": "12) The finding that the spacings corresponding to successive eigenvectors obey ~ <math id=\"inf380\"><mrow><msqrt><mn>2</mn></msqrt></mrow></math> also calls for an explanation. Why should this ratio of spacings best satisfy non-negativity, orthogonality, and periodicity?"
                }, 
                {
                    "type": "paragraph", 
                    "text": "[Editors' note: further revisions were requested prior to acceptance, as described below.]"
                }, 
                {
                    "type": "paragraph", 
                    "text": "Thank you for resubmitting your work entitled \"Extracting grid characteristics from spatially distributed place cell inputs using non-negative PCA\" for further consideration at <i>eLife</i>. Your revised article has been favorably evaluated by Timothy Behrens (Senior editor), Reviewing editor Michael Frank, and two reviewers, one of whom is Neil Burgess. The manuscript has been improved but both reviewers have identified some remaining issues that need to be addressed before acceptance, as articulated in the comments below:"
                }, 
                {
                    "type": "paragraph", 
                    "text": "<i>Reviewer #1:</i> "
                }, 
                {
                    "type": "paragraph", 
                    "text": "The authors have worked hard to provide further intuition and interpretation to their results, with much success, although there are still some points that should be clarified, see comments below."
                }, 
                {
                    "type": "paragraph", 
                    "text": "There is also a plain error that should be removed. The authors state \"the distribution of grid orientations becomes uniform in the range of 0-15 degrees, with a mean (and median) at 7.5 degrees, similar to experimental data [Stensola et al., 2015]\". On the contrary the experimental data shows a very non-uniform distribution clearly peaked at about 7.5 degrees, which is quite different. Also, as a circular variable limited to [0,15) \u2013 albeit one for which 16 degrees corresponds to 14 degrees rather than 1 degree \u2013 the 'mean' and 'median' they refer to are undefined if the distribution is uniform. Thus the authors should acknowledge that they do not provide an explanation for this aspect of the experimental data, and some of the text/ results on this point could be removed, most importantly in the Abstract."
                }, 
                {
                    "type": "paragraph", 
                    "text": "At the start of describing the main result (Results, first paragraph) is not clear that the \"1d mapping of the 2d activity\" is caused by the trajectory of the rat moving through the place fields."
                }, 
                {
                    "type": "paragraph", 
                    "text": "The next part of the description of their PCA analysis as Eigenvectors and their spatial interpretation could also be improved in terms of intuition. It would be worth mentioning that the PCA, in addition to being calculated as the Eigenvectors of the matrix of temporal covariance between inputs, can also be thought of in terms of singular value decomposition of the (appropriately normalised) input activity. I.e. the input to the network (temporal sequences of place cell activity) can be decomposed into an outer product of (spatial) weights over place cell inputs (their Eigenvectors) and temporally varying weights over these Eigenvectors. The network learns the spatial weights over place cells (the Eigenvectors) as the connections weights from the place cells, and \"projection onto place cell space\" is simply the firing rates of the output neuron plotted against the location of the rat."
                }, 
                {
                    "type": "paragraph", 
                    "text": "In the second paragraph of the subsection \u201cAdding a non-Negativity constraint to the PCA \u201cit is important to remind the reader that the \"raw place cells activity\" is not the final input to the PCA numerical methods \u2013 spatial or temporal mean normalization has to happen first."
                }, 
                {
                    "type": "paragraph", 
                    "text": "It would be useful to have a surface plot showing Gridness vs. PC Density vs. PC Width. I have found it hard to replicate the Gridness distribution and wonder how general it is to the precise place cell inputs used? The reference to <a href=\"#fig10\">Figure 10A</a> in the third paragraph of the subsection \u201cEffect of place cell parameters on grid structure \u201cis incorrect (I think) \u2013 not showing the dependence on the width of the place fields."
                }, 
                {
                    "type": "paragraph", 
                    "text": "Regarding the presence of \"modules\" of grid cells (subsection \u201cModules of grid cells\u201d), it is not clear if the interpretation is that different modules correspond to different grid scales, or different Eigenvectors (even if having the same scale). Assuming the latter, it seems that the analysis predicts that there should only be two modules, with the scale of the first module approximately 7.5x the largest place field inputs, and the second module (~<math id=\"inf381\"><mrow><msqrt><mn>2</mn></msqrt></mrow></math> smaller) existing only to enable non-negative PCA solutions. This deserves discussion, given that the data show at least 5 modules, with a range of scales, the smallest and most numerous having approximately the scale of the smaller place fields found in the dorsal hippocampus (25-30 cm)."
                }, 
                {
                    "type": "paragraph", 
                    "text": "<i>Reviewer #2:</i> "
                }, 
                {
                    "type": "paragraph", 
                    "text": "The new material, starting with the subsection \u201cSteady state analysis \u201cis great, and just the thing I was asking for, namely an understanding as to <i>why</i> hexagonal patterns result under a non-negative PCA learning rule."
                }, 
                {
                    "type": "paragraph", 
                    "text": "There are a few things I'd like to understand better, though:"
                }, 
                {
                    "type": "paragraph", 
                    "text": "The last equation in the section \u201c2D Solutions\u201d: should read <i>\u03d5<sub>1</sub> = \u03d5<sub>2</sub> = \u03d5<sub>3</sub></i>n 2 \u03c0/3, n \u03f5 Z. e.g. <i>\u03d5<sub>1</sub> = \u03d5<sub>2</sub> = \u03d5<sub>3</sub></i>= 0 would be a solution."
                }, 
                {
                    "type": "paragraph", 
                    "text": "As written, <i>\u03d5<sub>1</sub> = \u03d5<sub>2</sub> = \u03d5<sub>3</sub></i>, is not the maximum. Besides, this more general case would allow solutions that are unlike the ones observed in experiments."
                }, 
                {
                    "type": "paragraph", 
                    "text": "This brings me to"
                }, 
                {
                    "type": "paragraph", 
                    "text": "In the subsection \u201c2D solutions\u201d:"
                }, 
                {
                    "type": "paragraph", 
                    "text": "\"To do this [maximize the Fourier components inside the basis set,] we must maximize the minimal value of the cosine components for the basis set\""
                }, 
                {
                    "type": "paragraph", 
                    "text": "I am afraid this argument escapes me, even though its role is crucial."
                }, 
                {
                    "type": "paragraph", 
                    "text": "While I think I understand the Fourier domain argument up to this point in the text, how exactly does maximizing the minimum value in real space of the function guarantee that the Fourier components in Eq. 24 are maximized?"
                }, 
                {
                    "type": "paragraph", 
                    "text": "Eq. 34: why is the upper limit here \u221e, when it was <i>M</i> in Eq. 33?"
                }, 
                {
                    "type": "paragraph", 
                    "text": "I'd like some clarification from the authors before I can make a judgment call as to whether the argument is likely to be correct."
                }
            ]
        }, 
        "authorResponse": {
            "doi": "10.7554/eLife.10094.028", 
            "content": [
                {
                    "type": "paragraph", 
                    "text": "<i>As you will see however, the Reviewers felt that it was important to provide some intuition and cogent explanation about how the results were obtained, and several questions arose along these lines. It is not clear how the dual constraints of (eigenvector) non-negativity and orthogonality are actually satisfied, nor is it clear why they get 7degree alignment or a ratio of 1.4 for the jump in grid scale.</i> Re-analysis demonstrates that we tend to get values which are on average a little lower than 7 degrees (Author response <a href=\"#fig3\">images 3</a> and <a href=\"#fig4\">4</a>). <span class=\"underline\">However</span>, the range of possible values is from 0 to 15 degrees, and we demonstrate analytically (in the new extended Methods section) that in the case of a very large box, the distribution of orientation angles becomes uniform in the interval 0-15, with a mean at 7.5 degrees, consistent with experimental data."
                }, 
                {
                    "type": "paragraph", 
                    "text": "The jump of 1.4 results from the change in the circular components of the solution in Fourier space (See especially new <a href=\"#fig17\">Figure 17</a> in Methods section of paper). From running more simulations and also from analytical considerations, we believe that within our theoretical framework there is only one jump, and thus this model can really only explain 2 modules and not more (see analytical derivation for more intuition on this point)."
                }, 
                {
                    "type": "paragraph", 
                    "text": "In addition to the new extended Methods section, we have updated the Abstract and Results (throughout) to account for these changes."
                }, 
                {
                    "type": "paragraph", 
                    "text": "<i>In addition to the revisions articulated below, the following suggestion arose from discussion amongst the Reviewers/editors. [\u2026]</i>"
                }, 
                {
                    "type": "paragraph", 
                    "text": " <i>In addition, one ought to quantify the degree of non-negativity. There are several ways one might go about this, but one approach would be to normalize the eigenvector to unit length, then take the norm of the vector composed of only the positive entries and subtract the norm of the vector of negative entries.</i> "
                }, 
                {
                    "type": "paragraph", 
                    "text": "We thank the editors and reviewers for raising this essential issue. In our understanding, the main issue is to comprehend to what extent we can combine maximal -variance, orthogonality, and positivity together, when looking at multiple outputs (such as in old <a href=\"#fig11\">Figures 11</a> and <a href=\"#fig12\">12</a>, or new <a href=\"#fig13\">Figures 13</a> and <a href=\"#fig14\">14</a>). As we demonstrate now, the outputs from the method are not orthogonal (<a href=\"#fig18\">Author response image 1</a>), and this we believe solves the conundrum. We now added a short comment about this into the Results section: \u201cIt is important to note though that, due to the non-negativity constraint, the vectors achieved in this way were not orthogonal, and thus it cannot be considered a real orthogonalization process, although as explained in the Methods section, the process does aim for maximum difference between the vectors\u201d"
                }, 
                {
                    "type": "image", 
                    "doi": "10.7554/eLife.10094.023", 
                    "id": "fig18", 
                    "label": "Author response image 1.", 
                    "title": "Demonstrates that output vectors are not orthogonal.", 
                    "caption": [
                        {
                            "type": "paragraph", 
                            "text": "Matrix of cosine values between every two vectors."
                        }
                    ], 
                    "alt": "", 
                    "uri": "https://publishing-cdn.elifesciences.org/10094/elife-10094-resp-fig1-v2.tif", 
                    "filename": "elife-10094-resp-fig1-v2.tif"
                }, 
                {
                    "type": "paragraph", 
                    "text": " <i>Essential revisions: 1) This manuscript is of sufficient general interest for publication in eLife, although there is a general lack of detail when describing the methodology.</i> "
                }, 
                {
                    "type": "paragraph", 
                    "text": "Additional detail has been added to the Methods. Furthermore, extensive sections have been added to the Methods in order to provide an analytical motivation to the whole paper (from the subsection \u201cSteady state analysis\u201d). See detailed points below in the section related to Methods. Furthermore, we have uploaded our MATLAB code to a public server, as described below."
                }, 
                {
                    "type": "paragraph", 
                    "text": "<i>There is also significant overlap with a recent paper at NIPS 2014 (Stachenfeld et al., 2014). I find both papers (Dordek et al., submitted, and Stachenfeld et al) extremely interesting, and they both have different focusses. But I do think that there needs to be some link to/discussion of Stachenfeld et al.</i> "
                }, 
                {
                    "type": "paragraph", 
                    "text": "Stachnfeld et al. arrive to similar ideas in a very nice paper based on a reinforcement learning model of place cells. Unlike our paper, their paper does not contain the positivity constraint, and thus the \u201cgrid cells\u201d that results from the PCA procedure they use are square rather than hexagonal. Furthermore, they did not provide a theoretical analysis of the nature provided in the revision. We now discuss their paper in the Discussion, as follows: \u201cWe note that similar work has noticed the relation between place-cell-to-grid-cell transformation and PCA.[\u2026] However, due to the unconstrained nature of their transformation, the outputted grid cells were square-like.\u201d"
                }, 
                {
                    "type": "paragraph", 
                    "text": "<i>2) Perhaps the most important issue is that they provide little intuition into the interesting subsidiary results. There is a section on \"Why Hexagons?\" but none on why other aspects of the results occur. This becomes more important given the fact that Stachenfeld also see the basic result. Why do grid scales have a ratio of 1.4 (indeed is this figure reliable)?</i> "
                }, 
                {
                    "type": "paragraph", 
                    "text": "Following the new analytical derivation in the Methods section (from the subsection \u201cSteady state analysis\u201d), we can now explain the jump of scale as a hop on the Fourier-space lattice (new <a href=\"#fig17\">Figure 17</a> in paper)."
                }, 
                {
                    "type": "paragraph", 
                    "text": "We have now re-run the multiple solutions in order to demonstrate a jump between two consecutive scales. However, we find that it is harder to see the jump to the next smaller third scale, and thus we conclude that the method only partially accounts for the effect of modules. This is now noted in the Results as follows: \u201c[\u2026]we found that the ratio between the distances of the modules was ~1.4, close to the value of 1.42 found by Stensola et al. [Stensola et al., 2012]. Although we searched for additional such jumps, we could only identify this single jump, suggesting that our model can yield up to two \u201cmodules\u201d and not more.\u201d"
                }, 
                {
                    "type": "paragraph", 
                    "text": "<i>Why do they see a non-zero alignment of grids to borders (and is this figure reliable)?</i> "
                }, 
                {
                    "type": "paragraph", 
                    "text": "As we now show in our analytical derivation, the non-zero alignment can arise from the relation between the lattice points in the Fourier domain and the optimal-solution circle. This is now explainedthoroughly in the new sections added to the Methods from the subsection \u201cSteady state analysis\u201d and in <a href=\"#fig15\">Figure 15</a>\u2013<a href=\"#fig16\">16</a> in paper."
                }, 
                {
                    "type": "paragraph", 
                    "text": "<i>Alignment angle appears to depend on place field size, but how does overall place cell firing coverage (and covariance) vary with place field size?</i> "
                }, 
                {
                    "type": "paragraph", 
                    "text": "In our previous submission we manipulated the place field size while keeping the size of the arena and number of place cells constant. Thus the coverage has increased as a function of the increase in size. Here (<a href=\"#fig19\">Author response image 2</a>) we show an example of increasing both the place field size and the size of the arena, while keeping the place-cell-size/arena size constant, such that the total coverage increases (a place cell on every pixel)."
                }, 
                {
                    "type": "paragraph", 
                    "text": "<i>How does the alignment angle covary with gridness (the very nice grid-like patterns they show tend to look aligned)?</i> "
                }, 
                {
                    "type": "paragraph", 
                    "text": "In <a href=\"#fig19\">Author response image 2b</a> we plot grid orientation as a function of gridness. As can be seen the two quantities are not strongly related:"
                }, 
                {
                    "type": "image", 
                    "doi": "10.7554/eLife.10094.024", 
                    "id": "fig19", 
                    "label": "Author response image 2.", 
                    "title": "Example of changing width of place cells (\u03c3) and correspondingly changing arena size, such that there is a fixed ratio: arena_size/\u03c3 = 40.", 
                    "caption": [
                        {
                            "type": "paragraph", 
                            "text": "(FISTA algorithm was used for positive PCA, with 0 boundary conditions.) (<b>a</b>) Grid scale as a function of \u03c3 (place cell width); (<b>b</b>) Grid orientation as a function of \u03c3. (<b>c</b>) Histogram of grid orientations (<b>d</b>) Mean gridness as a function of \u03c3. (<b>e</b>) Histogram of mean gridness."
                        }
                    ], 
                    "alt": "", 
                    "uri": "https://publishing-cdn.elifesciences.org/10094/elife-10094-resp-fig2-v2.tif", 
                    "filename": "elife-10094-resp-fig2-v2.tif"
                }, 
                {
                    "type": "image", 
                    "doi": "10.7554/eLife.10094.025", 
                    "id": "fig20", 
                    "label": "Author response image 3.", 
                    "title": "Effect of changing the place-field size in a constant boundary (FISTA algorithm used; zero boundary conditions and Arena size 500);", 
                    "caption": [
                        {
                            "type": "paragraph", 
                            "text": "(<b>A</b>) Grid scale as a function of place field size (\u03c3); Linear fit is: Scale = 7.4. \u03a3+0.62; the lower bound is equal to , where <math id=\"inf382\"><msub><mi>k</mi><mo>\u2020</mo></msub></math> is defined in Eq. 32 in the Methods section; (<b>B</b>) Grid orientation as a function of gridness (green line is the mean); (<b>C</b>) Grid orientation as a function of \u03c3 \u2013 scatter plot (blue stars) and mean (green line); (<b>D</b>) Histogram of grid orientations; (<b>E</b>) Mean gridness as a function of \u03c3; and (<b>F</b>) Histogram of mean gridness."
                        }
                    ], 
                    "alt": "", 
                    "uri": "https://publishing-cdn.elifesciences.org/10094/elife-10094-resp-fig3-v2.tif", 
                    "filename": "elife-10094-resp-fig3-v2.tif"
                }, 
                {
                    "type": "paragraph", 
                    "text": "<i>3) \"Due to the isotropic nature of the data (generated by the agent's motion), there was a 2D redundancy in the X-Y plane in conjunction with a dual phase redundancy in 1D, resulting in a fourfold total redundancy of every solution\" \u2013 this statement requires unpacking. Presumably the dual phase redundancy is caused by the periodic boundary conditions?</i> "
                }, 
                {
                    "type": "paragraph", 
                    "text": "We have now devoted a large section in the Methods to analytical considerations, which can explain the fourfold redundancy. Thus we changed the wording of the above paragraph to the following: \u201cThe solution demonstrated a fourfold redundancy (<a href=\"#fig4\">Figure 4C</a>). This was apparent in the plotted eigenvalues (from largest to the smallest eigenvalue, <a href=\"#fig4\">Figure 4A and 4C</a>), which demonstrated a fourfold grouping-pattern. The fourfold redundancy can be explained analytically by the symmetries of the system \u2013 see PCA analysis in Methods section.\u201d"
                }, 
                {
                    "type": "paragraph", 
                    "text": "<i>What are the implications for non-periodic boundary conditions? This sentence needs to be explained to the non-expert reader.</i> "
                }, 
                {
                    "type": "paragraph", 
                    "text": "In the case of very large arenas, it does not matter what the boundary conditions are. In smaller arenas, the nature of the boundary conditions (i.e. how the place cells behave at the boundary) has an effect. It seems from our simulations that the boundary conditions matter less for the scale of the grid and more for the grid orientation (Compare Author response <a href=\"#fig3\">images 3</a> and <a href=\"#fig4\">4</a>). We now note in the Results section: \u201c[\u2026]for very large environments the effects of boundary conditions diminish.\u201d."
                }, 
                {
                    "type": "image", 
                    "doi": "10.7554/eLife.10094.026", 
                    "id": "fig21", 
                    "label": "Author response image 4.", 
                    "title": "Effect of changing the place-field size in a constant boundary (FISTA algorithm used; periodic boundary conditions and Arena size 500);", 
                    "caption": [
                        {
                            "type": "paragraph", 
                            "text": "(<b>A</b>) Grid scale as a function of place field size (\u03c3); Linear fit is: Scale = 7.4 \u03a3+0.62; the lower bound, equal to <math id=\"inf383\"><mn>2</mn><mi>\u03c0</mi><mo>/</mo><msub><mi>k</mi><mo>\u2020</mo></msub></math>, were <math id=\"inf384\"><msub><mi>k</mi><mo>\u2020</mo></msub></math> is defined in Eq. 32 in the Methods section; (<b>B</b>) Grid orientation as a function of gridness; (<b>C</b>) Grid orientation as a function of \u03c3 \u2013 scatter plot (blue stars) and mean (green line); (<b>D</b>) Histogram of grid orientations; (<b>E</b>) Mean gridness as a function of \u03c3; and (<b>F</b>) Histogram of mean gridness."
                        }
                    ], 
                    "alt": "", 
                    "uri": "https://publishing-cdn.elifesciences.org/10094/elife-10094-resp-fig4-v2.tif", 
                    "filename": "elife-10094-resp-fig4-v2.tif"
                }, 
                {
                    "type": "paragraph", 
                    "text": "<!--<a href=\"#fig21\"-->Author response image 4 title/legend&gt;"
                }, 
                {
                    "type": "paragraph", 
                    "text": "<i>4) Similarly, <a href=\"#fig4\">Figure 4A</a> is cryptic \u2013 how does the figure show fourfold redundancy? The authors also use a reduced number of place cells to obtain this result (225 vs. 625 in other simulations) \u2013 what are the reasons for this change? This should be explained and justified in the text.</i> We have improved the figure by increasing the resolution and using the same number of points for both sub-figures. Now the fourfold redundancy is quite clear (<a href=\"#fig4\">Figure 4C</a>). We updated <a href=\"#fig4\">Figure 4</a> to contain all 625 values, and have also added an additional panel to emphasize the fourfold redundancy."
                }, 
                {
                    "type": "paragraph", 
                    "text": "<i>5) More generally, when changing place field size, what happens to the number of place cells \u2013 presumably the density of firing overlap (covariance) needs to be maintained as this will strongly affect the results?</i> "
                }, 
                {
                    "type": "paragraph", 
                    "text": "<a href=\"#fig19\">Author response image 2</a> above demonstrates that results are not strongly dependent on the place cell overlap."
                }, 
                {
                    "type": "paragraph", 
                    "text": " <i>6) It is not clear how the non-negative weights are implemented alongside zero mean inputs, and we could not gain any additional insight from the Methods section. This issue needs to be elaborated upon in the text, otherwise it seems implicitly contradictory. Does it imply that the output GC can have negative firing rates? i.e. are there positive and negative place cell firing rates (with a mean of zero), coupled with positive place cell to grid cell synaptic weights, to give both negative and positive inputs to the output grid cell?</i> "
                }, 
                {
                    "type": "paragraph", 
                    "text": "The grid cells were not clipped to zero so they did obtain negative values. In order to realize this in real neurons we will need to assume a general baseline firing which will account for the fact that real neurons do not have negative firing rates."
                }, 
                {
                    "type": "paragraph", 
                    "text": "<i>Presumably the time step to time step changes in grid cell firing rate between negative and positive values will have a large impact on the direction of synaptic weight change \u2013 is this the case?</i> "
                }, 
                {
                    "type": "paragraph", 
                    "text": "Yes, this is indeed the case, as far as we understand the comment."
                }, 
                {
                    "type": "paragraph", 
                    "text": " <i>7) <a href=\"#fig7\">Figure 7C, D</a>; also 14B \u2013 the analytical PCA results for constrained weights appear to exhibit a bimodal distribution of 90 degree gridness scores \u2013 what in the data accounts for this? Can the authors provide any comment or insight?</i> "
                }, 
                {
                    "type": "paragraph", 
                    "text": "The bi-modal distribution was a result of the formation of two populations, one with small orientations to one of the walls and another with small orientation to the other wall. We believe this is not an essential result, but cannot provide a full explanation for this phenomenon."
                }, 
                {
                    "type": "paragraph", 
                    "text": " <i>\"The dependency was almost linear\" \u2013 presumably there is a mathematical reason for this, based on the relationship between the covariance matrix and eigenvectors? Can the authors provide any comment or insight into this relationship?</i> "
                }, 
                {
                    "type": "paragraph", 
                    "text": "This relation is now explained from the added analytical model. The predicted value provides a tight lower bound on the actual relation, as can be seen from the results of simulations in <a href=\"#fig20\">Author response image 3</a> and <a href=\"#fig21\">4</a> above, where the actual values were that the grid scale is about 7.5 times the width of the place field."
                }, 
                {
                    "type": "paragraph", 
                    "text": "Intuitively, the linear dependency between the place cell width and the grid cell spacing must be true in the limit of infinite box size, from dimensional analysis: the length units of the grid cell spacing must be the same length units of the place cell width, since these are the only length units in the model. This is explained mathematically in the unconstrained case by Equation 32, as we detail below that equation:"
                }, 
                {
                    "type": "paragraph", 
                    "text": "\"Notice that if we multiply the place cell width by some positive constant c, then the solution 2pi/k\u2020 will be divided by c. [\u2026] When the box has finite size, k-lattice discretization also has a (usually small) effect on the grid spacing.\""
                }, 
                {
                    "type": "paragraph", 
                    "text": "A similar reasoning can be applied to the constrained case."
                }, 
                {
                    "type": "paragraph", 
                    "text": " <i>8) The methods are generally lacking in detail that would allow these simulations to be replicated, based on details provided in the manuscript (see specific details below). The authors should ensure that sufficient detail to allow replication is incorporated. They may also like to consider uploading their code to ModelDB, or a similar online repository, for the sake of transparency and to allow independent replication.</i> "
                }, 
                {
                    "type": "paragraph", 
                    "text": "We have followed the advice given and have now uploaded our code to <span class=\"underline\">t</span>"
                }, 
                {
                    "type": "paragraph", 
                    "text": "This is also noted at the beginning of the Methods section."
                }, 
                {
                    "type": "paragraph", 
                    "text": "<i>9) The representation of space lies on a torus in this model, which means that the eigenvectors should be periodic and the spatial frequencies quantized. We fail to grasp why, in <a href=\"#fig3\">Figure 3</a>, the first spatial frequency should be 2 and not 1 (i.e., we have two peaks in each direction),</i> "
                }, 
                {
                    "type": "paragraph", 
                    "text": "Indeed the spatial frequencies are quantized by the box dimensions. However, the eigenvectors periodicity is not determined by the box, as we now explain mathematically in extended Methods section. Even in the case that the box size is infinite, we get a finite periodic solution, with spatial frequency equal to the peak of the Fourier transform of the place cell tuning curve \u2013 given in Equation 32. When the box size is finite this spatial frequency is also affected by the quantization due to the box dimensions (<a href=\"#fig15\">Figure 15</a>)."
                }, 
                {
                    "type": "paragraph", 
                    "text": "<i>and why the eigenvectors 3B is periodic, but in 3A they are not.</i> "
                }, 
                {
                    "type": "paragraph", 
                    "text": "In <a href=\"#fig3\">Figure 3B</a> we show multiple examples of the 1<sup>st</sup> principal component as output from the network, while in <a href=\"#fig3\">Figure 3A</a> we show the first 16 components of the PCA algorithm. Thus both figures do not show the same thing. Generally, the PCA components need not appear periodic (i.e., repeat more than once in some directions), though they do obey periodic boundary conditions. For example, PCA components 5-12 in <a href=\"#fig3\">Figure 3A</a> do not appear periodic since they are composed of the Fourier components B1-8 in <a href=\"#fig15\">Figure 15C</a>."
                }, 
                {
                    "type": "paragraph", 
                    "text": " <i>10) The eigenvectors of a correlation matrix are orthogonal. If we normalize these eigenvectors and furthermore enforce an additional constraint that the entries of each eigenvector must be positive semidefinite, then the \"synaptic weights\" of different eigenvectors should not overlap. In other words, if an entry in the first eigenvector is non-zero, it ought to be zero in all other eigenvectors.</i> "
                }, 
                {
                    "type": "paragraph", 
                    "text": "In the constrained case, the solutions maximizing the variance subject to the non-negativity constraint are no longer eigenvectors of any matrix. Thus, the second such solution described in the section \u201cHierarchical networks and modules\u201d need not be orthogonal to the first, and the issues raised by the reviewers does not arise. We have added a note on this issue in the Results section: \u201cIt is important to note though that due to the non-negativity constraint the vectors achieved this way were not orthogonal, and thus it cannot be considered a real orthogonalization process.\u201d. See <a href=\"#fig18\">Author response image 1</a>, demonstrating that the different vectors outputted from the simulation are indeed not orthogonal."
                }, 
                {
                    "type": "paragraph", 
                    "text": "<i>11) While the algorithms the authors use relax this last constraint, it is not clear how skewing or shearing a square pattern that results from PCA helps satisfy the dual constraints of non-negativity and orthogonality. This is a key point in the paper, and begs for an intuitive explanation, or at least more analysis or quantification of the degree to which the constraints are satisfied.</i> "
                }, 
                {
                    "type": "paragraph", 
                    "text": "We believe the above reply addresses this issue. See also <a href=\"#fig18\">Author response image 1</a>."
                }, 
                {
                    "type": "paragraph", 
                    "text": " <i>12) The finding that the spacings corresponding to successive eigenvectors obey ~</i> <math id=\"inf385\"><mrow><msqrt><mn>2</mn></msqrt></mrow></math> <i>also calls for an explanation. Why should this ratio of spacings best satisfy non-negativity, orthogonality, and periodicity?</i>"
                }, 
                {
                    "type": "paragraph", 
                    "text": "We now provide an analytical motivation for this in the new revised Methods section of the paper. In short, the change of scale occurs when \u201cjumping\u201d from the first optimal circle in the Fourier space to next available Fourier lattice points which can form a hexagonal shape (<a href=\"#fig17\">Figure 17</a> in paper)."
                }, 
                {
                    "type": "paragraph", 
                    "text": "[Editors' note: further revisions were requested prior to acceptance, as described below.]"
                }, 
                {
                    "type": "paragraph", 
                    "text": " <i>Reviewer #1: The authors have worked hard to provide further intuition and interpretation to their results, with much success, although there are still some points that should be clarified, see comments below. There is also a plain error that should be removed. The authors state \"the distribution of grid orientations becomes uniform in the range of 0-15 degrees, with a mean (and median) at 7.5 degrees, similar to experimental data [Stensola et al., 2015]\". On the contrary the experimental data shows a very non-uniform distribution clearly peaked at about 7.5 degrees, which is quite different. Also, as a circular variable limited to [0,15) \u2013 albeit one for which 16 degrees corresponds to 14 degrees rather than 1 degree \u2013 the 'mean' and 'median' they refer to are undefined if the distribution is uniform. Thus the authors should acknowledge that they do not provide an explanation for this aspect of the experimental data, and some of the text/ results on this point could be removed, most importantly in the Abstract.</i> "
                }, 
                {
                    "type": "paragraph", 
                    "text": "We agree that the experimental data is non-uniform, and clearly peaked around 7.5<sup>o</sup>. We have thus erased this point from the abstract, and removed it throughout the paper."
                }, 
                {
                    "type": "paragraph", 
                    "text": "<i>At the start of describing the main result (Results, first paragraph) is not clear that the \"1d mapping of the 2d activity\" is caused by the trajectory of the rat moving through the place fields.</i> "
                }, 
                {
                    "type": "paragraph", 
                    "text": "This point is now clarified in the second paragraph of subsection \u201cComparing Neural-Network results to PCA)."
                }, 
                {
                    "type": "paragraph", 
                    "text": " <i>The next part of the description of their PCA analysis as Eigenvectors and their spatial interpretation could also be improved in terms of intuition. It would be worth mentioning that the PCA, in addition to being calculated as the Eigenvectors of the matrix of temporal covariance between inputs, can also be thought of in terms of singular value decomposition of the (appropriately normalised) input activity. I.e. the input to the network (temporal sequences of place cell activity) can be decomposed into an outer product of (spatial) weights over place cell inputs (their Eigenvectors) and temporally varying weights over these Eigenvectors. The network learns the spatial weights over place cells (the Eigenvectors) as the connections weights from the place cells, and \"projection onto place cell space\" is simply the firing rates of the output neuron plotted against the location of the rat.</i> "
                }, 
                {
                    "type": "paragraph", 
                    "text": "Thanks for this good point. This alternative interpretation using SVD has now been added to the in the Methods section."
                }, 
                {
                    "type": "paragraph", 
                    "text": "<i>In the second paragraph of the subsection \u201cAdding a non-Negativity constraint to the PCA \u201cit is important to remind the reader that the \"raw place cells activity\" is not the final input to the PCA numerical methods \u2013 spatial or temporal mean normalization has to happen first.</i> "
                }, 
                {
                    "type": "paragraph", 
                    "text": "This reminder has now been added in the third paragraph of the section \u201cAdding a non-Negativity constraint to the PCA\u201d."
                }, 
                {
                    "type": "paragraph", 
                    "text": "<i>It would be useful to have a surface plot showing Gridness vs. PC Density vs. PC Width. I have found it hard to replicate the Gridness distribution and wonder how general it is to the precise place cell inputs used?</i> "
                }, 
                {
                    "type": "paragraph", 
                    "text": "We have now added the following subpanels to <a href=\"#fig12\">Figure 12</a>, in which we vary the ratio between the box size and the size of the input place fields. As can be seen, as long as the box and place field sizes are large enough, the Gridness is &gt; 1 (left panel). Furthermore, the scale of the grid is not highly dependent on the size of the box (right panel)."
                }, 
                {
                    "type": "paragraph", 
                    "text": "<i>The reference to <a href=\"#fig10\">Figure 10A</a> in the third paragraph of the subsection \u201cEffect of place cell parameters on grid structure \u201cis incorrect (I think) \u2013 not showing the dependence on the width of the place fields.</i> "
                }, 
                {
                    "type": "paragraph", 
                    "text": "Typo has been corrected to \u201c<a href=\"#fig12\">Figure 12A</a>\u201d."
                }, 
                {
                    "type": "paragraph", 
                    "text": " <i>Regarding the presence of \"modules\" of grid cells (subsection \u201cModules of grid cells\u201d), it is not clear if the interpretation is that different modules correspond to different grid scales, or different Eigenvectors (even if having the same scale). Assuming the latter, it seems that the analysis predicts that there should only be two modules, with the scale of the first module approximately 7.5x the largest place field inputs, and the second module (~</i><math id=\"inf386\"><mrow><msqrt><mn>2</mn></msqrt></mrow></math> <i>smaller)</i>"
                }, 
                {
                    "type": "paragraph", 
                    "text": "<i>existing only to enable non-negative PCA solutions. This deserves discussion, given that the data show at least 5 modules, with a range of scales, the smallest and most numerous having approximately the scale of the smaller place fields found in the dorsal hippocampus (25-30cm).</i> "
                }, 
                {
                    "type": "paragraph", 
                    "text": "We agree. We believe that a thorough understanding of the module phenomenon will require further study. Mainly two points need to be added to a future model: (a) Looking at a non-uniform distribution of place-cell sizes, similar to reality and (b) adding the feedforward projection from grid cells to place cells, thus \u201cclosing the loop\u201d. This point has now been added to the Discussion."
                }, 
                {
                    "type": "paragraph", 
                    "text": "<i>Reviewer #2: The last equation in the section \u201c2D Solutions\u201d: should read \u03d5<sub>1</sub> = \u03d5<sub>2</sub> = \u03d5<sub>3</sub>n 2 \u03c0/3, n \u03f5 Z. e.g. \u03d5<sub>1</sub> = \u03d5<sub>2</sub> = \u03d5<sub>3</sub></i>"
                }, 
                {
                    "type": "paragraph", 
                    "text": "<i>= 0 would be a solution. As written, \u03d5<sub>1</sub> = \u03d5<sub>2</sub> = \u03d5<sub>3</sub>, is not the maximum. Besides, this more general case would allow solutions that are unlike the ones observed in experiments.</i> "
                }, 
                {
                    "type": "paragraph", 
                    "text": "This part was removed due to our revision, in response to the next comment. In any case, this was a typo (which happened due to an inaccurate change of notation from cos(k <i><sub>i</sub></i> \u00b7(x-x<sub>o</sub>)) to cos(k <i><sub>i</sub></i> \u00b7x+<i>\u03d5<sub>i</sub></i>). It should have been \u201c<i>\u03d5<sub>i</sub></i> = k<i><sub>i</sub></i> \u00b7x<sub>0</sub>, for some x<sub>0</sub>\u201d."
                }, 
                {
                    "type": "paragraph", 
                    "text": "<i>This brings me to In the subsection \u201c2D solutions\u201d: \"To do this [maximize the Fourier components inside the basis set,] we must maximize the minimal value of the cosine components for the basis set\" I am afraid this argument escapes me, even though its role is crucial.</i>"
                }, 
                {
                    "type": "paragraph", 
                    "text": "<i>While I think I understand the Fourier domain argument up to this point in the text, how exactly does maximizing the minimum value in real space of the function guarantee that the Fourier components in Eq. 24 are maximized?</i>"
                }, 
                {
                    "type": "paragraph", 
                    "text": "This argument was indeed incorrect (it is true if can we neglect the higher order harmonics in each lattice, unfortunately this cannot be done, as we verified numerically). We thank the reviewer for noting this. We changed the sub-section \u201c2D solutions\u201d (in section \u201cThe PCA solution with a non-negative constraint\u201d) to correct this. First, we prove (in the appendix section \u201cUpper bound on the constrained objective \u2013 2D square lattice\u201d) that the objective is bounded from above by 0.25 in any non-hexagonal 2D lattice with a single grid length (i.e., a square or 1D lattice). Note this remains true even if we consider higher order harmonics. Second, we give an example for a hexagonal lattice (found via a numerical scan) which achieves an objective value higher than 0.25. Thus, given our approximations, this shows that any optimal solution must be a hexagonal lattice"
                }, 
                {
                    "type": "paragraph", 
                    "text": "<i>Eq. 34: why is the upper limit here \u221e, when it was M in Eq. 33?</i>"
                }, 
                {
                    "type": "paragraph", 
                    "text": "The two equations result from two different numerical procedures and assumptions. We revised the text near the two equations to explain this point:"
                }, 
                {
                    "type": "paragraph", 
                    "text": "\u201cThis form (Eq. 33) results from a parameter grid search for <i>M</i> =1, 2,3 and 4, under the assumption that <i>L</i> \u27f6 \u221e and <i>r</i>\u02c6 <i>(k)</i> is highly peaked. [\u2026] Specifically, it has similar form (Eq. 34).\u201d"
                }, 
                {
                    "type": "paragraph", 
                    "text": "The main point is to show that both give very similar results. In other words, that our approximate description, using the simplifying assumptions and finite <i>M</i>, is closely related to the solution without approximations. Additional details were added to the text to clarify this important point. Also, to improve focus, we relegated to the appendix some less important details from that section"
                }, 
                {
                    "type": "paragraph", 
                    "text": "(on the origin of the difference between <i>k</i><sub>\u2020</sub> and <i>k</i><sub>*</sub>)."
                }
            ]
        }, 
        "stage": "published", 
        "statusDate": "2099-01-01T00:00:00Z", 
        "versionDate": "2099-01-01T00:00:00Z"
    }
}